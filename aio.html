<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>R - Beginners Workshop: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="favicons/incubator/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/incubator/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/incubator/favicon-16x16.png">
<link rel="manifest" href="favicons/incubator/site.webmanifest">
<link rel="mask-icon" href="favicons/incubator/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Lesson Description" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://docs.carpentries.org/resources/curriculum/lesson-life-cycle.html" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Lesson Description" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      R - Beginners Workshop
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            R - Beginners Workshop
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  R - Beginners Workshop
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="r-setup.html">2. R Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="packages.html">3. Packages in R</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="scripts-and-vectors.html">4. Vectors and variable types</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="projects.html">5. Projects</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="data-visualization-01.html">6. Data Visualization (1)</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="data-visualization-02.html">7. Data Visualization (2)</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="filtering.html">8. Filtering data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="mutating.html">9. Creating new columns</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="count-and-summarize.html">10. Count and Summarize</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="midterms.html">11. Midterms</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="t-test.html">12. t-Test</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="factor-analysis.html">13. Factor Analysis - Introduction &amp; EFA</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="factor-analysis-02.html">14. Factor Analysis - CFA</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush16">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading16">
        <a href="factor-analysis-03.html">15. Factor Analysis - Advanced Measurement Models</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>

                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">Introduction</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is this all about?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the general structure of this introductory course</li>
<li>Explain how to submit “homework” assignments</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<hr class="half-width">
<p>This is the accompanying website to the Empra Differentielle
Psychologie of Heidelberg University. It is authored and used by <a href="https://www.psychologie.uni-heidelberg.de/person/sven-lesche" class="external-link">Sven
Lesche</a>. This course aims to cover:</p>
<ul>
<li>Some R basics and how to structure code</li>
<li>Getting a first glimpse of data</li>
<li>Cleaning data</li>
<li>Running some analysis</li>
</ul></section><section><h2 class="section-heading" id="lesson-structure">Lesson Structure<a class="anchor" aria-label="anchor" href="#lesson-structure"></a>
</h2>
<hr class="half-width">
<p>The entire course is organized in short “Episodes” intended to take
around 10-15mins to read and around 5-10mins to complete the challenges
below. You will complete approximately one episode per week. At the end
of each episode, you will upload a script containing the solutions to
the challenges. The file format should be:
<code>lessonnumber_solutions_name_surname.R</code>. Upload the script
containing your solutions to a HeiBox folder and share that folder with
me.</p>
</section><section><h2 class="section-heading" id="a-word-about-chat-gpt">A word about Chat-GPT<a class="anchor" aria-label="anchor" href="#a-word-about-chat-gpt"></a>
</h2>
<hr class="half-width">
<p>Chat-GPT is an amazing tool that makes it much easier to just try
something out. Importantly, it can take a lot of work off your hands,
especially early on in your learning process. Most of the challenges
here can just be solved by plugging them into a LLM like Chat-GPT. I
encourage you to first try to find a solution yourself. You will learn a
lot more by failing yourself first and continuing to try.</p>
<p>Nonetheless, sometimes it may be necessary to ask Chat-GPT or google
a solution. In real data analysis, this is done a lot! Nobody knows
anything. However, the most important thing for now is that you
<em>understand</em> the code you write. Thus, if you use Chat-GPT, make
it explain to you why this code works and what it is doing or ask it for
hints instead of the solution.</p>
</section><section><h2 class="section-heading" id="accompanying-material">Accompanying Material<a class="anchor" aria-label="anchor" href="#accompanying-material"></a>
</h2>
<hr class="half-width">
<p>This course relies heavily on <a href="https://r4ds.hadley.nz/" class="external-link">R for
Data Science (2e)</a>, which can be treated as an accompanying
textbook.</p>
</section><section><h2 class="section-heading" id="questions-support">Questions &amp; Support<a class="anchor" aria-label="anchor" href="#questions-support"></a>
</h2>
<hr class="half-width">
<p>This is the first version of the new course material. If you have any
questions or notice any inconsistencies / opportunities for improvement,
feel free to reach out to to me via mail or Slack. If you feel
comfortable using GitHub, also feel free to submit an <a href="https://github.com/SLesche/r-for-empra/issues" class="external-link">issue</a>.</p>
<p>Some opportunities for improvement are:</p>
<ul>
<li>Is the material sufficiently explained? Can you follow?</li>
<li>Are the exercises too difficult / not enough to practice material
learned in an episode?</li>
<li>Are you missing any information to complete following episodes?</li>
<li>Is there information missing or information that you do not
require?</li>
<li>Are there any typos / wrong examples?</li>
<li>Whatever else comes to mind.</li>
</ul>
<p>Feel free to reach out to me via any of the channels with your
feedback. I will try to implement it as soon as possible. Thank you for
your help in making this course better for coming students!</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Follow the structured outline to learn R basics and data
analysis</li>
<li>Submit weekly scripts following the specified format</li>
<li>Contact me via mail or Slack for any queries</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-r-setup"><p>Content from <a href="r-setup.html">R Setup</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/r-setup.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is R, what is R Studio?</li>
<li>How to work with the R console and R scripts?</li>
<li>What is an R package?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>To gain familiarity with the various panes in the RStudio IDE</li>
<li>To gain familiarity with the buttons, short cuts and options in the
RStudio IDE</li>
<li>To understand variables and how to assign to them</li>
<li>To be able to manage your workspace in an interactive R session</li>
<li>To be able to use mathematical and comparison operations</li>
<li>To be able to call functions</li>
<li>Introduction to package management</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="introduction-to-rstudio">Introduction to RStudio<a class="anchor" aria-label="anchor" href="#introduction-to-rstudio"></a>
</h2>
<hr class="half-width">
<p>Welcome to the R portion of the Empra. This first lesson is adapted
from <em>resbaz’s</em> <a href="https://github.com/resbaz/Introductory-R-Workshop?tab=readme-ov-file" class="external-link">introction
to R workshop</a>.</p>
<p>Throughout this lesson, you’re going to learn some of the
fundamentals of the R language as well as some best practices for
organizing code for scientific projects that will make your life
easier.</p>
<p>We’ll be using RStudio: a free, open source R integrated development
environment. It provides a built in editor, works on all platforms
(including on servers) and provides many advantages such as integration
with version control and project management.</p>
<p><strong>Basic layout</strong></p>
<p>When you first open RStudio, you will be greeted by three panels:</p>
<ul>
<li>The interactive R console (entire left)</li>
<li>Environment/History (tabbed in upper right)</li>
<li>Files/Plots/Packages/Help/Viewer (tabbed in lower right)</li>
</ul>
<figure><img src="fig/rstudio_layout_screenshot.jpg" alt="Screenshot of the RStudio program." class="figure mx-auto d-block"><div class="figcaption">R Studio Layout with three panes: Console,
Environment and Plots</div>
</figure><p>Once you open files, such as R scripts, an editor panel will also
open in the top left.</p>
</section><section><h2 class="section-heading" id="work-flow-within-rstudio">Work flow within RStudio<a class="anchor" aria-label="anchor" href="#work-flow-within-rstudio"></a>
</h2>
<hr class="half-width">
<p>There are two main ways one can work within RStudio.</p>
<ol style="list-style-type: decimal">
<li>Test and play within the interactive R console then copy code into a
.R file to run later.
<ul>
<li>This works well when doing small tests and initially starting
off.</li>
<li>It quickly becomes laborious</li>
</ul>
</li>
<li>Start writing in an .R file - called a script - and use RStudio’s
command / short cut to push current line, selected lines or modified
lines to the interactive R console.
<ul>
<li>This is a great way to start; all your code is saved for later</li>
<li>You will be able to run the file you create from within RStudio or
using R’s <code>source()</code> function.</li>
</ul>
</li>
</ol>
<p>For now, let’s stick with the console. We will learn more about how
to use R scripts later. Feel free to run all code examples provided here
in your own RStudio console and figure out what they do.</p>
</section><section><h2 class="section-heading" id="introduction-to-the-r-console">Introduction to the R console<a class="anchor" aria-label="anchor" href="#introduction-to-the-r-console"></a>
</h2>
<hr class="half-width">
<p>Much of your time in R will be spent in the R interactive console.
This is where you will run all of your code, and can be a useful
environment to try out ideas before adding them to an R script file.</p>
<p>The first thing you will see in the R interactive session is a bunch
of information, followed by a “&gt;” and a blinking cursor. R operates
on the idea of a “Read, evaluate, print loop”: you type in commands, R
tries to execute them, and then returns a result.</p>
</section><section><h2 class="section-heading" id="using-r-as-a-calculator">Using R as a calculator<a class="anchor" aria-label="anchor" href="#using-r-as-a-calculator"></a>
</h2>
<hr class="half-width">
<p>The simplest thing you could do with R is do arithmetic:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">+</span> <span class="fl">100</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 101</code></pre>
</div>
<p>And R will print out the answer, with a preceding “[1]”. Don’t worry
about this for now, we’ll explain that later. For now think of it as
indicating output.</p>
<p>If you type in an incomplete command, R will wait for you to complete
it:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="dv">1</span> <span class="sc">+</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>+</code></pre>
</div>
<p>Any time you hit return and the R session shows a “+” instead of a
“&gt;”, it means it’s waiting for you to complete the command. If you
want to cancel a command you can simply hit “Esc” and RStudio will give
you back the “&gt;” prompt.</p>
<div id="tip-cancelling-commands" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-cancelling-commands" class="callout-inner">
<h3 class="callout-title">Tip: Cancelling commands</h3>
<div class="callout-content">
<p>If you’re using R from the commandline instead of from within
RStudio, you need to use <code>Ctrl+C</code> instead of <code>Esc</code>
to cancel the command. This applies to Mac users as well!</p>
<p>Cancelling a command isn’t just useful for killing incomplete
commands: you can also use it to tell R to stop running code (for
example if its taking much longer than you expect), or to get rid of the
code you’re currently writing.</p>
</div>
</div>
</div>
<p>When using R as a calculator, the order of operations is the same as
you would have learnt back in school.</p>
<p>From highest to lowest precedence:</p>
<ul>
<li>Parentheses: <code>(</code>, <code>)</code>
</li>
<li>Exponents: <code>^</code> or <code>**</code>
</li>
<li>Divide: <code>/</code>
</li>
<li>Multiply: <code>*</code>
</li>
<li>Add: <code>+</code>
</li>
<li>Subtract: <code>-</code>
</li>
</ul>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 13</code></pre>
</div>
<p>Use parentheses to group operations in order to force the order of
evaluation if it differs from the default, or to make clear what you
intend.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 16</code></pre>
</div>
<p>This can get unwieldy when not needed, but clarifies your intentions.
Remember that others may later read your code.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="op">(</span><span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># hard to read</span></span>
<span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">^</span> <span class="fl">2</span>       <span class="co"># clear, if you remember the rules</span></span>
<span><span class="fl">3</span> <span class="op">+</span> <span class="fl">5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span>     <span class="co"># if you forget some rules, this might help</span></span></code></pre>
</div>
<p>The text after each line of code is called a “comment”. Anything that
follows after the hash (or octothorpe) symbol <code>#</code> is ignored
by R when it executes code.</p>
<p>Really small or large numbers get a scientific notation:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span><span class="op">/</span><span class="fl">10000</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2e-04</code></pre>
</div>
<p>Which is shorthand for “multiplied by <code>10^XX</code>”. So
<code>2e-4</code> is shorthand for <code>2 * 10^(-4)</code>.</p>
<p>You can write numbers in scientific notation too:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">5e3</span>  <span class="co"># Note the lack of minus here</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 5000</code></pre>
</div>
</section><section><h2 class="section-heading" id="mathematical-functions">Mathematical functions<a class="anchor" aria-label="anchor" href="#mathematical-functions"></a>
</h2>
<hr class="half-width">
<p>R has many built in mathematical functions. To call a function, we
simply type its name, followed by open and closing parentheses. Anything
we type inside the parentheses is called the function’s arguments:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sin</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>  <span class="co"># trigonometry functions</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.841471</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">log</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>  <span class="co"># natural logarithm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">log10</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="co"># base-10 logarithm</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">exp</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span> <span class="co"># e^(1/2)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1.648721</code></pre>
</div>
<p>Don’t worry about trying to remember every function in R. You can
simply look them up on Google, or if you can remember the start of the
function’s name, use the tab completion in RStudio.</p>
<p>This is one advantage that RStudio has over R on its own, it has
autocompletion abilities that allow you to more easily look up
functions, their arguments, and the values that they take.</p>
<p>Typing a <code>?</code> before the name of a command will open the
help page for that command. As well as providing a detailed description
of the command and how it works, scrolling to the bottom of the help
page will usually show a collection of code examples which illustrate
command usage. Try reading the description to the <code>log()</code>
function by typing <code>?log()</code> (or just <code>?log</code>) in
the console.</p>
</section><section><h2 class="section-heading" id="comparing-things">Comparing things<a class="anchor" aria-label="anchor" href="#comparing-things"></a>
</h2>
<hr class="half-width">
<p>Another useful feature of R next to functions are comparisons. Quite
often, we want to see if one value is bigger than another or only use
data with some particular value.</p>
<p>We can check if two values are equal by using the equality operator
<code>==</code>.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">==</span> <span class="fl">1</span>  <span class="co"># equality (note two equals signs, read as "is equal to")</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">!=</span> <span class="fl">2</span>  <span class="co"># inequality (read as "is not equal to")</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">&lt;</span>  <span class="fl">0</span>  <span class="co"># less than</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">&lt;=</span> <span class="fl">1</span>  <span class="co"># less than or equal to</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">&gt;</span> <span class="fl">1</span>  <span class="co"># greater than</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] FALSE</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="co"># greater than or equal to</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] TRUE</code></pre>
</div>

</section><section><h2 class="section-heading" id="variables-and-assignment">Variables and assignment<a class="anchor" aria-label="anchor" href="#variables-and-assignment"></a>
</h2>
<hr class="half-width">
<p>In the previous example, we simply used numbers to do comparisons.
However, most work in R will be done using <em>variables</em>. A
variable can be any quality, quantity or property we might be interested
in, like a response time, a score on a personality test or a diagnosis.
We can store values in variables using the assignment operator
<code>&lt;-</code>, like this:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">40</span></span></code></pre>
</div>
<p>Notice that assignment does not print a value. Instead, we stored it
for later in something called a <strong>variable</strong>.
<code>x</code> now contains the <strong>value</strong>
<code>0.025</code>:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.025</code></pre>
</div>

<p>Look for the <code>Environment</code> tab in one of the panes of
RStudio, and you will see that <code>x</code> and its value have
appeared. Our variable <code>x</code> can be used in place of a number
in any calculation that expects a number:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">log</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] -3.688879</code></pre>
</div>
<p>Notice also that variables can be reassigned:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre>
</div>
<p><code>x</code> used to contain the value 0.025 and and now it has the
value 100.</p>
<p>We can also update the value of a variable and store it with the same
name again.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">1</span> <span class="co">#notice how RStudio updates its description of x on the top right tab</span></span></code></pre>
</div>
<p>The right hand side of the assignment can be any valid R expression.
The right hand side is <em>fully evaluated</em> before the assignment
occurs. This means that in the above example, <code>x + 1</code> is
evaluated first and the result is only then assigned to the new
<code>x</code>.</p>
<p>Variable names can contain letters, numbers, underscores and periods.
They cannot start with a number nor contain spaces at all. Different
people use different conventions for long variable names, these
include</p>
<ul>
<li>periods.between.words</li>
<li>underscores_between_words</li>
<li>camelCaseToSeparateWords</li>
</ul>
<p>What you use is up to you, but <strong>be consistent</strong>.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">this_is_okay</span></span>
<span></span>
<span><span class="va">this.is.also.okay</span></span>
<span></span>
<span><span class="va">someUseCamelCase</span></span>
<span></span>
<span><span class="va">dont_be.aMenace_toSociety</span></span></code></pre>
</div>
<p>I always use <code>snake_case</code> for variable names in R.
<code>camelCase</code> is often used in other programming languages such
as MATLAB or JavaScript.</p>
<div id="using-for-assignment" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="using-for-assignment" class="callout-inner">
<h3 class="callout-title">Using = for assignment</h3>
<div class="callout-content">
<p>It is also possible to use the <code>=</code> operator for
assignment:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">40</span></span></code></pre>
</div>
<p>But this is much less common among R users. The most important thing
is to <strong>be consistent</strong> with the operator you use. There
are occasionally places where it is less confusing to use
<code>&lt;-</code> than <code>=</code>, and it is the most common symbol
used in the community. So the recommendation is to use
<code>&lt;-</code>.</p>
</div>
</div>
</div>
<p>If we try to give a variable an invalid name, R will throw an
error.</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="dv">2</span>_times_x <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>x</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in parse(text = input): &lt;text&gt;:1:2: unexpected input
1: 2_
     ^</code></pre>
</div>
<div id="tip-warnings-vs.-errors" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-warnings-vs.-errors" class="callout-inner">
<h3 class="callout-title">Tip: Warnings vs. Errors</h3>
<div class="callout-content">
<p>Pay attention when R does something unexpected! Errors, like above,
are thrown when R cannot proceed with a calculation. Warnings on the
other hand usually mean that the function has run, but it probably
hasn’t worked as expected.</p>
<p>In both cases, the message that R prints out usually give you clues
how to fix a problem.</p>
<p>Errors can be frustrating, but they are your friend! They tell you
that something went wrong and usually give you an informative message as
to what went wrong. If you cannot make something of the error message,
try pasting it into Google or Chat-GPT, this will often help.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Which of the following are valid R variable names? Feel free to try
them all out in R and figure out which produce errors and why.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>min_height</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>max.height</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>_age</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>.mass</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>MaxLength</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>min<span class="sc">-</span>length</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="dv">2</span>widths</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>celsius2kelvin</span></code></pre>
</div>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>What will be the value of each variable after each statement in the
following program? You are encouraged to run these commands in R.</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="fl">47.5</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">122</span></span>
<span><span class="va">mass</span> <span class="op">&lt;-</span> <span class="va">mass</span> <span class="op">*</span> <span class="fl">2.3</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">20</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Run the code from the previous challenge, and write a command to
compare mass to age. Is mass larger than age?</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>R Studio is a shiny environment that helps you write R code</li>
<li>You can either write code directly in the console, or use script to
organize and save your code</li>
<li>You can assign variables using <code>&lt;-</code>
</li>
<li>Be consistent in naming variables, other people should be able to
read and understand your code</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-packages"><p>Content from <a href="packages.html">Packages in R</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/packages.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is an R package?</li>
<li>How can we use R packages</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to use R packages</li>
<li>Explain how to install R packages</li>
<li>Understand the difference between installing and loading an R
package</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="r-packages">R Packages<a class="anchor" aria-label="anchor" href="#r-packages"></a>
</h2>
<hr class="half-width">
<p>Per default, R provides you with some basic functions like
<code>sum()</code>, <code>mean()</code> or <code>t.test()</code>. These
functions can already accomplish a lot, but for more specialized
analyses or more user-friendly functions, you might want to use
additional functions.</p>
<p>If you are in need of a specific function to achieve your goal, you
can either write it yourself (more on this later) or use functions
written by other users. These functions are often collected in so-called
“packages”. The official source for these packages on R is CRAN (the
comprehensive R archive network).</p>
<div id="packages-you-may-encounter" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="packages-you-may-encounter" class="callout-inner">
<h3 class="callout-title">Packages you may encounter</h3>
<div class="callout-content">
<p>Packages make R really powerful. For 95% of your analysis-needs,
there probably exists a package designed specifically to hand this. For
example, some packages you might use often are <code>tidyverse</code>
for data cleaning, <code>psych</code> for some psychology specific
functions, <code>afex</code> for ANOVAs or <code>lme4</code> for
multi-level models. You can even use R packages for more complicated
analyses like structural equation models (<code>lavaan</code>) or
bayesian modeling (<code>brms</code>). You can even write papers using R
using <code>papaya</code>. Even this website was written using the
R-packages <code>rmarkdown</code> and <code>sandpaper</code>.</p>
</div>
</div>
</div>
<p>CRAN makes it really easy to use the over 7000 R packages other users
provide. You can install them using
<code>install.packages("packagename")</code> with the name of the
package in quotation marks. This installs all functionalities of this
packages on your machine. However, this package is not automatically
available to you. Before using it in a script (or the console) you need
to tell R to “activate” this package. You can do this using
<code>library(packagename)</code>. This avoids loading all installed
packages every time R is starting (which would take a while).</p>
<div id="using-functions-without-loading-a-package" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="using-functions-without-loading-a-package" class="callout-inner">
<h3 class="callout-title">Using functions without loading a package</h3>
<div class="callout-content">
<p>If you are only using a few functions from a certain package (maybe
even only once), you can avoid loading the entire package and only
specifically access that function using the <code>::</code> operator.
You can do this by typing <code>packagename::function()</code>. If the
package is installed, it will allow you to use that function without
calling <code>library(packagename)</code> first. This may also be useful
in cases where you want to allow the reader of your code to easily
understand what package you used for a certain function.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="demonstration">Demonstration<a class="anchor" aria-label="anchor" href="#demonstration"></a>
</h3>
<p>First, we need to install a package. This will often generate a lot
of text in your console. This is nothing to worry about. In most cases,
it is enough to look at the last few messages, they will tell you what
went wrong or whether everything went right.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install.packages</span><span class="op">(</span><span class="st">"dplyr"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following package(s) will be installed:
- dplyr [1.1.4]
These packages will be installed into "~/work/r-for-empra/r-for-empra/renv/profiles/lesson-requirements/renv/library/linux-ubuntu-jammy/R-4.5/x86_64-pc-linux-gnu".

# Installing packages --------------------------------------------------------
- Installing dplyr ...                          OK [linked from cache]
Successfully installed 1 package in 5 milliseconds.</code></pre>
</div>
<p>Then, we will need to load the package to make its functions
available for use. For most packages, this will also print a lot of
messages in the console in the bottom left. Again, this is usually
harmless. If something does go wrong, you will see the word
<code>Error:</code> along with a message somewhere.
<code>Warnings:</code> can often be ignored in package installation.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Loading the package dplyr</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<p>Now we can use all the functions that <code>dplyr</code> provides.
Let’s start by using <code>glimpse()</code> to get a quick glance at
some data. For this case, we are using the <code>iris</code> data, that
comes with your default R installation.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># iris is a dataset provided as default in R</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 150
Columns: 5
$ Sepal.Length &lt;dbl&gt; 5.1, 4.9, 4.7, 4.6, 5.0, 5.4, 4.6, 5.0, 4.4, 4.9, 5.4, 4.…
$ Sepal.Width  &lt;dbl&gt; 3.5, 3.0, 3.2, 3.1, 3.6, 3.9, 3.4, 3.4, 2.9, 3.1, 3.7, 3.…
$ Petal.Length &lt;dbl&gt; 1.4, 1.4, 1.3, 1.5, 1.4, 1.7, 1.4, 1.5, 1.4, 1.5, 1.5, 1.…
$ Petal.Width  &lt;dbl&gt; 0.2, 0.2, 0.2, 0.2, 0.2, 0.4, 0.3, 0.2, 0.2, 0.1, 0.2, 0.…
$ Species      &lt;fct&gt; setosa, setosa, setosa, setosa, setosa, setosa, setosa, s…</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using a function without loading the entire package</span></span>
<span><span class="co"># dplyr::glimpse(iris)</span></span></code></pre>
</div>
<p>Here, we can see that <code>iris</code> has 150 rows (or
observations) and 5 columns (or variables). The first four variables are
size measurements regarding length and width of sepal and petal and the
fifth variable is a variable containing the species of flower.</p>
</div>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1:</h3>
<div class="callout-content">
<p>Install the following packages: <code>dplyr</code>,
<code>ggplot2</code>, and <code>psych</code>.</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2:</h3>
<div class="callout-content">
<p>Load the package <code>dplyr</code> and get an overview of the data
<code>mtcars</code> using <code>glimpse()</code>.</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3:</h3>
<div class="callout-content">
<p>Figure out what kind of data <code>mtcars</code> contains. Make a
list of the columns in the dataset and what they might mean.</p>
<div id="hint" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="hint" class="callout-inner">
<h3 class="callout-title">Hint</h3>
<div class="callout-content">
<p>You are allowed to use Google (or other sources) for this. It is
common practice to google information you don’t know or look online for
code that might help.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4:</h3>
<div class="callout-content">
<p>Use the function <code>describe()</code> from the package
<code>psych</code> <em>without</em> loading it first.</p>
<p>What differences do you notice between <code>glimpse()</code> and
<code>describe()</code>?</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>R packages are “add-ons” to R, they provide useful new tools.</li>
<li>Install a package using
<code>install.packages("packagename")</code>.</li>
<li>Use a package using <code>library(packagename)</code> at the
beginning of your script.</li>
<li>Use <code>::</code> to access specific functions from a package
without loading it entirely.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-scripts-and-vectors"><p>Content from <a href="scripts-and-vectors.html">Vectors and variable types</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/scripts-and-vectors.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you use scripts in R to document your work?</li>
<li>How can you organize scripts effectively?</li>
<li>What is a vector?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Show how to use scripts to generate reproducible analyses</li>
<li>Explain what a vector is</li>
<li>Explain variable types</li>
<li>Show examples of <code>sum()</code> and <code>mean()</code>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="scripts-in-r">Scripts in R<a class="anchor" aria-label="anchor" href="#scripts-in-r"></a>
</h2>
<hr class="half-width">
<p>For now, we have been only using the R console to execute commands.
This works great if there are some quick calculations you have to run,
but is unsuited for more complex analyses. If you want to reproduce the
exact steps you took in data cleaning and analyses, you need to write
them down - like a recipe.</p>
<p>This is where R scripts come in. They are basically like a text file
(similar to Word) where you can write down all the steps you took. This
makes it possible to retrace them and produce the exact same result over
and over again.</p>
<p>In order to use R scripts effectively, you need to do two things.
Firstly, you need to write them in a way that is understandable in the
future. We will learn more about how to write clean code in future
lessons. Secondly (and maybe more importantly) you need to actually
<strong>save</strong> these scripts on your computer, and ideally save
them in a place where you can find them again. The place where you save
your script and especially the place you save your data should ideally
be a folder in a sensible place. For example, this script is saved in a
sub-folder <code>episodes/</code> of the workshop folder
<code>r_for_empra/</code>. This makes it easy for humans to find the
script. Aim for similar clarity in your folder structure!</p>
<p>For this lesson, create a folder called <code>r_for_empra</code>
somewhere on your computer where it makes sense for you. Then, create a
new R script by clicking <code>File &gt; New File &gt; R Script</code>
or hitting <code>Ctrl + Shift + N</code>. Save this script as
<code>episode_scripts_and_vectors.R</code> in the folder
<code>r_for_empra</code> created above. Follow along with the episode
and note down the commands in your script.</p>
</section><section><h2 class="section-heading" id="using-a-script">Using a script<a class="anchor" aria-label="anchor" href="#using-a-script"></a>
</h2>
<hr class="half-width">
<p>Let’s start learning about some basic elements of R programming. We
have already tried assigning values to variables using the
<code>&lt;-</code> operator. For example, we might assign the constant
<code>km_to_m</code> the value 1000.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">km_to_m</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></code></pre>
</div>
<p>Now, if we had data on distances in km, we could also use this value
to compute the distance in meters.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distance_a_to_b_km</span> <span class="op">&lt;-</span> <span class="fl">7.56</span></span>
<span></span>
<span><span class="va">distance_a_to_b_m</span> <span class="op">&lt;-</span> <span class="va">distance_a_to_b_km</span> <span class="op">*</span> <span class="va">km_to_m</span></span></code></pre>
</div>
<p>If we have multiple distances and want to transform them from km to m
at the same time, we can make use of a vector. A vector is just a
collection of elements. We can create a vector using the function
<code>c()</code> (for <em>combine</em>).</p>
<div id="tip-running-segments-of-your-code" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-running-segments-of-your-code" class="callout-inner">
<h3 class="callout-title">Tip: Running segments of your code</h3>
<div class="callout-content">
<p>RStudio offers you great flexibility in running code from within the
editor window. There are buttons, menu choices, and keyboard shortcuts.
To run the current line, you can 1. click on the <code>Run</code> button
just above the editor panel, or 2. select “Run Lines” from the “Code”
menu, or 3. hit <code>Ctrl + Enter</code> in Windows or Linux or
Command-Enter on OS X. (This shortcut can also be seen by hovering the
mouse over the button). To run a block of code, select it and then
<code>Run</code> via the button or the keyboard-shortcut
<code>Ctrl + Enter</code>.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="variable-types">Variable Types<a class="anchor" aria-label="anchor" href="#variable-types"></a>
</h2>
<hr class="half-width">
<p>Vectors can only contain values of the same type. There are two basic
types of variables that you will have to interact with - numeric and
character variables. Numeric variables are any numbers, character
variables are bits of text.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These are numeric variables:</span></span>
<span><span class="va">vector_of_numeric_variables</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">7.642</span>, <span class="fl">9e5</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">97</span><span class="op">)</span> <span class="co"># recall, 9e5 = 9*10^5</span></span>
<span></span>
<span><span class="co"># Show the output</span></span>
<span><span class="va">vector_of_numeric_variables</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 4.000000e+00 7.642000e+00 9.000000e+05 1.030928e-02</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These are character variables:</span></span>
<span><span class="va">vector_of_character_variables</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"This is a character variable"</span>, <span class="st">"A second variable"</span>, <span class="st">"And another one"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the output</span></span>
<span><span class="va">vector_of_character_variables</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "This is a character variable" "A second variable"
[3] "And another one"             </code></pre>
</div>
<p>We can not only combine single elements into a vector, but also
combine multiple vectors into one long vector.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">numeric_vector_1</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">numeric_vector_2</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="co"># 6:10 generates the values 6, 7, 8, 9, 10</span></span>
<span></span>
<span><span class="va">combined_vector</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">numeric_vector_1</span>, <span class="va">numeric_vector_2</span><span class="op">)</span></span>
<span><span class="va">combined_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<p>Recall that all elements have to be of the same type. If you try to
combine numeric vectors with character vectors, R will automatically
convert everything to a character vector (as this has less restrictions,
anything can be a character).</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">character_vector_1</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"6"</span>, <span class="st">"7"</span>, <span class="st">"8"</span><span class="op">)</span></span>
<span><span class="co"># Note that the numbers are now in quotation marks!</span></span>
<span><span class="co"># They will be treated as characters, not numerics!</span></span>
<span></span>
<span><span class="va">combining_numeric_and_character</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">numeric_vector_1</span>, <span class="va">character_vector_1</span><span class="op">)</span></span>
<span><span class="va">combining_numeric_and_character</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "1" "2" "3" "4" "5" "6" "7" "8"</code></pre>
</div>
<p>We can fix this issue by converting the vectors to the same type.
Note how the characters are also just numbers, but in quotation marks.
Sometimes, this happens in real data, too. Some programs store every
variable as a character (sometimes also called <em>string</em>). We then
have to convert the numbers back to the number format:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">converted_character_vector_1</span> <span class="op">&lt;-</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="va">character_vector_1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combining_numeric_and_converted_character</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="va">numeric_vector_1</span>, <span class="va">converted_character_vector_1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combining_numeric_and_converted_character</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2 3 4 5 6 7 8</code></pre>
</div>
<p>But be careful, this conversion does not always work! If R does not
know how to convert a specific character to a number, it will simply
replace this with <code>NA</code>.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">character_vector_2</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"10"</span>, <span class="st">"11"</span>, <span class="st">"text"</span><span class="op">)</span></span>
<span><span class="co"># The value "text", can not be interpreted as a number</span></span>
<span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">character_vector_2</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 10 11 NA</code></pre>
</div>
<div id="inspecting-the-type-of-a-variable" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="inspecting-the-type-of-a-variable" class="callout-inner">
<h3 class="callout-title">Inspecting the type of a variable</h3>
<div class="callout-content">
<p>You can use the function <code>str()</code> to learn about the
structure of a variable. The first entry of the output tells us about
the type of the variable.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">vector_of_numeric_variables</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> num [1:4] 4.00 7.64 9.00e+05 1.03e-02</code></pre>
</div>
<p>This tells us that there is a numeric vector, hence <em>num</em>,
with 4 elements.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">vector_of_character_variables</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> chr [1:3] "This is a character variable" "A second variable" ...</code></pre>
</div>
<p>This tells us that there is a character vector, hence <em>chr</em>,
with 3 elements.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> int [1:5] 1 2 3 4 5</code></pre>
</div>
<p>Note that this prints <em>int</em> and not the usual <em>num</em>.
This is because the vector only contains integers, so whole numbers.
These are stored in a special type that takes up less memory, because
the numbers need to be stored with less precision. You can treat it as
very similar to a numeric vector, and do all the same wonderful things
with it!</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="simple-functions-for-vectors">Simple functions for vectors<a class="anchor" aria-label="anchor" href="#simple-functions-for-vectors"></a>
</h2>
<hr class="half-width">
<p>Let’s use something more exciting than a sequence from 1 to 10 as an
example vector. Here, we use the <code>mtcars</code> data that you
already got to know in an earlier lesson. <code>mtcars</code> carries
information about cars, like their name, fuel usage, weight, etc. This
information is stored in a <em>data frame</em>. A data frame is a
rectangular collection of variables (in the columns) and observations
(in the rows). In order to extract vectors from a data frame we can use
the <code>$</code> operator. <code>data$column</code> extracts a
vector.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars_weight_tons</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">wt</span> </span>
<span></span>
<span><span class="co"># note that it is a good idea to include the unit in the variable name</span></span>
<span><span class="va">mtcars_weight_tons</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 2.620 2.875 2.320 3.215 3.440 3.460 3.570 3.190 3.150 3.440 3.440 4.070
[13] 3.730 3.780 5.250 5.424 5.345 2.200 1.615 1.835 2.465 3.520 3.435 3.840
[25] 3.845 1.935 2.140 1.513 3.170 2.770 3.570 2.780</code></pre>
</div>
<p>Let’s start learning some basic information about this vector:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">mtcars_weight_tons</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> num [1:32] 2.62 2.88 2.32 3.21 3.44 ...</code></pre>
</div>
<p>The vector is of type numeric and contains 32 entries. We can double
check this by looking into our environment tab, where
<code>num [1:32]</code> indicates just that. Similarly, we can get the
length of a vector by using <code>length()</code></p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">length</span><span class="op">(</span><span class="va">mtcars_weight_tons</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 32</code></pre>
</div>
<p>We can compute some basic descriptive information of the weight of
cars in the <code>mtcars</code> data using base-R functions:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean weight:</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">mtcars_weight_tons</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.21725</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Median weight:</span></span>
<span><span class="fu">median</span><span class="op">(</span><span class="va">mtcars_weight_tons</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 3.325</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standard deviation:</span></span>
<span><span class="fu">sd</span><span class="op">(</span><span class="va">mtcars_weight_tons</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.9784574</code></pre>
</div>
<p>To get the minimum and maximum value, we can use <code>min()</code>
and <code>max()</code>.</p>
<p>We can also get a quick overview of the weight distribution using
<code>hist()</code>, which generates a simple histogram.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">mtcars_weight_tons</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/scripts-and-vectors-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="histograms" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="histograms" class="callout-inner">
<h3 class="callout-title">Histograms</h3>
<div class="callout-content">
<p>Histograms are more powerful tools than it seems on first glance.
They allow you to simply gather knowledge about the distribution of your
data. This is especially important for us psychologists. Do we have
ceiling effects in the task? Were some response options even used? How
is response time distributed?</p>
<p>If your histogram is not detailed enough, try adjusting the
<code>breaks</code> parameter. This tells <code>hist()</code> how many
bars to print in the plot.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">mtcars_weight_tons</span>, breaks <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/scripts-and-vectors-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The golden rule for the number of breaks is simple: try it until it
looks good! You are free to explore here.</p>
</div>
</div>
</div>
<p>Another useful function is <code>unique()</code>. This function
removes duplicates and only returns unique values. I use it a lot in
experimental data. Since every participant contributes multiple trials,
but I am sometimes interested in values a participant only contributes
once, I can use <code>unique()</code> to only retain each value
once.</p>
<p>In <code>mtcars</code> data, we might want to see how many cylinders
are possible in the data. <code>unique(mtcars$cyl)</code> is much easier
to read at a glance.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">unique</span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6 4 8</code></pre>
</div>
<div id="tip-unique-length-quick-count" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-unique-length-quick-count" class="callout-inner">
<h3 class="callout-title">Tip: Unique + Length = Quick Count</h3>
<div class="callout-content">
<p>Combining <code>unique()</code> and <code>length()</code> leads to a
really useful property. This returns the number of unique entries in a
vector. I use it almost daily! For example to figure out how many
participants are in a given data frame.
<code>unique(data$participant_id)</code> returns all the different
participant ids and <code>length(unique(data$participant_id))</code>
then gives me the number of different ids, so the number of participants
in my data.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="indexing-and-slicing-vectors">Indexing and slicing vectors<a class="anchor" aria-label="anchor" href="#indexing-and-slicing-vectors"></a>
</h2>
<hr class="half-width">
<p>There is one more important thing to learn about vectors before we
move on to more complicated data structures. Most often, you are going
to use the whole vector for computation. But sometimes you may only want
the first 150 entries, or only entries belonging to a certain group.
Here, you must be able to access specific elements of the vector.</p>
<p>In the simplest case, you can access the <span class="math inline">\(n\)</span>th element in a vector by using
<code>vector[n]</code>. To access the first entry, use
<code>vector[1]</code>, and so on.</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_indexing_vector</span> <span class="op">&lt;-</span> <span class="fu">seq</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">32</span>, <span class="fl">1</span><span class="op">)</span> </span>
<span><span class="co"># Seq generates a sequence from the first argument (1) to the second argument (32) </span></span>
<span><span class="co"># The size of the steps is given by the third argument</span></span>
<span></span>
<span><span class="va">test_indexing_vector</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
[26] 26 27 28 29 30 31 32</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_indexing_vector</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_indexing_vector</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1 2</code></pre>
</div>
<p>You can also remove an element (or multiple) from a vector by using a
negative sign <code>-</code>.</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_indexing_vector</span><span class="op">[</span><span class="op">-</span><span class="fu">c</span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">32</span><span class="op">)</span><span class="op">]</span> <span class="co"># this removes all indexes from 11 to 32</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<p>The same rules apply for all types of vectors (numeric and
character).</p>
<div id="tip-think-about-the-future" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-think-about-the-future" class="callout-inner">
<h3 class="callout-title">Tip: Think about the future</h3>
<div class="callout-content">
<p>Excluding by index is a simple way to clean vectors. However, think
about what happens if you accidentally run the command
<code>vector &lt;- vector[-1]</code> twice, instead of once?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>The first element is going to be excluded twice. This means that the
vector will lose two elements. In principle, it is a good idea to write
code that you can run multiple times without causing unwanted issues. To
achieve this, either use a different way to exclude the first element
that we will talk about later, or simply assign the cleaned vector a new
name:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cleaned_vector</span> <span class="op">&lt;-</span> <span class="va">vector</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<p>Now, no matter how often you run this piece of code,
<code>cleaned_vector</code> will always be <code>vector</code> without
the first entry.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="filtering-vectors">Filtering vectors<a class="anchor" aria-label="anchor" href="#filtering-vectors"></a>
</h2>
<hr class="half-width">
<p>In most cases, you don’t know what the element of the vector is you
want to exclude. You might know that some values are impossible or not
of interest, but don’t know where they are. For example, the accuracy
vector of a response time task might look like this:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">accuracy_coded</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">99</span>, <span class="fl">1</span>, <span class="fl">11</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">accuracy_coded</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  0  1  1  1  1 -2 99  1 11  0</code></pre>
</div>
<p><code>-2</code> and <code>99</code> are often used to indicate
invalid button-presses or missing responses. <code>11</code> in this
case is a wrong entry that should be corrected to <code>1</code>.</p>
<p>If we were to compute the average accuracy now using
<code>mean()</code> we would receive a wrong response.</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">accuracy_coded</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 11.3</code></pre>
</div>
<p>Therefore, we need to exclude all invalid values before continuing
our analysis. Before I show you how I would go about doing this, think
about it yourself. You do not need to know the code, yet. Just think
about some rules and steps that need to be taken to clean up the
accuracy vector. What comparisons could you use?</p>
<div id="important-the-silent-ones-are-the-worst" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="important-the-silent-ones-are-the-worst" class="callout-inner">
<h3 class="callout-title">Important: The silent ones are the worst</h3>
<div class="callout-content">
<p>The above example illustrates something very important. R will not
throw an error every time you do something that doesn’t make sense. You
should be really careful of “silent” errors. The <code>mean()</code>
function above works exactly as intended, but returns a completely
nonsensical value. You should always conduct <em>sanity checks</em>. Can
mean accuracy be higher than 1? How many entries am I expecting in my
data?</p>
</div>
</div>
</div>
<p>Now, back to the solution to the wacky accuracy data. Note that R
gives us the opportunity to do things in a million different ways. If
you came up with something different from what was presented here,
great! Make sure it works and if so, use it!</p>
<p>First, we need to recode the wrong entry. That <code>11</code> was
supposed to be a <code>1</code>, but someone entered the wrong data in
the excel. To do this, we can find the index, or the element number,
where accuracy is 11. Then, we can replace that entry with 1.</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index_where_accuracy_11</span> <span class="op">&lt;-</span> <span class="fu">which</span><span class="op">(</span><span class="va">accuracy_coded</span> <span class="op">==</span> <span class="fl">11</span><span class="op">)</span></span>
<span></span>
<span><span class="va">accuracy_coded</span><span class="op">[</span><span class="va">index_where_accuracy_11</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># or in one line:</span></span>
<span><span class="co"># accuracy_coded[which(accuracy_coded == 11)] &lt;- 1</span></span>
<span></span>
<span><span class="va">accuracy_coded</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1]  0  1  1  1  1 -2 99  1  1  0</code></pre>
</div>
<p>Now, we can simply exclude all values that are not equal to 1 or 0.
We do this using the <code>-</code> operators:</p>
<div class="codewrapper sourceCode" id="cb55">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">accuracy_coded</span><span class="op">[</span><span class="op">-</span><span class="fu">which</span><span class="op">(</span><span class="va">accuracy_coded</span> <span class="op">!=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">accuracy_coded</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0 1 1 1 1 1 1 0</code></pre>
</div>
<p>However, note that this reduces the number of entries we have in our
vector. This may not always be advisable. Therefore, it is often better
to replace invalid values with <code>NA</code>. The value
<code>NA</code> (not available) indicates that something is not a
number, but just missing.</p>
<div class="codewrapper sourceCode" id="cb57">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note that now we are not using the - operator</span></span>
<span><span class="co"># We want to replace values that are not 0 or 1</span></span>
<span><span class="va">accuracy_coded</span><span class="op">[</span><span class="fu">which</span><span class="op">(</span><span class="va">accuracy_coded</span> <span class="op">!=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">accuracy_coded</span> <span class="op">!=</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></code></pre>
</div>
<p>Now, we can finally compute the average accuracy in our fictional
experiment.</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">accuracy_coded</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] NA</code></pre>
</div>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1:</h3>
<div class="callout-content">
<p>We did not get a number in the above code. Figure out why and how to
fix this. You are encourage to seek help on the internet.</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2:</h3>
<div class="callout-content">
<p>Below is a vector of response times. Compute the mean response time,
the standard deviation, and get the number of entries in this
vector.</p>
<div class="codewrapper sourceCode" id="cb60">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response_times_ms</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="fl">230.7298</span>, <span class="fl">620.6292</span>, <span class="fl">188.8168</span>, <span class="fl">926.2940</span>, <span class="fl">887.4730</span>,</span>
<span>  <span class="fl">868.6299</span>, <span class="fl">834.5548</span>, <span class="fl">875.2154</span>, <span class="fl">239.7057</span>, <span class="fl">667.3095</span>,</span>
<span>  <span class="op">-</span><span class="fl">142.891</span>, <span class="fl">10000</span>, <span class="fl">876.9879</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3:</h3>
<div class="callout-content">
<p>There might be some wrong values in the response times vector from
above. Use <code>hist()</code> to inspect the distribution of response
times. Figure out which values are implausible and exclude them.
Recompute the mean response time, standard deviation, and the number of
entries.</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4:</h3>
<div class="callout-content">
<p>Get the average weight (column <em>wt</em>) of cars in the
<code>mtcars</code> data . Can you spot any outliers in the
histogram?</p>
<p>Exclude the “outlier” and rerun the analyses.</p>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5:</h3>
<div class="callout-content">
<p>Get the mean values of responses to this fictional questionnaire:</p>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">item_15_responses</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"none"</span>, <span class="st">"4"</span>, <span class="st">"1"</span>, <span class="st">"3"</span>, <span class="st">"2"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, <span class="st">"none"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="challenge-6-difficult" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6-difficult" class="callout-inner">
<h3 class="callout-title">Challenge 6 (difficult):</h3>
<div class="callout-content">
<p>Compute the average of responses that are valid as indicated by the
vector <code>is_response_valid</code>:</p>
<div class="codewrapper sourceCode" id="cb62">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response_values</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="fl">91</span>, <span class="fl">82</span>, <span class="fl">69</span>, <span class="fl">74</span>, <span class="fl">62</span>, <span class="fl">19</span>, <span class="fl">84</span>, <span class="fl">61</span>, <span class="fl">92</span>, <span class="fl">53</span><span class="op">)</span></span>
<span><span class="va">is_response_valid</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"yes"</span>, <span class="st">"yes"</span>, <span class="st">"yes"</span>, <span class="st">"yes"</span>, <span class="st">"yes"</span>,</span>
<span>                       <span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="st">"yes"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_responses</span> <span class="op">&lt;-</span> <span class="va">response_values</span><span class="op">[</span><span class="fu">which</span><span class="op">(</span><span class="va">is_response_valid</span> <span class="op">==</span> <span class="st">"yes"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">valid_responses</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 76.875</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Scripts facilitate reproducible research</li>
<li>create vectors using <code>c()</code>
</li>
<li>Numeric variables are used for computations, character variables
often contain additional information</li>
<li>You can index vectors by using <code>vector[index]</code> to return
or exclude specific indices</li>
<li>Use <code>which()</code> to filter vectors based on specific
conditions</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-projects"><p>Content from <a href="projects.html">Projects</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/projects.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is an R project?</li>
<li>How do projects help me organize my scripts.</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how projects can provide structure</li>
<li>Explain what a “working directory” is and how to access files</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="working-directory">Working Directory<a class="anchor" aria-label="anchor" href="#working-directory"></a>
</h2>
<hr class="half-width">
<p>Last week we worked with scripts and some basic computations using
vectors. Most likely, you wrote down a lot of code and saved the script
somewhere on your computer. Once you start working with multiple scripts
and datasets, it becomes very important that you keep your files
somewhat orderly.</p>
<p>This is important both for us humans to understand, but also for
computers. Any time you need to access something outside your present R
script, you will need to tell R where to find this. The data will be
saved somewhere on the computer and needs to find its way into the R
session.</p>
<p>Understanding where a file is saved on your computer is key to
understanding how to tell R to read it into your current session. There
are two main ways to tell R how to find a file: <em>absolute</em> paths
and <em>relative</em> paths.</p>
<div class="section level3">
<h3 id="absolute-paths">Absolute Paths<a class="anchor" aria-label="anchor" href="#absolute-paths"></a>
</h3>
<p>An <strong>absolute path</strong> is the full location of a file on
your computer, starting from the root of your file system. It tells R
exactly where to find the file, no matter where your R script is
located. Think of it like an address in a town. <em>1404 Mansfield St,
Chippewa Falls, WI 54729</em> tells you exactly where a house is
located.</p>
<p>For example, the absolute path to a file stored in the
<code>Documents/</code> folder most likely looks something like
this:</p>
<ul>
<li>
<strong>Windows:</strong>
<code>"C:/Users/YourName/Documents/my_data.csv"</code><br>
</li>
<li>
<strong>Mac/Linux:</strong>
<code>"/Users/YourName/Documents/my_data.csv"</code>
</li>
</ul>
<div id="how-to-find-the-absolute-path-of-a-file" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="how-to-find-the-absolute-path-of-a-file" class="callout-inner">
<h3 class="callout-title">How to Find the Absolute Path of a File:</h3>
<div class="callout-content">
<ul>
<li><p>On <strong>Windows</strong>, open File Explorer, navigate to your
file, right-click it, and select <strong>Properties</strong>. The full
file path will be shown in the “Location” field.</p></li>
<li><p>On <strong>Mac</strong>, open Finder, right-click the file,
select <strong>Get Info</strong>, and look at “Where.”<br></p></li>
</ul>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="relative-paths">Relative Paths<a class="anchor" aria-label="anchor" href="#relative-paths"></a>
</h3>
<p>A <strong>relative path</strong> specifies the location of a file in
relation to the <strong>working directory</strong> of your R session.
This is useful when working with projects that contain multiple files,
as it keeps your code flexible and portable. Think of this like the
direction, “just follow the road until the roundabout and then take the
second exit”. If the starting point is well defined, this is enough
information to find the target.</p>
<p>The <strong>working directory</strong> is the default folder on your
computer where R looks for files and saves new ones. Think of it as R’s
<strong>“home base”</strong>—if you ask R to read or save a file without
giving a full path, it will assume you’re talking about this
location.</p>
<p>You can check your current working directory by running:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">getwd</span><span class="op">(</span><span class="op">)</span>  <span class="co"># This tells you where R is currently looking for files</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "/home/runner/work/r-for-empra/r-for-empra/site/built"</code></pre>
</div>
<p>In our case, this means if you try to read a file like this:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv</span><span class="op">(</span><span class="st">"data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>R will look for <code>data.csv</code> inside
/home/runner/work/r-for-empra/r-for-empra/site/built.</p>
<p>If your files are stored somewhere else, you can change the working
directory using:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">setwd</span><span class="op">(</span><span class="st">"C:/Users/YourName/Desktop/MyNewFolder"</span><span class="op">)</span>  <span class="co"># Set a new working directory</span></span></code></pre>
</div>
<p>Now, R will assume all file paths start from
<code>"C:/Users/YourName/Desktop/MyNewFolder"</code>.</p>
<p>There are two main ways to define the working directory that R will
use. You can do this using <code>setwd()</code> and specify a particular
directory you want to start from. Another way to accomplish this is
through the use of <strong>R projects</strong>. These projects
automatically set your working directory to the place that the project
is located. More about projects in just a second.</p>
<p>If you prefer declaring your working directory using
<code>setwd()</code>, you can place this bit of code
<code>setwd(dirname(rstudioapi::getActiveDocumentContext()$path))</code>
at the beginning of your script. R will then set the working directory
to the folder that the script you are working with is located in.</p>
</div>
<div class="section level3">
<h3 id="why-is-the-working-directory-important">Why is the Working Directory Important?<a class="anchor" aria-label="anchor" href="#why-is-the-working-directory-important"></a>
</h3>
<ul>
<li>It <strong>saves you from typing long file paths</strong> every time
you load data.<br>
</li>
<li>It <strong>keeps projects organized</strong> by ensuring all files
are in a central location.<br>
</li>
<li>It <strong>makes your code portable</strong>, so if you share your
project, others won’t need to change file paths manually.</li>
</ul>
</div>
</section><section><h2 class="section-heading" id="r-projects">R Projects<a class="anchor" aria-label="anchor" href="#r-projects"></a>
</h2>
<hr class="half-width">
<p>I do not recommend using <code>setwd()</code>. Instead, I would
suggest using R projects. When working in <strong>RStudio</strong>,
using <strong>R Projects</strong> is one of the best ways to keep your
work organized, portable, and efficient. An <strong>R Project</strong>
is essentially a self-contained workspace that helps manage files,
working directories, and settings automatically.</p>
<p>There are several reasons why I prefer R projects:</p>
<div class="section level4">
<h4 id="automatic-working-directory-management">1️⃣ <strong>Automatic Working Directory Management</strong>
<a class="anchor" aria-label="anchor" href="#automatic-working-directory-management"></a>
</h4>
<p>When you open an R Project, RStudio <strong>automatically</strong>
sets the working directory to the project’s folder. This means you don’t
have to use <code>setwd()</code> manually or worry about absolute file
paths.</p>
<p>Example:<br>
- If your project folder is
<code>C:/Users/YourName/Documents/MyProject</code>, then any file in
this folder can be accessed with a <strong>relative path</strong>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/my_data.csv"</span><span class="op">)</span>  <span class="co"># No need for long paths!</span></span></code></pre>
</div>
</div>
<div class="section level4">
<h4 id="keeps-everything-organized">2️⃣ <strong>Keeps Everything Organized</strong>
<a class="anchor" aria-label="anchor" href="#keeps-everything-organized"></a>
</h4>
<p>An R Project keeps <strong>all related files</strong>—scripts,
datasets, plots, and outputs—in one place. This is especially useful
when working on multiple projects, preventing files from getting mixed
up.</p>
<p>A typical project folder might look like this:</p>
<pre><code>MyProject/
│── data/         # Raw data files
│── scripts/      # R scripts
│── output/       # Processed results
│── MyProject.Rproj  # The project file</code></pre>
<p>This structure helps keep your work clean and easy to navigate.</p>
</div>
<div class="section level4">
<h4 id="easier-collaboration-portability">3️⃣ <strong>Easier Collaboration &amp; Portability</strong>
<a class="anchor" aria-label="anchor" href="#easier-collaboration-portability"></a>
</h4>
<p>If you share your project folder, others can open the
<code>.Rproj</code> file in RStudio and immediately start working—no
need to change file paths or set up the environment manually. This makes
R Projects ideal for:<br>
✅ <strong>Teamwork</strong><br>
✅ <strong>Sharing with collaborators</strong><br>
✅ <strong>Reproducible research</strong></p>
</div>
<div class="section level4">
<h4 id="integrated-version-control-git">4️⃣ <strong>Integrated Version Control (Git)</strong>
<a class="anchor" aria-label="anchor" href="#integrated-version-control-git"></a>
</h4>
<p>If you use Git for version control, R Projects make it simple to
track changes, commit updates, and collaborate through platforms like
<strong>GitHub</strong>. You can set up a Git repository directly inside
the project.</p>
</div>
<div class="section level4">
<h4 id="easy-switching-between-projects">5️⃣ <strong>Easy Switching Between Projects</strong>
<a class="anchor" aria-label="anchor" href="#easy-switching-between-projects"></a>
</h4>
<p>With R Projects, you can <strong>quickly switch</strong> between
different tasks without affecting the working directory or opening and
closing scripts. Each project remembers its settings, so you don’t have
to reconfigure things every time.</p>
</div>
</section><section><h2 class="section-heading" id="how-to-create-an-r-project">How to Create an R Project<a class="anchor" aria-label="anchor" href="#how-to-create-an-r-project"></a>
</h2>
<hr class="half-width">
<p>1️⃣ Open <strong>RStudio</strong><br>
2️⃣ Click <strong>File</strong> → <strong>New Project</strong><br>
3️⃣ Choose <strong>New Directory</strong> (or an existing folder)<br>
4️⃣ Select <strong>New Project</strong> and give it a name<br>
5️⃣ Click <strong>Create Project</strong> 🎉</p>
<p>Now, whenever you open the <code>.Rproj</code> file, RStudio will
automatically set everything up for you!</p>
<p>You can open a project using <code>File &gt; Open Project</code> in
the top left of R Studio. You will then notice the projects name
appearing in the top right. Furthermore, the <code>Files</code> view in
the bottom right will automatically go to the destination of your
selected project.</p>
</section><section><h2 class="section-heading" id="creating-an-r-project">Creating an R project<a class="anchor" aria-label="anchor" href="#creating-an-r-project"></a>
</h2>
<hr class="half-width">
<p>Let’s go through the steps of setting up an R project together.
First, decide if you want to use an existing folder or generate a brand
new folder for your R project. I would suggest using a folder that is
clean. For example, use the folder <code>r_for_empra</code> that you
created a couple lessons earlier!</p>
<p>To create a project, follow the steps outlined above. Make sure the
creation of your project was successful and you can see the name of your
project in the top right corner. If you are creating the project in a
new folder, you will have to give it a sensible name!</p>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1:</h3>
<div class="callout-content">
<p>Make sure you have the project created. In the folder that the
project is created in, add the following sub-folders: <code>data</code>,
<code>processed_data</code> and <code>archive</code>. You can do this
either in the file explorer of your computer, or by using the bottom
right window of RStudio.</p>
<p><code>data</code> will house all the raw data files that we are
working with in this tutorial. <code>processed_data</code> will be used
to save data that we processed in some way and want to reuse later on.
<code>archive</code> is a folder to store old scripts or data-sets that
you will no longer use. You can also delete those files, but I often
find it easier to just “shove them under the bed” so that I
<em>could</em> still use them later on.</p>
<p>Get an overview of the folders in your project by running
<code>list.dirs(recursive = FALSE)</code>. This should return the
folders you just created and a folder where R-project information is
stored.</p>
<p>If you do not see the folders you just created, make sure you created
and opened the project and that the folders are in the same space as
your <code>.Rproj</code> project file.</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2:</h3>
<div class="callout-content">
<p>Download the following <a href="data/roy_kent_f_count.csv">data</a>
and place it in the <code>data</code> folder. Make sure to give it an
appropriate name. The data contains information about the number of
times the character <em>Roy Kent</em> used the f-word in the show
<em>Ted Lasso</em>.</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3:</h3>
<div class="callout-content">
<p>Test the data you just downloaded. Read it into R and give it an
appropriate name.</p>
<p>Hint: You may need to research how to read <code>.csv</code> files
into R first.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roy_kent_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/roy_kent_f_count.csv"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4:</h3>
<div class="callout-content">
<p>Familiarize yourself with the data. What columns are there (use
<code>colnames(data)</code>). Compute the average amount of times Roy
Kent says “Fuck” in an episode. Compute the total amount of times he
said it throughout the series.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">average_f_count</span> <span class="op">&lt;-</span> <span class="fu">mean</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">$</span><span class="va">F_count_RK</span><span class="op">)</span></span>
<span><span class="va">total_f_count</span> <span class="op">&lt;-</span> <span class="fu">sum</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">$</span><span class="va">F_count_RK</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Because, cum_rk_overall is a running (cumulative) total:</span></span>
<span><span class="va">total_f_count</span> <span class="op">&lt;-</span> <span class="fu">max</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">$</span><span class="va">cum_rk_overall</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>The <strong>working directory</strong> is where R looks for and
saves files.<br>
</li>
<li>Absolute paths give full file locations; relative paths use the
working directory.<br>
</li>
<li>
<strong>R Projects</strong> manage the working directory
automatically, keeping work organized.<br>
</li>
<li>Using R Projects makes code <strong>portable, reproducible, and
easier to share</strong>.<br>
</li>
<li>A structured project with separate folders for data and scripts
improves workflow.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-data-visualization-01"><p>Content from <a href="data-visualization-01.html">Data Visualization (1)</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/data-visualization-01.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can you get an overview of data?</li>
<li>How do you visualize distributions of data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to read in <code>.csv</code> files</li>
<li>Learn how to explore a dataset for the first time</li>
<li>Learn how to visualize key statistics of data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="reading-in-data">Reading in data<a class="anchor" aria-label="anchor" href="#reading-in-data"></a>
</h2>
<hr class="half-width">
<p>You already had to read in data in the last lesson. Data comes in
many shapes and sizes. The format of data you had to read in the last
session is called <code>csv</code>, for <em>comma-separated values</em>.
This is one of the most common data formats. It gets its name because
all values are separated from each other using a comma “,”. Here in
Germany, <code>csv</code> files are sometimes separated by a semicolon
“;” instead. This can be adjusted in R-code by using
<code>read.csv("path/to/file", sep = ";")</code> and declaring the
semicolon as the separating variable.</p>
<div id="reading-data-requires-specific-functions" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="reading-data-requires-specific-functions" class="callout-inner">
<h3 class="callout-title">Reading data requires specific functions</h3>
<div class="callout-content">
<p>There are several other common formats including <code>.xlsx</code>
for excel files, <code>.sav</code> for SPSS files, <code>.txt</code> for
simple text files and <code>.rdata</code> for a special R-specific data
format. These files can not be read in by <code>read.csv()</code>, as
this is only for <code>.csv</code> files. Instead, use specific
functions for each format like <code>readxl::read_excel()</code>, or
<code>haven::read_sav()</code>.</p>
</div>
</div>
</div>
<p>Let’s again read in the data about Roy Kent’s potty-mouth.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">roy_kent_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/roy_kent_f_count.csv"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/ted-lasso-roy-kent-fuck.gif" alt="GIF of Roy swearing." class="figure mx-auto d-block"><div class="figcaption">Roy Kent saying Fuck</div>
</figure></section><section><h2 class="section-heading" id="getting-a-glimpse-of-the-data">Getting a glimpse of the data<a class="anchor" aria-label="anchor" href="#getting-a-glimpse-of-the-data"></a>
</h2>
<hr class="half-width">
<p>When starting out with some data you received, it is important to
familiarize yourself with the basics of this data first. What columns
does it have, what information is contained in each row? What do the
columns mean?</p>
<p>One option to get a quick overview of the data is… just looking at
it! By clicking on the data in the <em>Environment</em> tab or typing
<code>View(roy_kent_data)</code> in the console, you can inspect the
data in R Studio. This will already show you how many observations (in
this case rows) and variables (columns) the data has. We can also
inspect the column names and see the first few entries. Look at the
data, what might each column represent?</p>
<p>Now, let’s go back to using programming to inspect data. We already
learned about the handy function <code>glimpse()</code>, for which we
need the <code>dplyr</code> package.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 34
Columns: 16
$ Character         &lt;chr&gt; "Roy Kent", "Roy Kent", "Roy Kent", "Roy Kent", "Roy…
$ Episode_order     &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…
$ Season            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2…
$ Episode           &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 1, 2, 3, 4, 5, 6, 7, …
$ Season_Episode    &lt;chr&gt; "S1_e1", "S1_e2", "S1_e3", "S1_e4", "S1_e5", "S1_e6"…
$ F_count_RK        &lt;int&gt; 2, 2, 7, 8, 4, 2, 5, 7, 14, 5, 11, 10, 2, 2, 23, 12,…
$ F_count_total     &lt;int&gt; 13, 8, 13, 17, 13, 9, 15, 18, 22, 22, 16, 22, 8, 6, …
$ cum_rk_season     &lt;int&gt; 2, 4, 11, 19, 23, 25, 30, 37, 51, 56, 11, 21, 23, 25…
$ cum_total_season  &lt;int&gt; 13, 21, 34, 51, 64, 73, 88, 106, 128, 150, 16, 38, 4…
$ cum_rk_overall    &lt;int&gt; 2, 4, 11, 19, 23, 25, 30, 37, 51, 56, 67, 77, 79, 81…
$ cum_total_overall &lt;int&gt; 13, 21, 34, 51, 64, 73, 88, 106, 128, 150, 166, 188,…
$ F_score           &lt;dbl&gt; 0.1538462, 0.2500000, 0.5384615, 0.4705882, 0.307692…
$ F_perc            &lt;dbl&gt; 15.4, 25.0, 53.8, 47.1, 30.8, 22.2, 33.3, 38.9, 63.6…
$ Dating_flag       &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "Yes", "Ye…
$ Coaching_flag     &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No", "No"…
$ Imdb_rating       &lt;dbl&gt; 7.8, 8.1, 8.5, 8.2, 8.9, 8.5, 9.0, 8.7, 8.6, 9.1, 7.…</code></pre>
</div>
<p>This will tell us the variable type of each column, too. We can see
that the first column is a character column which just contains the name
of the hero of this data <em>Roy Kent</em>. The second column is an
integer (so whole numbers) vector with information about the episode
number.</p>
<p>Next, let’s try to figure out what each of the column names mean and
what type of information is stored here. Some columns are
self-explanatory like <code>Season</code> or <code>Episode</code>.
Others might require a bit of background knowledge like
<code>Imdb_rating</code>, which requires you to know about the
film-rating platform “Imdb”.</p>
<p>Some columns are riddled with abbreviations that make their names
easier to write, but harder to understand. <code>F_count_RK</code> is
using RK as an abbreviation of Roy Kent and F as an abbreviation for…
something else. <code>cum_rk_overall</code> is a cumulative (running)
total of the number of times Roy used the F-word.</p>
<p>Yet other columns are really difficult to understand, because the
implication is not 100% clear. What does <code>F_count_total</code>
mean? The number of times “Fuck” was said in an episode? Seems like a
reasonable guess, but in order to be sure, it’s best if we had some
documentation of the data’s author’s intentions. This is often called a
<em>codebook</em>, where the person compiling data writes down
information about the meaning of column names, cleaning procedures and
other oddities of the data. When sharing your own data online, this is
essential in order to make your data useable for others.</p>
<p>There is no codebook included in this workshop, but you can find it
online. The data is taken from an event called “Tidy-Tuesday”, a weekly
event about cleaning and presenting interesting data using R. You can
find information about the Roy Kent data <a href="https://github.com/rfordatascience/tidytuesday/blob/main/data/2023/2023-09-26/readme.md" class="external-link">here</a>.
Give it a read in order to make sure you know what all the columns are
about.</p>
</section><section><h2 class="section-heading" id="inspecting-important-values">Inspecting important values<a class="anchor" aria-label="anchor" href="#inspecting-important-values"></a>
</h2>
<hr class="half-width">
<p>Now that we understand the structure of the data and the names of the
columns, we can start getting a look at the data itself. A good way to
get an overview of data with loads of numeric variables is
<code>psych::describe()</code>. This outputs you some basic descriptive
statistics of the data.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">psych</span><span class="fu">::</span><span class="fu">describe</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">)</span> <span class="co"># describe() function from psych package</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>                  vars  n   mean     sd median trimmed    mad   min    max
Character*           1 34   1.00   0.00   1.00    1.00   0.00  1.00   1.00
Episode_order        2 34  17.50   9.96  17.50   17.50  12.60  1.00  34.00
Season               3 34   2.06   0.81   2.00    2.07   1.48  1.00   3.00
Episode              4 34   6.21   3.37   6.00    6.18   4.45  1.00  12.00
Season_Episode*      5 34  17.50   9.96  17.50   17.50  12.60  1.00  34.00
F_count_RK           6 34   8.82   5.63   7.50    8.25   5.19  2.00  23.00
F_count_total        7 34  21.82  11.53  18.00   20.86   8.15  6.00  46.00
cum_rk_season        8 34  53.79  37.29  50.00   51.36  40.77  2.00 138.00
cum_total_season     9 34 126.32  93.71 110.50  115.79  88.96 13.00 377.00
cum_rk_overall      10 34 130.74  92.69 124.50  127.25 118.61  2.00 300.00
cum_total_overall   11 34 308.09 215.14 275.50  296.61 246.11 13.00 742.00
F_score             12 34   0.40   0.15   0.36    0.38   0.15  0.15   0.72
F_perc              13 34  39.57  15.02  35.70   38.49  15.20 15.40  71.90
Dating_flag*        14 34   1.44   0.50   1.00    1.43   0.00  1.00   2.00
Coaching_flag*      15 34   1.59   0.50   2.00    1.61   0.00  1.00   2.00
Imdb_rating         16 34   8.33   0.66   8.50    8.39   0.59  6.60   9.40
                   range  skew kurtosis    se
Character*          0.00   NaN      NaN  0.00
Episode_order      33.00  0.00    -1.31  1.71
Season              2.00 -0.10    -1.53  0.14
Episode            11.00  0.06    -1.26  0.58
Season_Episode*    33.00  0.00    -1.31  1.71
F_count_RK         21.00  0.79     0.05  0.97
F_count_total      40.00  0.78    -0.58  1.98
cum_rk_season     136.00  0.48    -0.82  6.39
cum_total_season  364.00  0.93     0.16 16.07
cum_rk_overall    298.00  0.28    -1.27 15.90
cum_total_overall 729.00  0.42    -1.06 36.90
F_score             0.56  0.60    -0.74  0.03
F_perc             56.50  0.60    -0.74  2.58
Dating_flag*        1.00  0.23    -2.01  0.09
Coaching_flag*      1.00 -0.34    -1.94  0.09
Imdb_rating         2.80 -0.81     0.31  0.11</code></pre>
</div>
<p>In my opinion, the most important information in this table are the
mean value of a column and the maximum and minimum value. The mean value
reveals some important information about the average value of a given
variable, duh… And the minimum and maximum value can reveal issues in
the data. Is the minimum age -2? Or the maximum IQ 1076? Something might
be wrong in this data, and looking at the minimum and maximum values
might already give you a clue. In this data, none of the maxima or
minima seem to be a problem, as they are all in reasonable ranges.</p>
<p>Let’s start visualizing some basic information. I have already
proclaimed my love for histograms as a quick and dirty tool to get an
overview and the simplicity of its code is a reason why!</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">$</span><span class="va">F_count_RK</span><span class="op">)</span> <span class="co"># Recall that the $ operator gets you a variable from a dataframe</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Only 5 bars seem to be to few to visualize the distribution
adequately, so lets try 10 instead.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">$</span><span class="va">F_count_RK</span>, breaks <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="fig/data-visualization-01-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure">
This already provides us some more useful information. Roy seems to
swear between 0 and 12 times most often and swears a lot in two
episodes.</p>
<p>Let’s try increasing the number of breaks to 20.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">$</span><span class="va">F_count_RK</span>, breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Here, an interesting pattern seems to emerge. Three different
clusters of swear counts show up, one where Roy swears between 0 - 7
times, presumably because he has little screen-time in the episode. One
cluster where Roy swears between 9-17 times, which more closely
resembles his average swearing amount. And finally two episodes where
Roy flies of the handle and swears a whopping
<code>max(roy_kent_data$F_count_RK) =</code> 23 times!</p>
<p>In order to figure out what makes Roy swear so much, let’s plot the
number of times Roy swears by episode!</p>
</section><section><h2 class="section-heading" id="ggplot2">ggplot2<a class="anchor" aria-label="anchor" href="#ggplot2"></a>
</h2>
<hr class="half-width">
<p>For most of our plotting needs (except the beautiful
<code>hist()</code>), we will make use of the package
<code>ggplot2</code> which is part of the larger collection of packages
<code>tidyverse</code> and provides some really useful plotting
functions. Most importantly, ggplot provides a useful <em>grammar</em>
of plotting functions that always follow the same format.</p>
<p>You start out with the function <code>ggplot()</code> and give it our
data, simple enough. Here, we start working with the entire dataframe,
not just vectors. We can simply pass it into <code>ggplot()</code> and
later on declare which variables we want to use.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">roy_kent_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in ggplot(data = roy_kent_data): could not find function "ggplot"</code></pre>
</div>
<p>Oops, R tells us that it cannot find this function. Most of the time,
this is because you forgot to load the package beforehand. Let’s try
again:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">roy_kent_data</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Now it works, but not really. For now, this code only tells the
function which data we are using, not what to do with it.</p>
<p>In order to actually see a plot, we need to provide information about
the visual properties, the <em>aesthetics</em> that the plot should
have. The <code>mapping</code> argument tells the function how the data
relates to the visual properties of the plot. We define this mapping
using the function <code>aes()</code>. Here, we declare the columns that
we want on the x-axis and y-axis.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">roy_kent_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Episode_order</span>, y <span class="op">=</span> <span class="va">F_count_RK</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>While we cannot see anything useful yet, we already notice some
changes. The plot now correctly shows the names of the variables on the
axes. Also, the ranges of numbers printed on the axes matches the
minimum and maximum values.</p>
<p>Now that we provided the data and the mapping of variables to the
plot, we can start building our proper visualization. This is done
<em>on top</em> of the basics declared in <code>ggplot()</code>. This
technique is called <em>layering</em> and it allows you to combine
multiple new changes to a plot easily using a simple <code>+</code>. To
add a plot showing the number of Fucks given by Roy during an episode,
we can use <code>geom_point()</code>.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">roy_kent_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Episode_order</span>, y <span class="op">=</span> <span class="va">F_count_RK</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p><code>geom_point()</code> adds a simple scatter-plot element to the
graph.</p>
<p>We can change the labels to make the graph more polished using
<code>labs()</code>.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">roy_kent_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Episode_order</span>, y <span class="op">=</span> <span class="va">F_count_RK</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"# of F*cks said by Roy Kent"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Episode Number"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"# of F*cks"</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>There seems to be a small trend showing that Roy swears more later in
the series. We can visualize this trend by adding another layered visual
<code>geom_smooth()</code>.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">roy_kent_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Episode_order</span>, y <span class="op">=</span> <span class="va">F_count_RK</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"# of F*cks said by Roy Kent"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Episode Number"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"# of F*cks"</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, <span class="co"># this forces the trend-line to be linear</span></span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>What might be causing this trend? Well, one possible candidate is
that Roy goes from being a player on the team to being a coach on the
team. This might cause him to yell at more people than usual. The
variable that contains this information is <code>Coaching_flag</code>.
Let’s learn something about it:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">$</span><span class="va">Coaching_flag</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
 No Yes
 14  20 </code></pre>
</div>
<p>It seems to have two values “Yes” and “No”, each being represented in
the data more than 10 times.</p>
<p>We can also add this to our visualization from earlier, coloring in
the dots by whether Roy was coaching or not. In order to do this, we
need to add the <code>color</code> variable in the aesthetics mapping in
the <code>ggplot()</code> function.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">roy_kent_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Episode_order</span>, y <span class="op">=</span> <span class="va">F_count_RK</span>, color <span class="op">=</span> <span class="va">Coaching_flag</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"# of F*cks said by Roy Kent"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Episode Number"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"# of F*cks"</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, <span class="co"># this forces the trend-line to be linear</span></span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-14-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Now, a clearer picture emerges. Roy starts of pretty slow as a
player, but then begins to swear a lot in the episodes that he is
coaching in.</p>
<div id="making-plots-prettier-using-themes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="making-plots-prettier-using-themes" class="callout-inner">
<h3 class="callout-title">Making plots prettier using themes</h3>
<div class="callout-content">
<p>The basic plots already look okay and are enough for just finding
something out about data. But you can make them even more enticing by
using a theme. Themes in ggplot are collections of visual settings that
control the background of the plot, the text size of the axis and some
other things.</p>
<p>I often use <code>theme_classic()</code> or
<code>theme_minimal()</code>, but you can try out different themes or
even write your own!</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">roy_kent_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Episode_order</span>, y <span class="op">=</span> <span class="va">F_count_RK</span>, color <span class="op">=</span> <span class="va">Coaching_flag</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"# of F*cks said by Roy Kent"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Episode Number"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"# of F*cks"</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"lm"</span>, <span class="co"># this forces the trend-line to be linear</span></span>
<span>    se <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-15-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Figure out what information is stored in the column
<code>F_count_total</code>. Compute the descriptive information (mean,
standard deviation, minimum and maximum) for this variable.</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Compare the descriptive information to those for
<code>F_count_RK</code>. Which one is bigger, why?</p>
<p>Compute the difference between the two variables. What does it
represent. Compare the difference to <code>F_count_RK</code>. Which has
the higher average value?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_count_others</span> <span class="op">&lt;-</span> <span class="va">roy_kent_data</span><span class="op">$</span><span class="va">F_count_total</span> <span class="op">-</span> <span class="va">roy_kent_data</span><span class="op">$</span><span class="va">F_count_RK</span></span>
<span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">f_count_others</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 13</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">roy_kent_data</span><span class="op">$</span><span class="va">F_count_RK</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 8.823529</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Plot a histogram of <code>F_count_total</code>. Try different values
of <code>breaks</code>, which seems most interesting to you?</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>Visualize the relationship between the amount of time Roy Kent said
“Fuck” and the Imdb rating of that episode using
<code>geom_point()</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">roy_kent_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">F_count_RK</span>, y <span class="op">=</span> <span class="va">Imdb_rating</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Relationship between F-count and episode rating"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"# of F*cks"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Imdb Rating"</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-01-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>Be creative! What else can you notice in the data? Try to make an
interesting plot.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Get an overview of the data by inspecting it or using
<code>glimpse()</code> / <code>describe()</code>
</li>
<li>Consult a codebook for more in-depth descriptions of the variables
in the data</li>
<li>Visualize the distribution of a variable using
<code>hist()</code>
</li>
<li>Use <code>ggplot(data = data, mapping = aes())</code> to provide the
data and mapping to the plots</li>
<li>Add visualization steps like <code>geom_point()</code> or
<code>geom_smooth()</code> using <code>+</code>
</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-data-visualization-02"><p>Content from <a href="data-visualization-02.html">Data Visualization (2)</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/data-visualization-02.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can you visualize categorical data?</li>
<li>How to visualize the relationship of categorical and numerical
data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Get to know the DASS data from Kaggle</li>
<li>Explain how to plot distribution of numerical data using
<code>geom_histogram()</code> and <code>geom_density()</code>
</li>
<li>Demonstrate how to group distributions by categorical variables</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="a-new-set-of-data">A new set of data<a class="anchor" aria-label="anchor" href="#a-new-set-of-data"></a>
</h2>
<hr class="half-width">
<p>In this section, we will work with a new set of data. Download this
data <a href="data/kaggle_dass/data.csv">here</a> and place it in your
<code>data</code> folder. There is also a codebook available to download
<a href="data/kaggle_dass/codebook.txt">here</a>.</p>
<p>The data originates from an online version of the <strong>Depression
Anxiety Stress Scales (DASS)</strong>, collected between
<strong>2017-2019</strong> and retrieved from <a href="https://www.kaggle.com/datasets/lucasgreenwell/depression-anxiety-stress-scales-responses/data" class="external-link">Kaggle</a>.
Participants took the test to receive personalized results and could opt
into a research survey. The dataset includes <strong>responses to 42
DASS items</strong> (rated on a 4-point scale), <strong>response
times</strong>, and <strong>question positions</strong>. Additional data
includes:</p>
<ul>
<li>
<strong>Demographics</strong> (age, gender, education, native
language, handedness, religion, sexual orientation, race, marital
status, family size, major, country).<br>
</li>
<li>
<strong>Big Five Personality Traits</strong> (via the Ten Item
Personality Inventory - TIPI).<br>
</li>
<li>
<strong>Vocabulary Check</strong> (includes fake words for validity
checks).</li>
</ul>
<p>Let’s read in the data first. In my case, it is placed inside a
subfolder of <code>data/</code> called <code>kaggle_dass/</code>. You
may need to adjust the path on your end.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/kaggle_dass/data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>As you might already see, this data is quite large. In the
<em>Environment</em> tab we can see that it contains almost 40.000
entries and 172 variables. For now, we will be working with some of the
demographic statistics. We will delve into the actual score in a later
episode. You can find information on this data in the codebook provided
<a href="data/kaggle_dass/codebook.txt">here</a>.</p>
<p>Read this codebook in order to familiarize yourself with the data.
Then inspect it visually by clicking on the frame or running
<code>View(dass_data)</code>. What do you notice?</p>
<p>First, let’s start getting an overview of the demographics of
test-takers. What is their gender, age and education? Compute
descriptive statistics for age and inspect gender and education using
<code>table()</code></p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
    0     1     2     3
   67  8789 30367   552 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 23.61217</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sd</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 21.58172</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">range</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">age</span><span class="op">)</span> <span class="co"># This outputs min() and max() at the same time</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]   13 1998</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">table</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">education</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
    0     1     2     3     4
  515  4066 15066 15120  5008 </code></pre>
</div>
<p>The maximum value of age seems a bit implausible, unless Elrond has
decided to take the DASS after Galadriel started flirting with Sauron
(sorry, Annatar) again.</p>
</section><section><h2 class="section-heading" id="histograms">Histograms<a class="anchor" aria-label="anchor" href="#histograms"></a>
</h2>
<hr class="half-width">
<p>We can get an overview of age by using our trust
<code>hist()</code>:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>However, this graph is heavily skewed by the outliers in age. We can
address this issue easily by converting to a <code>ggplot</code>
histogram. The <code>xlim()</code> layer can restrict the values that
are displayed in the plot and gives us a warning about how many values
were discarded.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span> <span class="co"># Don't forget to load the package</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Again, the number of bins might be a bit small:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<p><img src="fig/data-visualization-02-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure">
We can also adjust the size of the bins, not the number of bins by using
the <code>binwidth</code> argument.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-6-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This gives us a nice overview of the distribution of each possible
distinct age. It seems to peak around 23 and then slowly decline in
frequency. This is in line with what you would expect from data from a
free online personality questionnaire.</p>
</section><section><h2 class="section-heading" id="density-plots">Density plots<a class="anchor" aria-label="anchor" href="#density-plots"></a>
</h2>
<hr class="half-width">
<p>Often, what interests us is not the number of occurrences for a given
value, but rather which values are common and which values are uncommon.
By dividing the number of occurrences for a given value by the total
number of observation, we can obtain a <em>density-plot</em>. In
<code>ggplot</code> you achieve this by using
<code>geom_density()</code> instead of
<code>geom_histogram()</code>.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-7-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This describes the overall age distribution, but we can also look at
the age distribution by education status. What would you expect?</p>
<p>Again, we do this by using the <code>color</code> argument in
<code>aes()</code>, as I want different colored density plots for each
education level.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="va">education</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: The following aesthetics were dropped during statistical transformation:
colour.
ℹ This can happen when ggplot fails to infer the correct grouping structure in
  the data.
ℹ Did you forget to specify a `group` aesthetic or to convert a numerical
  variable into a factor?</code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-8-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>It seems like this didn’t work. And the warning message tells us why.
We forgot to specify a <code>group</code> variable that tells the
plotting function that we not only want different colors, we also want
different lines, grouped by education status:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="va">education</span>, group <span class="op">=</span> <span class="va">education</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Because education is a numerical variable, <code>ggplot</code> uses a
sliding color scale to color its values. I think it looks a little more
beautiful if we declare that despite having numbers as entries,
<code>education</code> is not strictly numerical. The different numbers
represent distinct levels of educational attainment. We can encode this
using <code>factor()</code> to convert <code>education</code> into a
variable-type called <em>factor</em> that has this property.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span><span class="op">$</span><span class="va">education</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">education</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="va">education</span>, group <span class="op">=</span> <span class="va">education</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-10-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can make this graph look a little bit better by filling in the
area under the curves with the color aswell and making them slightly
transparent. This can be done using the <code>fill</code> argument and
the <code>alpha</code> argument. Let’s also give the graph a proper
title and labels.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span>, color <span class="op">=</span> <span class="va">education</span>, group <span class="op">=</span> <span class="va">education</span>, fill <span class="op">=</span> <span class="va">education</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Age distribution by education status"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Age"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 7 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-11-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In this graph, we can see exactly what we would expect. As the
highest achieved education increases, the age of test-takers generally
gets larger as-well. There just are very little people under 20 with a
PhD.</p>
</section><section><h2 class="section-heading" id="bar-charts">Bar Charts<a class="anchor" aria-label="anchor" href="#bar-charts"></a>
</h2>
<hr class="half-width">
<p>As a last step of exploration, let’s visualize the number of people
that achieved a certain educational status. A bar chart is perfect for
this:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">education</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-12-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This visualizes the same numbers as
<code>table(dass_data$education)</code> and sometimes, you may not need
to create a plot if the numbers already tell <em>you</em> everything you
need to know. However, remember that often you need to communicate your
results to other people. And as they say “A picture says more than 1000
words”.</p>
<p>We can also include gender as a variable here, in order to compare
educational attainment between available genders. Let’s plot gender on
the x-axis and color the different education levels.</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gender</span>, fill <span class="op">=</span> <span class="va">education</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-13-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This graph is very good at showing one thing: there are more females
in the data than males. However, this is not the comparison we are
interested in. We can plot relative frequencies of education by gender
by using the argument <code>position = "fill"</code>.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">gender</span>, fill <span class="op">=</span> <span class="va">education</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-14-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This plot shows that education levels don’t differ dramatically
between males and females in our sample, with females holding a
university degree more often than males.</p>
</section><section><h2 class="section-heading" id="common-problems">Common Problems<a class="anchor" aria-label="anchor" href="#common-problems"></a>
</h2>
<hr class="half-width">
<p>This section is lifted from <a href="https://r4ds.hadley.nz/data-visualize.html#common-problems" class="external-link">R for
Data Science (2e)</a>.</p>
<p>As you start to run R code, you’re likely to run into problems. Don’t
worry — it happens to everyone. We have all been writing R code for
years, but every day we still write code that doesn’t work on the first
try!</p>
<p>Start by carefully comparing the code that you’re running to the code
in the book. R is extremely picky, and a misplaced character can make
all the difference. Make sure that every <code>(</code> is matched with
a <code>)</code> and every <code>"</code> is paired with another
<code>"</code>. Sometimes you’ll run the code and nothing happens. Check
the left-hand of your console: if it’s a <code>+</code>, it means that R
doesn’t think you’ve typed a complete expression and it’s waiting for
you to finish it. In this case, it’s usually easy to start from scratch
again by pressing ESCAPE to abort processing the current command.</p>
<p>One common problem when creating ggplot2 graphics is to put the + in
the wrong place: it has to come at the end of the line, not the start.
In other words, make sure you haven’t accidentally written code like
this:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">mpg</span><span class="op">)</span> </span>
<span><span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">displ</span>, y <span class="op">=</span> <span class="va">hwy</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>If you’re still stuck, try the help. You can get help about any R
function by running <code>?function_name</code> in the console, or
highlighting the function name and pressing F1 in RStudio. Don’t worry
if the help doesn’t seem that helpful - instead skip down to the
examples and look for code that matches what you’re trying to do.</p>
<p>If that doesn’t help, carefully read the error message. Sometimes the
answer will be buried there! But when you’re new to R, even if the
answer is in the error message, you might not yet know how to understand
it. Another great tool is Google: try googling the error message, as
it’s likely someone else has had the same problem, and has gotten help
online.</p>
</section><section><h2 class="section-heading" id="recap---knowing-your-data">Recap - Knowing your data!<a class="anchor" aria-label="anchor" href="#recap---knowing-your-data"></a>
</h2>
<hr class="half-width">
<p>It’s important to understand your data, its sources and quirks
<em>before</em> you start working with it! This is why the last few
episodes focused so much on descriptive statistics and plots. Get to
know the structure of your data, figure out where it came from and what
type of people constitute the sample. Monitor your key variables for
implausible or impossible values. Statistical outliers we can define
later, but make sure to identify issues with impossible values early
on!</p>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Review what we learned about the DASS data so far. What are the key
demographic indicators? Is there anything else important to note?</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Read the <a href="data/kaggle_dass/codebook.txt">codebook</a>. What
is the difference between <code>Q1A</code>, <code>Q1E</code> and
<code>Q1I</code>?</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Provide descriptive statistics of the time it took participants to
complete the DASS-part of the survey. What variable is this stored in?
What is the average time? Are there any outliers? What is the average
time without outliers?</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>Plot a distribution of the elapsed test time. What might be a
sensible cutoff for outliers?</p>
<p>Plot a distribution of elapsed test time by whether English was the
native language. What do you expect? What can you see? What are your
thoughts on the distribution?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span><span class="op">$</span><span class="va">engnat</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">engnat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">testelapse</span>, fill <span class="op">=</span> <span class="va">engnat</span>, group <span class="op">=</span> <span class="va">engnat</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3000</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribution of test completion times"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"By Mother Tongue"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Test completion time (s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: Removed 399 rows containing non-finite outside the scale range
(`stat_density()`).</code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-16-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="challenge-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>Learn something about the handedness of test-takers. Get the number
of test-takers with each handedness using <code>table</code> and
visualize it using <code>geom_bar()</code>.</p>
<p>Plot the handedness of test-takers by educational status. Do you see
any differences?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dass_data</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">hand</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">education</span>,</span>
<span>    group <span class="op">=</span> <span class="va">education</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_bar</span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Educational attainment by handedness"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Handedness (0 = NA, 1 = Right, 2 = Left, 3 = Both)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Proportion"</span></span>
<span>  <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/data-visualization-02-rendered-unnamed-chunk-17-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Get to know new data by inspecting it and computing key descriptive
statistics</li>
<li>Visualize distributions of key variables in order to learn about
factors that impact them</li>
<li>Visualize distribution of a numeric and a categorical variable using
<code>geom_density()</code>
</li>
<li>Visualize distribution of two categorial variables using
<code>geom_bar()</code>
</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-filtering"><p>Content from <a href="filtering.html">Filtering data</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/filtering.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do you filter invalid data?</li>
<li>How do you chain commands using the pipe <code>%&gt;%</code>?</li>
<li>How can I select only some columns of my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain how to filter rows using <code>filter()</code>
</li>
<li>Demonstrate how to select columns using <code>select()</code>
</li>
<li>Explain how to use the pipe <code>%&gt;%</code> to facilitate clean
code</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="filtering">Filtering<a class="anchor" aria-label="anchor" href="#filtering"></a>
</h2>
<hr class="half-width">
<p>In the earlier episodes, we have already seen some impossible values
in <code>age</code> and <code>testelapse</code>. In our analyses, we
probably want to exclude those values, or at the very least investigate
what is wrong. In order to do that, we need to <em>filter</em> our data
- to make sure it only has those observations that we actually want. The
<code>dplyr</code> package provides a useful function for this:
<code>filter()</code>.</p>
<p>Let’s start by again loading in our data, and also loading the
package <code>dplyr</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/kaggle_dass/data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>The <code>filter</code> function works with two key inputs, the data
and the arguments that you want to filter by. The data is always the
first argument in the filter function. The following arguments are the
filter conditions. For example, in order to only include people that are
20 years old, we can run the following code:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">twenty_year_olds</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">dass_data</span>, <span class="va">age</span> <span class="op">==</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co"># Lets make sure this worked</span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">twenty_year_olds</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span></span>
<span>  <span class="fl">20</span></span>
<span><span class="fl">3789</span> </span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># range(twenty_year_olds$age) # OR THIS</span></span>
<span><span class="co"># unique(twenty_year_olds$age) # OR THIS</span></span>
<span><span class="co"># OR other things that come to mind can check this</span></span></code></pre>
</div>
<p>Now, in order to only include participants aged between 0 and 100,
which seems like a reasonable range, we can condition on
<code>age &gt;= 0 &amp; age &lt;= 100</code>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">dass_data</span>, <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s check if this worked using a histogram.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">valid_age_dass</span><span class="op">$</span><span class="va">age</span>, breaks <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/filtering-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Looks good! Now it is always a good idea to inspect the values you
removed from the data, in order to make sure that you did not remove
something you intended to keep, and to learn something about the data
you removed.</p>
<p>Let’s first check how many rows of data we actually removed:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_rows_original</span> <span class="op">&lt;-</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">dass_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_rows_valid_age</span> <span class="op">&lt;-</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">valid_age_dass</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_rows_removed</span> <span class="op">&lt;-</span> <span class="va">n_rows_original</span> <span class="op">-</span> <span class="va">n_rows_valid_age</span></span>
<span></span>
<span><span class="va">n_rows_removed</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 7</code></pre>
</div>
<p>This seems okay! Only 7 removed cases out of almost 40000 entries is
negligible. Nonentheless, let’s investigate this further.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">impossible_age_data</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">dass_data</span>, <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we have a dataset that contains only the few cases with invalid
ages. We can just look at the ages first:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">impossible_age_data</span><span class="op">$</span><span class="va">age</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1]  223 1996  117 1998  115 1993 1991</code></pre>
</div>
<p>Now, let’s try investigating the a little deeper. Do the people with
invalid entries in age have valid entries in the other columns? Try to
figure this out by visually inspecting the data. Where are they from? Do
the responses to other questions seem odd?</p>
<p>This is possible, but somewhat hard to do for data with 170 columns.
Looking through all of them might make you a bit tired after the third
investigation of invalid data. What we really need is to look at only a
few columns that interest us.</p>
</section><section><h2 class="section-heading" id="selecting-columns">Selecting columns<a class="anchor" aria-label="anchor" href="#selecting-columns"></a>
</h2>
<hr class="half-width">
<p>This is where the function <code>select()</code> comes in. It enables
us to only retain some columns from a dataset for further analysis. You
just give it the data as the first argument and then list all of the
columns you want to keep.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inspection_data_impossible_age</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span></span>
<span>    <span class="va">impossible_age_data</span>,</span>
<span>    <span class="va">age</span>, <span class="va">country</span>, <span class="va">engnat</span>, <span class="va">testelapse</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">inspection_data_impossible_age</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   age country engnat testelapse
1  223      MY      2        456
2 1996      MY      2        259
3  117      US      1        114
4 1998      MY      2        196
5  115      AR      2        238
6 1993      MY      2        232
7 1991      MY      2        240</code></pre>
</div>
<p>Here, we can see that our original data is reduced to the four
columns we specified above
<code>age, country, engnat, testelapse</code>. Do any of them look
strange? What happened in the age column?</p>
<p>To me, none of the other entries seem strange, the time it took them
to complete the survey is plausible, they don’t show a clear trend of
being from the same country. It seems that some people mistook the age
question and entered their year of birth instead. Later on, we can try
to fix this.</p>
<p>But before we do that, there are some more things about
<code>select()</code> that we can learn. It is one of the most useful
functions in my daily life, as it allows me to keep only those columns
that I am actually interested in. And it has many more features than
just listing the columns!</p>
<p>For example, note that the last few columns of the data are all the
demographic information. This is starting with <code>education</code>
and ending with <code>major</code>.</p>
<p>To select everything from <code>education</code> to
<code>major</code>:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># colnames() gives us the names of the columns only</span></span>
<span><span class="fu">colnames</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="va">education</span><span class="op">:</span><span class="va">major</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "education"             "urban"                 "gender"
 [4] "engnat"                "age"                   "screensize"
 [7] "uniquenetworklocation" "hand"                  "religion"
[10] "orientation"           "race"                  "voted"
[13] "married"               "familysize"            "major"                </code></pre>
</div>
<p>We can also select all character columns using
<code>where()</code>:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="fu">where</span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "country" "major"  </code></pre>
</div>
<p>Or we can select all columns that start with the letter “Q”:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  [1] "Q1A"  "Q1I"  "Q1E"  "Q2A"  "Q2I"  "Q2E"  "Q3A"  "Q3I"  "Q3E"  "Q4A"
 [11] "Q4I"  "Q4E"  "Q5A"  "Q5I"  "Q5E"  "Q6A"  "Q6I"  "Q6E"  "Q7A"  "Q7I"
 [21] "Q7E"  "Q8A"  "Q8I"  "Q8E"  "Q9A"  "Q9I"  "Q9E"  "Q10A" "Q10I" "Q10E"
 [31] "Q11A" "Q11I" "Q11E" "Q12A" "Q12I" "Q12E" "Q13A" "Q13I" "Q13E" "Q14A"
 [41] "Q14I" "Q14E" "Q15A" "Q15I" "Q15E" "Q16A" "Q16I" "Q16E" "Q17A" "Q17I"
 [51] "Q17E" "Q18A" "Q18I" "Q18E" "Q19A" "Q19I" "Q19E" "Q20A" "Q20I" "Q20E"
 [61] "Q21A" "Q21I" "Q21E" "Q22A" "Q22I" "Q22E" "Q23A" "Q23I" "Q23E" "Q24A"
 [71] "Q24I" "Q24E" "Q25A" "Q25I" "Q25E" "Q26A" "Q26I" "Q26E" "Q27A" "Q27I"
 [81] "Q27E" "Q28A" "Q28I" "Q28E" "Q29A" "Q29I" "Q29E" "Q30A" "Q30I" "Q30E"
 [91] "Q31A" "Q31I" "Q31E" "Q32A" "Q32I" "Q32E" "Q33A" "Q33I" "Q33E" "Q34A"
[101] "Q34I" "Q34E" "Q35A" "Q35I" "Q35E" "Q36A" "Q36I" "Q36E" "Q37A" "Q37I"
[111] "Q37E" "Q38A" "Q38I" "Q38E" "Q39A" "Q39I" "Q39E" "Q40A" "Q40I" "Q40E"
[121] "Q41A" "Q41I" "Q41E" "Q42A" "Q42I" "Q42E"</code></pre>
</div>
<p>There are a number of helper functions you can use within
<code>select()</code>:</p>
<ul>
<li>
<code>starts_with("abc")</code>: matches names that begin with
“abc”.</li>
<li>
<code>ends_with("xyz")</code>: matches names that end with
“xyz”.</li>
<li>
<code>contains("ijk")</code>: matches names that contain “ijk”.</li>
<li>
<code>num_range("x", 1:3)</code>: matches <code>x1</code>,
<code>x2</code> and <code>x3</code>.</li>
</ul>
<p>You can also remove columns using select by simply negating the
argument using <code>!</code>:</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colnames</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="op">!</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] "country"               "source"                "introelapse"
 [4] "testelapse"            "surveyelapse"          "TIPI1"
 [7] "TIPI2"                 "TIPI3"                 "TIPI4"
[10] "TIPI5"                 "TIPI6"                 "TIPI7"
[13] "TIPI8"                 "TIPI9"                 "TIPI10"
[16] "VCL1"                  "VCL2"                  "VCL3"
[19] "VCL4"                  "VCL5"                  "VCL6"
[22] "VCL7"                  "VCL8"                  "VCL9"
[25] "VCL10"                 "VCL11"                 "VCL12"
[28] "VCL13"                 "VCL14"                 "VCL15"
[31] "VCL16"                 "education"             "urban"
[34] "gender"                "engnat"                "age"
[37] "screensize"            "uniquenetworklocation" "hand"
[40] "religion"              "orientation"           "race"
[43] "voted"                 "married"               "familysize"
[46] "major"                </code></pre>
</div>
<p>Now we will only get those columns that <em>don’t</em> start with
“Q”.</p>
<div id="selecting-a-column-twice" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="selecting-a-column-twice" class="callout-inner">
<h3 class="callout-title">Selecting a column twice</h3>
<div class="callout-content">
<p>You can also use select to reorder the columns in your dataset. For
example, notice that the following two bits of code return differently
order data:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># head() gives us the first 10 values only</span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="va">age</span>, <span class="va">country</span>, <span class="va">testelapse</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   age country testelapse
1   16      IN        167
2   16      US        193
3   17      PL        271
4   13      US        261
5   19      MY        164
6   20      US        349
7   17      MX      45459
8   29      GB        232
9   16      US        195
10  18      DE        120</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="fu">select</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="va">testelapse</span>, <span class="va">age</span>, <span class="va">country</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   testelapse age country
1         167  16      IN
2         193  16      US
3         271  17      PL
4         261  13      US
5         164  19      MY
6         349  20      US
7       45459  17      MX
8         232  29      GB
9         195  16      US
10        120  18      DE</code></pre>
</div>
<p>Using the function <code>everything()</code>, you can select all
columns.</p>
<p>What happens, when you select a column twice? Try running the
following examples, what do you notice about the position of
columns?</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">select</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="va">age</span>, <span class="va">country</span>, <span class="va">age</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">select</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="va">age</span>, <span class="va">country</span>, <span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="using-the-pipe">Using the pipe <code>%&gt;%</code>
<a class="anchor" aria-label="anchor" href="#using-the-pipe"></a>
</h2>
<hr class="half-width">
<p>Let’s retrace some of the steps that we took. We had the original
data <code>dass_data</code> and then filtered out those rows with
invalid entries in age. Then, we tried selecting only a couple of
columns in order to make the data more manageable. In code:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">impossible_age_data</span> <span class="op">&lt;-</span> <span class="fu">filter</span><span class="op">(</span><span class="va">dass_data</span>, <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inspection_data_impossible_age</span> <span class="op">&lt;-</span> <span class="fu">select</span><span class="op">(</span></span>
<span>  <span class="va">impossible_age_data</span>,</span>
<span>  <span class="va">age</span>, <span class="va">country</span>, <span class="va">engnat</span>, <span class="va">testelapse</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>Notice how the first argument for both the <code>filter()</code> and
the <code>select()</code> function is always the data. This is also true
for the <code>ggplot()</code> function. And it’s no coincidence! In R,
there exists a special symbol, called the pipe <code>%&gt;%</code>, that
has the following property: It takes the output of the previous function
and uses it as the first input in the following function.</p>
<p>This can make our example considerably easier to type:</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">age</span> <span class="op">&lt;</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">age</span>, <span class="va">country</span>, <span class="va">engnat</span>, <span class="va">testelapse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   age country engnat testelapse
1  223      MY      2        456
2 1996      MY      2        259
3  117      US      1        114
4 1998      MY      2        196
5  115      AR      2        238
6 1993      MY      2        232
7 1991      MY      2        240</code></pre>
</div>
<p>Notice how the pipe is always written at the end of a line. This
makes it easier to understand and to read. As we go to the next line,
whatever is outputted is used as input in the following line. So the
original data <code>dass_data</code> is used as the first input in the
filter function, and the filtered data is used as the first input in the
<code>select</code> function.</p>
<p>To use the pipe, you can either type it out yourself or use the
Keyboard-Shortcut <code>Ctrl + Shift + M</code>.</p>
</section><section><h2 class="section-heading" id="plotting-using-the-pipe">Plotting using the pipe<a class="anchor" aria-label="anchor" href="#plotting-using-the-pipe"></a>
</h2>
<hr class="half-width">
<p>We have seen that the pipe <code>%&gt;%</code> allows us to chain
multiple functions together, making our code cleaner and easier to read.
This can be particularly useful when working with <code>ggplot2</code>,
where we often build plots step by step. Since <code>ggplot()</code>
takes the data as its first argument, we can use the pipe to make our
code more readable.</p>
<p>For example, let’s say we want to create a histogram of valid ages in
our dataset. Instead of writing:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">valid_age_dass</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/filtering-rendered-unnamed-chunk-18-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We can write:</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/filtering-rendered-unnamed-chunk-19-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This makes it clear that <code>valid_age_dass</code> is the dataset
being used, and it improves readability.</p>
<div id="using-the-pipe-for-the-second-argument" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="using-the-pipe-for-the-second-argument" class="callout-inner">
<h3 class="callout-title">Using the pipe for the second argument</h3>
<div class="callout-content">
<p>By default, the pipe places the output of the previous code as the
first argument in the following function. In most cases, this is exactly
what we want to have. If you want to be more explicit about where the
pipe should place the output, you can do this by placing a
<code>.</code> as the placeholder for piped-data.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_bins</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span></span>
<span><span class="va">n_bins</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">hist</span><span class="op">(</span><span class="va">valid_age_dass</span><span class="op">$</span><span class="va">age</span>, <span class="va">.</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/filtering-rendered-unnamed-chunk-20-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="numbered-vs--named-arguments">Numbered vs. Named Arguments<a class="anchor" aria-label="anchor" href="#numbered-vs--named-arguments"></a>
</h2>
<hr class="half-width">
<p>The pipe is made possible because most functions in the packages
included in <code>tidyverse</code>, like <code>dplyr</code> and
<code>ggplot</code> have the data as their first argument. This makes it
simple to pipe-through results from one function to the next, without
having to explicitly type <code>function(data = something)</code> every
time. In principle, almost all functions have a natural order in which
they expect arguments to occur. For example: <code>ggplot()</code>
expects data as the first argument and information about the mapping as
the second argument. This is why we always typed:</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">valid_age_dass</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/filtering-rendered-unnamed-chunk-21-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Notice that if we don’t specify the argument names, we still receive
the same results. The function just uses the inputs you give it to match
the arguments in the order in which they occur.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span></span>
<span>  <span class="va">valid_age_dass</span>, <span class="co"># Now it just automatically thinks this is data = </span></span>
<span>  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="co"># and this is mapping = </span></span>
<span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/filtering-rendered-unnamed-chunk-22-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This is what makes this possible:</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/filtering-rendered-unnamed-chunk-23-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>However, if we try to supply an argument in a place where it doesn’t
belong, we get an error:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_bins</span> <span class="op">=</span> <span class="fl">50</span> </span>
<span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="va">n_bins</span><span class="op">)</span>  <span class="co"># This will cause an error!</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `geom_histogram()`:
! `mapping` must be created by `aes()`.</code></pre>
</div>
<p><code>geom_histogram</code> does not expect the number of bins to be
the first argument, but rather the mapping! Therefore, we need to
declare this properly:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="va">n_bins</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/filtering-rendered-unnamed-chunk-25-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>To learn about the order of arguments of a function, use
<code>?function</code> and inspect the help file.</p>
</section><section><h2 class="section-heading" id="common-problems">Common Problems<a class="anchor" aria-label="anchor" href="#common-problems"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="using-one-pipe-too-little">Using one pipe too little<a class="anchor" aria-label="anchor" href="#using-one-pipe-too-little"></a>
</h3>
<p>A common mistake is forgetting to use a pipe between arguments of a
chain. For example:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">18</span><span class="op">)</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">age</span>, <span class="va">country</span><span class="op">)</span></span></code></pre>
</div>
<p>Here, <code>select()</code> is not part of the pipeline because the
pipe is missing after <code>filter(age &gt; 18)</code>. This can lead to
unexpected errors or incorrect results. The correct way to write this
is:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">18</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">age</span>, <span class="va">country</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="using-one-pipe-too-much">Using one pipe too much<a class="anchor" aria-label="anchor" href="#using-one-pipe-too-much"></a>
</h3>
<p>Another common problem is using one pipe too many without having a
function following it.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>valid_age_dass <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">&gt;</span> <span class="dv">18</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>  <span class="fu">select</span>(age, country) <span class="sc">%&gt;%</span> </span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in parse(text = input): &lt;text&gt;:4:0: unexpected end of input
2:   filter(age &gt; 18) %&gt;%
3:   select(age, country) %&gt;%
  ^</code></pre>
</div>
<p>This can cause some really strange errors that never say anything
about the pipe being superfluous. Make sure that all your pipe “lead
somewhere”.</p>
</div>
<div class="section level3">
<h3 id="using-a-pipe-instead-of-for-ggplot">Using a pipe instead of <code>+</code> for
<code>ggplot()</code>
<a class="anchor" aria-label="anchor" href="#using-a-pipe-instead-of-for-ggplot"></a>
</h3>
<p>A source of confusion stems from the difference between the pipe
<code>%&gt;%</code> and <code>ggplot2</code>’s <code>+</code>. They both
serve very similar purposes, namely adding together a chain of
functions. However, make sure you use <code>%&gt;%</code> for everything
<em>except</em> ggplot-functions. Here, you will also receive an error
that is a little more informative:</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">geom_density</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `geom_density()` at magrittr/R/pipe.R:136:3:
! `mapping` must be created by `aes()`.
ℹ Did you use `%&gt;%` or `|&gt;` instead of `+`?</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="using-instead-of-in-filter">Using <code>=</code> Instead of <code>==</code> in
<code>filter()</code>
<a class="anchor" aria-label="anchor" href="#using-instead-of-in-filter"></a>
</h3>
<p>Another common error is using <code>=</code> instead of
<code>==</code> when filtering data. For example:</p>
<div class="codewrapper sourceCode" id="cb49">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span>country <span class="op">=</span> <span class="st">"US"</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="co"># Incorrect!</span></span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in `filter()`:
! We detected a named input.
ℹ This usually means that you've used `=` instead of `==`.
ℹ Did you mean `country == "US"`?</code></pre>
</div>
<p>This will result in an error because <code>=</code> is used for
assigning values, while <code>==</code> is used for comparisons. The
correct syntax is:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valid_age_dass</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"US"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">country</span>, <span class="va">engnat</span>, <span class="va">education</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  country engnat education
1      US      1         2
2      US      1         1
3      US      2         2
4      US      2         2
5      US      1         1
6      US      1         2</code></pre>
</div>
</div>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Filter the complete <code>dass_data</code>. Create one dataset
containing only entries with people from the United States and one
dataset containing only entries from Great Britain. Compare the number
of entries in each dataset. What percentage of the total submissions
came from these two countries?</p>
<p>What is the average age of participants from the two countries?</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Create a filtered dataset based on the following conditions:</p>
<ul>
<li>The participant took less than 30 minutes to complete the DASS-part
of the survey</li>
<li>English is the native language of the participant</li>
<li>There is an entry in the field <code>major</code>
</li>
</ul>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>What arguments does the <code>cut()</code> function take? Make a list
of the arguments and the order in which they have to be provided to the
function.</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>In a single chain of functions, create a dataset is filtered with the
same conditions as above and contains only the following variables:</p>
<ul>
<li>all demographic information, country information and the duration of
the tests</li>
<li>all the answers to the DASS (and only the answers, not the position
or timing)</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">english_unversity_dass</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">testelapse</span> <span class="op">&lt;</span> <span class="fl">1800</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">engnat</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">major</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu">ends_with</span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>, <span class="fu">contains</span><span class="op">(</span><span class="st">"elapse"</span><span class="op">)</span>, <span class="va">country</span>, <span class="va">education</span><span class="op">:</span><span class="va">major</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">write.csv</span><span class="op">(</span><span class="va">english_unversity_dass</span>, <span class="st">"data/english_university_dass_data.csv"</span><span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>Save that dataset to a file
<code>english_university_dass_data.csv</code> in your
<code>processed_data</code> folder. You may need to use Google to find a
function that you can use to save data.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use the pipe operator <code>%&gt;%</code> to link multiple functions
together</li>
<li>Use <code>filter()</code> to filter rows based on certain
conditions</li>
<li>Use <code>select()</code> to keep only those rows that interest
you</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-mutating"><p>Content from <a href="mutating.html">Creating new columns</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/mutating.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What function is used to create new columns in a dataset?</li>
<li>How can you generate a unique ID column for each row?</li>
<li>How can you modify an existing column?</li>
<li>How can you compute an average value over many columns in your
data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to use <code>mutate()</code> to create new
columns.</li>
<li>Learn how to add constant values, computed values, and conditionally
assigned values to new columns.</li>
<li>Use <code>ifelse()</code> to create categorical columns based on
conditions.</li>
<li>Learn efficient methods for computing row-wise sums and averages
using <code>rowSums()</code> and <code>rowMeans()</code>.</li>
<li>Understand the difference between <code>sum()</code> and
<code>rowSums()</code> for column-wise and row-wise operations.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="making-new-columns">Making new columns<a class="anchor" aria-label="anchor" href="#making-new-columns"></a>
</h2>
<hr class="half-width">
<p>So far we have dealt with existing columns and worked on them. We
have computed descriptive statistics, plotted basic overviews of data
and cut the data just the way we like it using <code>filter()</code> and
<code>select()</code>. Now, we will unlock a new power… the power of
creation! Muhahahahaha.</p>
<p>Well, actually it’s just adding new columns to the dataset, but
that’s still cool! Let’s start by reading in our DASS data again and
loading the package <code>dplyr</code>.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/kaggle_dass/data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>To add a new column, we need the <code>dplyr</code> function
<code>mutate()</code>. It changes - or <em>mutates</em> - columns in the
dataset, like adding entirely new ones. The syntax is quite simple. The
first argument is the data, allowing easy use of pipes, and the second
argument is the code for the new column you want to have.</p>
<p>For example, if we want to create a new column that carries just a
single value, we type the following:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>single_value_column <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span></code></pre>
</div>
<p>To check if this worked:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">unique</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">single_value_column</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 42</code></pre>
</div>
<div id="saving-progress" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="saving-progress" class="callout-inner">
<h3 class="callout-title">Saving progress</h3>
<div class="callout-content">
<p>Notice how we had to assign the dataset to itself in order to save
the progress we have made. If you do not do this, and just write down
the pipeline, the end result will be outputted to the console, not
stored in an object that we can use later.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>some_column <span class="op">=</span> <span class="st">"I have a value!"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">country</span>, <span class="va">some_column</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  country     some_column
1      IN I have a value!
2      US I have a value!
3      PL I have a value!
4      US I have a value!
5      MY I have a value!
6      US I have a value!</code></pre>
</div>
<p>You can easily assign the new data to something with the same name,
overriding the previous status. But be careful with this, I recommend
you use new names for the data after filtering, selecting, and mutating
existing columns. These operations change the original data (they remove
some information) and should thus be stored in a new object, like
<code>filtered_dass_data</code>.</p>
</div>
</div>
</div>
<p>We can do much more interesting things than just placing a constant
in the new column. For example, we can use <code>row_number()</code> to
create a running number of entries in our data - an id of sort.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>entry_id <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">country</span>, <span class="va">testelapse</span>, <span class="va">entry_id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  country testelapse entry_id
1      IN        167        1
2      US        193        2
3      PL        271        3
4      US        261        4
5      MY        164        5
6      US        349        6</code></pre>
</div>
</section><section><h2 class="section-heading" id="mutating-existing-columns">Mutating existing columns<a class="anchor" aria-label="anchor" href="#mutating-existing-columns"></a>
</h2>
<hr class="half-width">
<p>We can also base our mutation on existing columns.
<code>testelapse</code> is in seconds right now, let’s add a new column
that is the elapsed test time in minutes.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    testelapse_min <span class="op">=</span> <span class="va">testelapse</span> <span class="op">/</span> <span class="fl">60</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">mean</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">testelapse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 2684.843</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mean</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">testelapse_min</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 44.74738</code></pre>
</div>
<p>Another function I often use when creating new columns is
<code>ifelse()</code>. It works using three arguments.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fl">3</span></span>
<span></span>
<span><span class="fu">ifelse</span><span class="op">(</span></span>
<span>  <span class="va">a</span> <span class="op">&gt;</span> <span class="va">b</span>, <span class="co"># The condition</span></span>
<span>  <span class="st">"a is greater"</span>, <span class="co"># IF yes</span></span>
<span>  <span class="st">"a is smaller"</span> <span class="co"># IF no</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "a is greater"</code></pre>
</div>
<p>We can use this to make a new column that tells us whether an entry
came from the United States.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>is_from_us <span class="op">=</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"US"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">table</span><span class="op">(</span><span class="va">dass_data</span><span class="op">$</span><span class="va">is_from_us</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
   no   yes
31566  8207 </code></pre>
</div>
</section><section><h2 class="section-heading" id="adding-existing-columns">Adding existing columns<a class="anchor" aria-label="anchor" href="#adding-existing-columns"></a>
</h2>
<hr class="half-width">
<p>One of the most important uses of <code>mutate()</code> is adding
together multiple columns. In our data, we have three columns indicating
the length of elapsed time during survey completion,
<code>introelapse</code>, <code>testelapse</code> and
<code>surveyelapse</code>.</p>
<p>We can compute the sum of these three columns to get the total amount
of elapsed time.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    total_elapse_seconds <span class="op">=</span> <span class="va">introelapse</span> <span class="op">+</span> <span class="va">testelapse</span> <span class="op">+</span> <span class="va">surveyelapse</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div id="hint-conduct-sanity-checks" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="hint-conduct-sanity-checks" class="callout-inner">
<h3 class="callout-title">Hint: Conduct Sanity Checks</h3>
<div class="callout-content">
<p>When programming, you will make mistakes. There just is not a way
around it. The only way to deal with it is trying to catch your mistakes
as early as possible. Sometimes the computer will help you out by
issuing an error or a warning. Sometimes it does not, because the code
you wrote is technically valid but still does not exactly do what you
want it to.</p>
<p>Therefore, it is important to conduct sanity checks! Try looking at
the data and figure out if what you just did makes sense. In our case,
let’s inspect the new column:</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">introelapse</span>, <span class="va">testelapse</span>, <span class="va">surveyelapse</span>, <span class="va">total_elapse_seconds</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  introelapse testelapse surveyelapse total_elapse_seconds
1          19        167          166                  352
2           1        193          186                  380
3           5        271          122                  398
4           3        261          336                  600
5        1766        164          157                 2087
6           4        349          213                  566</code></pre>
</div>
<p>This looks good so far!</p>
</div>
</div>
</div>
<p>Now, this approach works well for a few columns, but gets tedious
quickly when attempting to compute the sum or average over multiple
columns. For this there exists a special fuction called
<code>rowSums()</code>. This function takes a dataset, and computes the
sums across all columns.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>  y <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">5</span>,</span>
<span>  z <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">6</span></span>
<span><span class="op">)</span></span>
<span><span class="va">example_data</span><span class="op">$</span><span class="va">sum</span> <span class="op">&lt;-</span> <span class="fu">rowSums</span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  x y z sum
1 1 2 3   6
2 2 3 4   9
3 3 4 5  12
4 4 5 6  15</code></pre>
</div>
<p>However, in our case we do not want a sum across <em>all</em> columns
of our data, but just some of the columns! To do this, we need to use
<code>across()</code> inside the <code>rowSums</code> function to select
specific columns.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>elapse_sum <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"introelapse"</span>, <span class="st">"testelapse"</span>, <span class="st">"surveyelapse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">introelapse</span>, <span class="va">testelapse</span>, <span class="va">surveyelapse</span>, <span class="va">elapse_sum</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  introelapse testelapse surveyelapse elapse_sum
1          19        167          166        352
2           1        193          186        380
3           5        271          122        398
4           3        261          336        600
5        1766        164          157       2087
6           4        349          213        566</code></pre>
</div>
<p>Because <code>across()</code> also accepts the same input as
<code>select()</code> we can use the special functions like
<code>starts_with()</code>, <code>ends_with()</code> or
<code>contains()</code>.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>elapse_sum <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">ends_with</span><span class="op">(</span><span class="st">"elapse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu">ends_with</span><span class="op">(</span><span class="st">"elapse"</span><span class="op">)</span>, <span class="va">elapse_sum</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  introelapse testelapse surveyelapse elapse_sum
1          19        167          166        352
2           1        193          186        380
3           5        271          122        398
4           3        261          336        600
5        1766        164          157       2087
6           4        349          213        566</code></pre>
</div>
<p>Similarly, we can use <code>rowMeans()</code> to compute the average
test duration. The beautiful thing about <code>mutate()</code> is, that
we can create multiple columns in one function call!</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    constant_value <span class="op">=</span> <span class="st">"I am a value!"</span>,</span>
<span>    id <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    elapse_sum <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">ends_with</span><span class="op">(</span><span class="st">"elapse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    elapse_mean <span class="op">=</span> <span class="fu">rowMeans</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">ends_with</span><span class="op">(</span><span class="st">"elapse"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">id</span>, <span class="va">constant_value</span>, <span class="fu">ends_with</span><span class="op">(</span><span class="st">"elapse"</span><span class="op">)</span>, <span class="va">elapse_sum</span>, <span class="va">elapse_mean</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  id constant_value introelapse testelapse surveyelapse elapse_sum elapse_mean
1  1  I am a value!          19        167          166        352    117.3333
2  2  I am a value!           1        193          186        380    126.6667
3  3  I am a value!           5        271          122        398    132.6667
4  4  I am a value!           3        261          336        600    200.0000
5  5  I am a value!        1766        164          157       2087    695.6667
6  6  I am a value!           4        349          213        566    188.6667</code></pre>
</div>
<div id="pro-tip-mutate-across" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="pro-tip-mutate-across" class="callout-inner">
<h3 class="callout-title">Pro Tip: mutate() + across()</h3>
<div class="callout-content">
<p>Sometimes, you want to mutate multiple columns at once, applying the
same function to all of them. For example, when you want to recode some
values across all columns that share the incorrect format. Here, you can
use <code>mutate()</code> in combination with <code>across()</code> to
apply a function to all of them. In our case, lets compute the elapse
time in minutes for all elapse columns.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span></span>
<span>      <span class="fu">ends_with</span><span class="op">(</span><span class="st">"elapse"</span><span class="op">)</span>, <span class="co"># Select the columns you want</span></span>
<span>      <span class="op">~</span> <span class="va">.x</span> <span class="op">/</span> <span class="fl">60</span>, <span class="co"># Write the function to apply to all of them</span></span>
<span>      <span class="co"># Use this special function syntax ~ and a .x as the argument to be filled</span></span>
<span>      .names <span class="op">=</span> <span class="st">"{.col}_minutes"</span> <span class="co"># Give out new names by using the old name</span></span>
<span>      <span class="co"># which will take the place of {.col} and some new value.</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu">contains</span><span class="op">(</span><span class="st">"elapse"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  introelapse testelapse surveyelapse testelapse_min total_elapse_seconds
1          19        167          166       2.783333                  352
2           1        193          186       3.216667                  380
3           5        271          122       4.516667                  398
4           3        261          336       4.350000                  600
5        1766        164          157       2.733333                 2087
6           4        349          213       5.816667                  566
  introelapse_minutes testelapse_minutes surveyelapse_minutes
1          0.31666667           2.783333             2.766667
2          0.01666667           3.216667             3.100000
3          0.08333333           4.516667             2.033333
4          0.05000000           4.350000             5.600000
5         29.43333333           2.733333             2.616667
6          0.06666667           5.816667             3.550000</code></pre>
</div>
<p>You don’t have to apply this straight away, and using this correctly
takes quite a bit of practice. But I wanted you to know that this
exists, so you might remember it when you need it.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<p>As you complete the challenges, make use of <code>select()</code> to
conduct sanity checks on the newly created columns!</p>
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Create and save a new column called <em>participant_id</em> that
includes a unique number per entry in the data.</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Create a new column that includes the total time the participant took
to complete <em>all</em> surveys in minutes! Afterwards, filter this
data to exclude all participants who took more than 1 hour. Work with
this dataset for all following challenges.</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Create a column that indicates whether participants completed a
university degree or not.</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>Use a new function called <code>case_when()</code> to create a column
that has a translation from the numbers in the <code>education</code>
column to the verbal represenation. Use <code>?case_when()</code> to
learn about this function. If that is not enough, try Google / ChatGPT.
Write a short description of what it does (1-2 sentences in comments of
script).</p>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>The following code shows a common error when computing sums across
columns.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># DO NOT USE THIS!</span></span>
<span><span class="va">wrong_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>wrong_elapse <span class="op">=</span> <span class="fu">sum</span><span class="op">(</span><span class="va">introelapse</span>, <span class="va">testelapse</span>, <span class="va">surveyelapse</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>This code will execute without any errors and it looks correct. Can
you figure out what went wrong here?</p>
</div>
</div>
</div>
<div id="challenge-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6</h3>
<div class="callout-content">
<p>Compute a column that contains the sum of all answers to the
DASS-questionnaire. Use <code>rowSums()</code> and
<code>across()</code>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    dass_score <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu">ends_with</span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-7" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-7" class="callout-inner">
<h3 class="callout-title">Challenge 7</h3>
<div class="callout-content">
<p>Compute a column that shows the <em>mean</em> response to the
DASS-questionnaire. Visualize the distribution across the dataset.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>mutate()</code> to create and modify columns in a
dataset.</li>
<li>Assign constant values, compute values from other columns, or use
conditions to define new columns.</li>
<li>Use <code>ifelse()</code> for conditional column creation.</li>
<li>Compute row-wise sums and means efficiently using
<code>rowSums()</code> and <code>rowMeans()</code>.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-count-and-summarize"><p>Content from <a href="count-and-summarize.html">Count and Summarize</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/count-and-summarize.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How does <code>count()</code> help in counting categorical
data?<br>
</li>
<li>How do you compute summary statistics?</li>
<li>How can you use <code>group_by()</code> to compute summary
statistics for specific subgroups?<br>
</li>
<li>Why is it useful to combine <code>count()</code> with
<code>filter()</code>?<br>
</li>
<li>How can you compute relative frequencies using
<code>group_by()</code> and <code>mutate()</code>?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand how to use <code>count()</code> to summarize categorical
variables.<br>
</li>
<li>Learn to compute summary statistics using
<code>summarize()</code>.<br>
</li>
<li>Explore how <code>group_by()</code> allows for subgroup
analyses.<br>
</li>
<li>Use <code>filter()</code> to refine data before counting or
summarizing.<br>
</li>
<li>Compute and interpret relative frequencies using
<code>mutate()</code>.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="computing-summaries">Computing Summaries<a class="anchor" aria-label="anchor" href="#computing-summaries"></a>
</h2>
<hr class="half-width">
<p>This lesson will teach you some of the last (and most important)
functions used in the process of data exploration and data analysis.
Today we will learn how to quickly count the number of appearances for a
given value using <code>count()</code> and how to compute custom summary
statistics using <code>summarize()</code>.</p>
<p>Taken together, these functions will let you quickly compute
frequencies and average values in your data, the last step in
descriptive analysis and sometimes a necessary prerequisite for
inference methods. The ANOVA, for example, most often requires one value
per participant per condition, often requiring you to average over
multiple trials.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/kaggle_dass/data.csv"</span><span class="op">)</span></span></code></pre>
</div>
</section><section><h2 class="section-heading" id="counting-data">Counting data<a class="anchor" aria-label="anchor" href="#counting-data"></a>
</h2>
<hr class="half-width">
<p>Let’s start with the more simple function of the two,
<code>count()</code>. This function works with the
<code>tidyverse</code> framework and can thus easily be used with pipes.
Simply pipe in your dataset and give the name of the column you want to
receive a count for:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">education</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  education     n
1         0   515
2         1  4066
3         2 15066
4         3 15120
5         4  5008</code></pre>
</div>
<p>The count will always be in a column called <code>n</code>, including
the number of occurrences for any given value (or combination of values)
to the left of it.</p>
<p>Notably, you can also include multiple columns to get a count for
each combination of values.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">hand</span>, <span class="va">voted</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   hand voted     n
1     0     0     4
2     0     1    51
3     0     2   118
4     1     0   284
5     1     1  9693
6     1     2 24765
7     2     0    36
8     2     1  1121
9     2     2  3014
10    3     0     3
11    3     1   183
12    3     2   503</code></pre>
</div>
<div id="tip-using-comparisons-in-count" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-using-comparisons-in-count" class="callout-inner">
<h3 class="callout-title">Tip: Using comparisons in
<code>count()</code>
</h3>
<div class="callout-content">
<p>You are not limited to comparing columns. You can also directly
include comparisons in the <code>count()</code> function. For example,
we can count the education status and number of people who concluded the
DASS-questionnaire in under 10 minutes.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">testelapse</span> <span class="op">&lt;</span> <span class="fl">600</span>, <span class="va">education</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   testelapse &lt; 600 education     n
1             FALSE         0    33
2             FALSE         1   220
3             FALSE         2  1025
4             FALSE         3   922
5             FALSE         4   333
6              TRUE         0   482
7              TRUE         1  3846
8              TRUE         2 14041
9              TRUE         3 14198
10             TRUE         4  4675</code></pre>
</div>
<p>If you want to receive counts only for a specific part of the data,
like in our case people faster than 10 minutes, it may be more clear to
<code>filter()</code> first.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">testelapse</span> <span class="op">&lt;</span> <span class="fl">600</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">education</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  education     n
1         0   482
2         1  3846
3         2 14041
4         3 14198
5         4  4675</code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="summarize">Summarize<a class="anchor" aria-label="anchor" href="#summarize"></a>
</h2>
<hr class="half-width">
<p><code>summarize()</code> is one of the most powerful functions in
<code>dplyr</code>. Let’s use it to compute average scores for the
DASS-questionnaire.</p>
<p>First, compute columns with the sum DASS score and mean DASS score
for each participant again. You should have code for this in the script
from last episode. Go have a look and copy the correct code here.
Copying from yourself is highly encouraged in coding! It’s very likely
that you have spent some time solving a problem already, why not make
use of that work.</p>
<div id="hint-copy-your-own-code" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="hint-copy-your-own-code" class="callout-inner">
<h3 class="callout-title">Hint: Copy your own code</h3>
<div class="callout-content">
<p>If you can’t find it or want to use the exact same specification as
me, here is a solution.</p>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    sum_dass_score <span class="op">=</span> <span class="fu">rowSums</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu">ends_with</span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    mean_dass_score <span class="op">=</span> <span class="fu">rowMeans</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu">ends_with</span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p><code>summarize()</code> works similar to <code>mutate()</code> in
that you have to specify a new name and a formula to receive your
result. To get the average score of the DASS over all participants, we
use the <code>mean()</code> function.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean_sum_dass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">sum_dass_score</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_sum_dass
1      100.2687</code></pre>
</div>
<p>We can also compute multiple means over both the column containing
the sum of DASS scores and the mean DASS score.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean_sum_dass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">sum_dass_score</span><span class="op">)</span>,</span>
<span>    mean_mean_dass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">mean_dass_score</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_sum_dass mean_mean_dass
1      100.2687       2.387351</code></pre>
</div>
<p>In addition, we can compute other values using any functions we feel
are useful. For example, <code>n()</code> gives us the number of values,
which can be useful when comparing averages for multiple groups.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean_sum_dass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">sum_dass_score</span><span class="op">)</span>,</span>
<span>    mean_mean_dass <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">mean_dass_score</span><span class="op">)</span>,</span>
<span>    n_subjecs <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    max_total_dass_score <span class="op">=</span> <span class="fu">max</span><span class="op">(</span><span class="va">sum_dass_score</span><span class="op">)</span>,</span>
<span>    quantile_5_mean_dass <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean_dass_score</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>    quantile_95_mean_dass <span class="op">=</span> <span class="fu">quantile</span><span class="op">(</span><span class="va">mean_dass_score</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  mean_sum_dass mean_mean_dass n_subjecs max_total_dass_score
1      100.2687       2.387351     39775                  168
  quantile_5_mean_dass quantile_95_mean_dass
1             1.261905              3.595238</code></pre>
</div>
</section><section><h2 class="section-heading" id="groups">Groups<a class="anchor" aria-label="anchor" href="#groups"></a>
</h2>
<hr class="half-width">
<p>So far, we could have done all of the above using basic R functions
like <code>mean()</code> or <code>nrow()</code>. One of the benefits of
<code>summarize()</code> is that it can be used in pipelines, so you
could have easily applied filters before summarizing. However, the most
important benefit is the ability to group the summary by other columns
in the data. In order to do this, you need to call
<code>group_by()</code>.</p>
<p>This creates a special type of data format, called a <em>grouped data
frame</em>. R remembers assigns each row of the data a group based on
the values provided in the <code>group_by()</code> function. If you then
use <code>summarize()</code>, R will compute the summary functions for
each group separately.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">education</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean_mean_dass_score <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">mean_dass_score</span><span class="op">)</span>,</span>
<span>    n_subjects <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 5 × 3
  education mean_mean_dass_score n_subjects
      &lt;int&gt;                &lt;dbl&gt;      &lt;int&gt;
1         0                 2.38        515
2         1                 2.64       4066
3         2                 2.47      15066
4         3                 2.31      15120
5         4                 2.18       5008</code></pre>
</div>
<p>Now we are able to start learning interesting things about our data.
For example, it seems like the average DASS score declines with higher
levels of education (excluding the “missing” education = 0).</p>
<p>You can group by as many columns as you like. Summary statistics will
then be computed for each combination of the columns:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">education</span>, <span class="va">urban</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean_mean_dass_score <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">mean_dass_score</span><span class="op">)</span>,</span>
<span>    n_subjects <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>`summarise()` has grouped output by 'education'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 20 × 4
# Groups:   education [5]
   education urban mean_mean_dass_score n_subjects
       &lt;int&gt; &lt;int&gt;                &lt;dbl&gt;      &lt;int&gt;
 1         0     0                 2.31         19
 2         0     1                 2.48        126
 3         0     2                 2.35        141
 4         0     3                 2.35        229
 5         1     0                 2.66         49
 6         1     1                 2.69        626
 7         1     2                 2.59       1578
 8         1     3                 2.66       1813
 9         2     0                 2.62        156
10         2     1                 2.46       3110
11         2     2                 2.43       4720
12         2     3                 2.50       7080
13         3     0                 2.29        118
14         3     1                 2.31       3351
15         3     2                 2.28       5162
16         3     3                 2.33       6489
17         4     0                 2.18         40
18         4     1                 2.19       1105
19         4     2                 2.14       1631
20         4     3                 2.20       2232</code></pre>
</div>
<p>Similar to <code>count()</code> you can also include comparisons in
<code>group_by()</code></p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">testelapse</span> <span class="op">&lt;</span> <span class="fl">600</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean_mean_dass_score <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">mean_dass_score</span><span class="op">)</span>,</span>
<span>    n_subjects <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 2 × 3
  `testelapse &lt; 600` mean_mean_dass_score n_subjects
  &lt;lgl&gt;                             &lt;dbl&gt;      &lt;int&gt;
1 FALSE                              2.33       2533
2 TRUE                               2.39      37242</code></pre>
</div>
<div id="warning-remember-to-ungroup" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="warning-remember-to-ungroup" class="callout-inner">
<h3 class="callout-title">Warning: Remember to
<code>ungroup()</code>
</h3>
<div class="callout-content">
<p>R remembers the <code>group_by()</code> function as long as you don’t
use <code>ungroup()</code> or <code>summarize()</code>. This may have
unwanted side-effects. Make sure that each <code>group_by()</code> is
followed by an <code>ungroup()</code>.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">education</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    within_education_id <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 39,775 × 175
     Q1A   Q1I   Q1E   Q2A   Q2I   Q2E   Q3A   Q3I   Q3E   Q4A   Q4I   Q4E   Q5A
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1     4    28  3890     4    25  2122     2    16  1944     4     8  2044     4
 2     4     2  8118     1    36  2890     2    35  4777     3    28  3090     4
 3     3     7  5784     1    33  4373     4    41  3242     1    13  6470     4
 4     2    23  5081     3    11  6837     2    37  5521     1    27  4556     3
 5     2    36  3215     2    13  7731     3     5  4156     4    10  2802     4
 6     1    18  6116     1    28  3193     2     2 12542     1     8  6150     3
 7     1    20  4325     1    34  4009     2    38  3604     3    40  4826     4
 8     1    34  4796     1     9  2618     1    39  5823     1    12  6596     3
 9     4     4  3470     4    14  2139     3     1 11043     4    20  1829     3
10     3    38  5187     2    28  2600     4     9  2015     1     7  3111     4
# ℹ 39,765 more rows
# ℹ 162 more variables: Q5I &lt;int&gt;, Q5E &lt;int&gt;, Q6A &lt;int&gt;, Q6I &lt;int&gt;, Q6E &lt;int&gt;,
#   Q7A &lt;int&gt;, Q7I &lt;int&gt;, Q7E &lt;int&gt;, Q8A &lt;int&gt;, Q8I &lt;int&gt;, Q8E &lt;int&gt;,
#   Q9A &lt;int&gt;, Q9I &lt;int&gt;, Q9E &lt;int&gt;, Q10A &lt;int&gt;, Q10I &lt;int&gt;, Q10E &lt;int&gt;,
#   Q11A &lt;int&gt;, Q11I &lt;int&gt;, Q11E &lt;int&gt;, Q12A &lt;int&gt;, Q12I &lt;int&gt;, Q12E &lt;int&gt;,
#   Q13A &lt;int&gt;, Q13I &lt;int&gt;, Q13E &lt;int&gt;, Q14A &lt;int&gt;, Q14I &lt;int&gt;, Q14E &lt;int&gt;,
#   Q15A &lt;int&gt;, Q15I &lt;int&gt;, Q15E &lt;int&gt;, Q16A &lt;int&gt;, Q16I &lt;int&gt;, Q16E &lt;int&gt;, …</code></pre>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="count-group_by">
<code>count()</code> + <code>group_by()</code>
<a class="anchor" aria-label="anchor" href="#count-group_by"></a>
</h2>
<hr class="half-width">
<p>You can also make use of <code>group_by()</code> to compute relative
frequencies in count-tables easily. For example, counting the education
status by handedness is not informative.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">hand</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Focus on right vs. left</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">hand</span>, <span class="va">education</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   hand education     n
1     1         0   434
2     1         1  3481
3     1         2 13102
4     1         3 13326
5     1         4  4399
6     2         0    57
7     2         1   412
8     2         2  1623
9     2         3  1561
10    2         4   518</code></pre>
</div>
<p>This just tells us that there are more right-handed people. However,
the percentage of education by handedness would be much more
interesting. To that end, we can group by handedness and compute the
percentage easily.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">hand</span> <span class="op">%in%</span> <span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Focus on right vs. left</span></span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">hand</span>, <span class="va">education</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">hand</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>percentage <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="va">percentage</span><span class="op">*</span><span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 4
    hand education     n percentage
   &lt;int&gt;     &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
 1     1         0   434       1.25
 2     1         1  3481      10.0
 3     1         2 13102      37.7
 4     1         3 13326      38.4
 5     1         4  4399      12.7
 6     2         0    57       1.37
 7     2         1   412       9.88
 8     2         2  1623      38.9
 9     2         3  1561      37.4
10     2         4   518      12.4 </code></pre>
</div>
<p>As you can see, <code>group_by()</code> also works in combination
with <code>mutate()</code>. This means that calling <code>sum(n)</code>
computes the total of <code>n</code> for the given group. Which is why
<code>n / sum(n)</code> yields the relative frequency.</p>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>How many of the subjects voted in a national election last year? Use
<code>count()</code> to receive an overview.</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Get an overview of the number of people that voted based on whether
their age is greater than 30. Make sure you only include subjects that
are older than 18 in this count.</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Get a summary of the mean score on the DASS by whether somebody voted
in a national election in past year. What do you notice? Why might this
be the case? There are no right or wrong answers here, just think of
some reasons.</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>Get a summary of the mean DASS score based on age groups. Use
<code>mutate()</code> and <code>case_when()</code> to define a new
<code>age_group</code> column with the following cutoffs.</p>
<ul>
<li>&lt; 18 = “underage”</li>
<li>18 - 25 = “youth”</li>
<li>26 - 35 = “adult”</li>
<li>36 - 50 = “middle-age”</li>
<li>50+ = “old”</li>
</ul>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2"> Show me the solution </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    age_group <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">18</span> <span class="op">~</span> <span class="st">"underage"</span>,</span>
<span>      <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">25</span> <span class="op">~</span> <span class="st">"youth"</span>,</span>
<span>      <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">26</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">35</span> <span class="op">~</span> <span class="st">"adult"</span>,</span>
<span>      <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">36</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"middle-age"</span>,</span>
<span>      <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"old"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean_score <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">mean_dass_score</span><span class="op">)</span>,</span>
<span>    n_entries <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 5 × 3
  age_group  mean_score n_entries
  &lt;chr&gt;           &lt;dbl&gt;     &lt;int&gt;
1 adult            2.23      6229
2 middle-age       2.10      2288
3 old              1.97       950
4 underage         2.64      7269
5 youth            2.40     23039</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>Compute the relative frequency of whether somebody voted or not based
on their age group (defined above). Make sure you compute the percentage
of people that voted given their age, not the percentage of age given
their voting status.</p>
</div>
</div>
</div>
<div id="challenge-6" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6</h3>
<div class="callout-content">
<p>Sort the above output by the relative frequency of people that voted.
Use the <code>arrange()</code> function after counting and computing the
percentage. Use the help <code>?arrange</code>, Google or ChatGPT to
figure out how to use this function.</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3"> Show me the solution </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">voted</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Don't include missing values of voted = 0</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    age_group <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">18</span> <span class="op">~</span> <span class="st">"underage"</span>,</span>
<span>      <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">18</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">25</span> <span class="op">~</span> <span class="st">"youth"</span>,</span>
<span>      <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">26</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">35</span> <span class="op">~</span> <span class="st">"adult"</span>,</span>
<span>      <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">36</span> <span class="op">&amp;</span> <span class="va">age</span> <span class="op">&lt;=</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"middle-age"</span>,</span>
<span>      <span class="va">age</span> <span class="op">&gt;</span> <span class="fl">50</span> <span class="op">~</span> <span class="st">"old"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">count</span><span class="op">(</span><span class="va">age_group</span>, <span class="va">voted</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">age_group</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    percentage <span class="op">=</span> <span class="fu">round</span><span class="op">(</span><span class="va">n</span> <span class="op">/</span> <span class="fu">sum</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">percentage</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 10 × 4
# Groups:   age_group [5]
   age_group  voted     n percentage
   &lt;chr&gt;      &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
 1 underage       2  7125      98.9
 2 youth          2 17534      76.7
 3 old            1   573      61.8
 4 adult          1  3710      60.0
 5 middle-age     1  1346      59.4
 6 middle-age     2   919      40.6
 7 adult          2  2468      40.0
 8 old            2   354      38.2
 9 youth          1  5337      23.3
10 underage       1    82       1.14</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="challenge-6" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-6" class="callout-inner">
<h3 class="callout-title">Challenge 6<em> (continued)</em>
</h3>
<div class="callout-content">
<p>What can you learn by the output?</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Use <code>count()</code> to compute the number of occurrences for
(combinations) of columns</li>
<li>Use <code>summarize()</code> to compute any summary statistics for
your data</li>
<li>Use <code>group_by()</code> to group your data so you can receive
summaries for each group separately</li>
<li>Combine functions like <code>filter()</code>,
<code>group_by()</code> and <code>summarize()</code> using the pipe to
receive specific results</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-midterms"><p>Content from <a href="midterms.html">Midterms</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/midterms.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>No new questions today, only application</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Apply learnings from previous episodes to new data</li>
<li>Get to know data by visual inspection, data visualization and
descriptive statistics</li>
<li>Filter data to include only valid values</li>
<li>Compute new columns</li>
<li>Compute summary statistics</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="a-new-dataset-approaches">A new dataset approaches<a class="anchor" aria-label="anchor" href="#a-new-dataset-approaches"></a>
</h2>
<hr class="half-width">
<p>Welcome to the “Midterms”! Today, we there will be no new lessons or
functions that you have to understand. This episode is all about
applying the things you already learnt to new data. We will use data
collected by a previous Empra, who were investigating the impact of
color on intelligence test performance.</p>
<p>Here, they tried to replicate an effect published by Elliot et
al. (2007) concerning “the effect of red on performance attainment”. The
original study showed that the presentation of the color red, for
example by showing the participant a number in red, lowers the
performance on a subsequent intelligence test. The tried to replicate
this study online, by coloring the whole intelligence test red.</p>
<figure><img src="fig/red_heiq.png" alt="Picture of intelligence test item in red" class="figure mx-auto d-block"><div class="figcaption">Intelligence Test (HeiQ) Item with red
background</div>
</figure><p>The performance of participants completing the test with red
background could then be compared to participants with a green
background and those with a grey/black background.</p>
<p>Additionally, a bachelor thesis integrated into the same project
collected data on physical activity.</p>
</section><section><h2 class="section-heading" id="your-task">Your task<a class="anchor" aria-label="anchor" href="#your-task"></a>
</h2>
<hr class="half-width">
<p>In this episode, there will only be challenges that contain the key
functions introduced in earlier episodes. The challenges will guide you
through the process of getting to know the data and applying your
knowledge to new data. I will not provide solutions to this challenge in
the current file, as you are encouraged to try solving this for
yourself. As such, you may also use different methods than I, which lead
to the same outcome or allow similar conclusions. If you get stuck, ask
ChatGPT or a friend, or sleep on it! That often helped me.</p>
<p>Each challenge will include a short hint to the episode that contains
information on how to solve it.</p>
<p>Try to write a “clean” script, using proper variable names and
comments to describe what you are doing.</p>
</section><section><h2 class="section-heading" id="challenges">Challenges<a class="anchor" aria-label="anchor" href="#challenges"></a>
</h2>
<hr class="half-width">
<div id="challenge-1-vectors-and-variable-types" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1-vectors-and-variable-types" class="callout-inner">
<h3 class="callout-title">Challenge 1 (<em>Vectors and variable
types</em>)</h3>
<div class="callout-content">
<p>Create a script called <em>midterms_firstname_lastname.R</em> in the
current project. Load the packages <code>dplyr</code>,
<code>ggplot2</code> and <code>psych</code>. Install any packages that
you have not yet installed.</p>
</div>
</div>
</div>
<div id="challenge-2-projects" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2-projects" class="callout-inner">
<h3 class="callout-title">Challenge 2 (<em>Projects</em>)</h3>
<div class="callout-content">
<p>Download the data <a href="data/empra_color_intelligence_clean.csv">here</a> and store it in
your <code>raw_data/</code> folder. Then load it into the current
session using an appropriate function.</p>
</div>
</div>
</div>
<div id="challenge-3-data-visualization-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3-data-visualization-1" class="callout-inner">
<h3 class="callout-title">Challenge 3 (<em>Data Visualization
(1)</em>)</h3>
<div class="callout-content">
<p>Get to know the data. What are the column names? What type of
information does each column store? Inspect the data visually and get
the column names using an R function. Which columns are relevant for
intelligence test performance? Which columns are related to physical
activity?</p>
</div>
</div>
</div>
<div id="challenge-4-data-visualization-1-filtering-data" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4-data-visualization-1-filtering-data" class="callout-inner">
<h3 class="callout-title">Challenge 4 (<em>Data Visualization (1)</em> /
<em>Filtering data</em>)</h3>
<div class="callout-content">
<p>Get an overview of descriptive statistics of the whole dataset.
Inspect the mean, minimum and maximum values in the columns you think
are relevant. What do you notice? Use <code>select()</code> to create a
smaller dataset that only includes the columns you think are relevant to
make the overview simpler.</p>
</div>
</div>
</div>
<div id="challenge-5-filtering-data" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5-filtering-data" class="callout-inner">
<h3 class="callout-title">Challenge 5 (<em>Filtering data</em>)</h3>
<div class="callout-content">
<p>The column <em>item_kont</em> includes information about the response
to a control item. This item is so easy, that everyone should answer it
correctly, given that they payed attention. If the value in item_kont is
1, the answer is correct. Otherwise it is incorrect.</p>
<p>Exclude all participants who did not answer correctly to the control
item. Conduct sanity checks. How many participants were excluded? Did
those participants have answers to the other questions?</p>
</div>
</div>
</div>
<div id="challenge-6-creating-new-columns" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-6-creating-new-columns" class="callout-inner">
<h3 class="callout-title">Challenge 6 (<em>Creating new
columns</em>)</h3>
<div class="callout-content">
<p>Create new columns for each of the items that are named
<code>itemNUMBER_accuracy</code>. Each entry should be 1 if the
participant answered that item correctly and 0 if they did not.</p>
<p>If possible, use <code>mutate()</code> and <code>across()</code> for
this. Otherwise, simply use 12 lines of <code>mutate()</code>. Make sure
to conduct sanity checks whether this worked.</p>
</div>
</div>
</div>
<div id="challenge-7-creating-new-columns" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-7-creating-new-columns" class="callout-inner">
<h3 class="callout-title">Challenge 7 (<em>Creating new
columns</em>)</h3>
<div class="callout-content">
<p>Create a column containing the total score of a participant. This
should be the number of items they responded to correctly.</p>
</div>
</div>
</div>
<div id="challenge-8-data-visualization-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-8-data-visualization-2" class="callout-inner">
<h3 class="callout-title">Challenge 8 (<em>Data Visualization
(2)</em>)</h3>
<div class="callout-content">
<p>Compute key summary statistics of the total score of participants.
Inspect the distribution of values using <code>hist()</code>. What do
you notice? Are the minimum / maximum values plausible?</p>
</div>
</div>
</div>
<div id="challenge-9-filtering-data" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-9-filtering-data" class="callout-inner">
<h3 class="callout-title">Challenge 9 (<em>Filtering data</em>)</h3>
<div class="callout-content">
<p>Each item had 9 possible answers. Exclude participants who achieved a
score that was below random chance.</p>
<p>Additionally, the columns beginning with <em>dq_</em> include
information about <em>disqualification_criteria</em>. Exclude
participants based on the following criteria:</p>
<ul>
<li>dq_meaningless_responses = 3</li>
<li>dq_distraction = 3</li>
</ul>
</div>
</div>
</div>
<div id="challenge-10-count-and-summarize" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-10-count-and-summarize" class="callout-inner">
<h3 class="callout-title">Challenge 10 (<em>Count and
summarize</em>)</h3>
<div class="callout-content">
<p>Count the number of occurrences of each of the three conditions in
<code>fragebogen_der_im_interview_verwendet_wurde</code>. Compute the
relative percentages.</p>
</div>
</div>
</div>
<div id="challenge-11-count-and-summarize" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-11-count-and-summarize" class="callout-inner">
<h3 class="callout-title">Challenge 11 (<em>Count and
summarize</em>)</h3>
<div class="callout-content">
<p>Compute the average score by condition. Include the number of
participants by condition and the standard deviation, too.</p>
</div>
</div>
</div>
<div id="challenge-12---new" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-12---new" class="callout-inner">
<h3 class="callout-title">Challenge 12 - New!</h3>
<div class="callout-content">
<p>Create a visualization showing the scores by condition. Here apply
some of the knowledge from <em>Data visualization (2)</em> and add
Google or ChatGPT to create a plot showing the condition differences (or
lack thereof) in intelligence test scores.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Apply what you have learned in new data!</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-t-test"><p>Content from <a href="t-test.html">t-Test</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/t-test.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>When can I use a t-test?</li>
<li>What type of t-test should I use?</li>
<li>How can I run a t-test in R?</li>
<li>How should I interpret the results of a t-test</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the assumptions behind a t-test.</li>
<li>Demonstrate how to check the assumptions of a t-test.</li>
<li>Show when to use a paired t-test, an independent samples t-test or a
one-sample t-test.</li>
<li>Learn practical applications of the t-test in R.</li>
<li>Explain key issues in t-test interpretation.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="inferential-statistics">Inferential statistics<a class="anchor" aria-label="anchor" href="#inferential-statistics"></a>
</h2>
<hr class="half-width">
<p>So far, we have not “tested” anything. We have only described values
and visualized distributions. We have stayed in the cozy realm of
<em>descriptive statistics</em>. With descriptive statistics, we can
describe data, we can look at a graph and say “this bar is higher than
the other one”. Importantly, these conclusions are only truly valid for
the present data! Meaning that we cannot generalize our results into
other data, other samples, and more generally <em>the population</em>.
Today, we will venture out into the different, scary world of
<em>inferential statistics</em> that aims to address this problem.</p>
<p>Importantly, generalizing the results to a population is most often
the goal of (psychological) research. Whatever a current sample does is
irrelevant, we want to know whether the effect, the correlation, or the
factor structure is present for the whole population from which we
randomly selected some participants for our study.</p>
<p>This can be addressed by inferential (frequentist) statistics, asking
the key question: “is this finding <em>significant</em>?”. Or, is my
finding of an effect in a sample likely to be the result from a true
effect in a population (significant) or just due to random sampling
error.</p>
<p>Inferential statistics encompasses a large number of methods:
t-tests, ANOVAs, linear regression only to name a few. For now, we will
start out with the t-test which is useful when investigating mean
values: Is the mean value of one group significantly higher than another
group? Is my mean value significantly different from 0? This allows us
to go beyond</p>
<p>Somehting about I will not go into details of statistical tests
(recommendation).</p>
<p>Just broadly, we assume some distribution of the key statistic of
interest (the test statistic) in the population given a null hypothesis
(mean is 0, means are identical). This test statistic is… Then, we check
our empirical test statistic. We can place this into the distribution to
see how likely we are to observe this, given our assumptions in the
test. In psychology we say that if it is less than 5% likely, we reject
our assumptions of a null hypothesis.</p>
<p>This is true for all frequentists tests, they make some assumptions
of a null hypothesis and the p-value indicates how likely we are to
observe our current data given this null hypothesis. If we are less than
5% likely, we say that the null hypothesis is not true and reject
it.</p>
<p>For example, something with mean value in dass data. Show some group
differences based on education. Then illustrate the basic logic of the
t-test.</p>
<p>show the basic t-test formula in r</p>
<p>then discuss assumptions of the t-test- - independence, random
sampling, (approx) normal dist, variance - talk about robustness</p>
<p>show how to check the assumptions of the t-test. When is that an
issue, when not?</p>
<p>There are different types of t-tests. Show what each of them are and
show example uses in the dass data (maybe with half-splits in DASS?,
check against two groups and criterium).</p>
<p>Now show how to interpret the t-test. Show and discuss the summary
output. Explain how to report it in text and go over effect sizes!!</p>
<p>Show how to compute cohens d and why this is important.</p>
<p>Give personal recommendations. Focus on effect sizes, report
p-values. Same when reading some paper. p-value is necessary, but it is
mainly a function of sample size. So take with caution. Say something
about no evidence for null. Something with BAYES</p>
<p>Now what if multiple groups? Outlook for next time: ANOVA</p>
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Read in data and compute mean</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Check the assumptions of a t tesrt</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>compute several t-tests, one-sample and independent samples</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>compute t.test with different vectors and t-test using formula</p>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>write a report of a t-test with effect size aswell.</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Something</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-factor-analysis"><p>Content from <a href="factor-analysis.html">Factor Analysis - Introduction &amp; EFA</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/factor-analysis.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a factor analysis?</li>
<li>What is the difference between exploratory and confirmatory factor
analysis?</li>
<li>How can I run exploratory factor analysis in R?</li>
<li>How can I interpret the results of an EFA in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain the idea behind factor analysis</li>
<li>Understand the difference between exploratory and confirmatory
factor analysis</li>
<li>Learn how to conduct exploratory factor analysis in R</li>
<li>Learn how to interpret the results of EFA in R</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="factor-analysis">Factor analysis<a class="anchor" aria-label="anchor" href="#factor-analysis"></a>
</h2>
<hr class="half-width">
<p>Factor analysis is used to identify latent constructs—called
factors—that explain the correlation patterns among observed variables.
It helps reduce a large number of variables into fewer interpretable
components.</p>
<p>It was first developed by Spearman in a field of study near to the
heart of the author of this resource. Spearman noticed that students
performing well in one subject in school tended to perform well in other
subjects - there were high intercorrelations between academic
performance. In order to investigate the structure behind these
correlations, he used an early version of factor analysis to discover
the now well known “g” factor of intelligence. One driving factor at the
heart of intercorrelations of cognitive abilities.</p>
<p>This already illustrates several key principles of factor analysis.
First, the key object of study are <em>factors</em>, mathematical
constructs that can explain correlations between measured variables. In
some fields such as structural equation modeling, these factors are
sometimes referred to as <em>latent variables</em>. Latent, because they
cannot be measured directly, contrary to <em>manifest variables</em>
like academic performance. Importantly, these factors can show high
validity in measuring a <em>construct</em> but are not the same!
Construct validation requires a thorough research program before it can
conclusively be stated that a certain factors is equal to a construct.
For now, keep in mind that factors are mathematical in nature and can be
a step towards measuring a construct, but do not necessarily do so.</p>
<p>Secondly, the key data in factor analysis are correlations! The
underlying entry in any factor analysis is the covariance (or
correlation) matrix. Modern statistical programs also allow us to
provide the raw data and handle computing the correlation matrix, but
these correlations are the core concept on which factor analysis is
built.</p>
<p>Thirdly, there exists a difference between exploratory factor
analysis (EFA) and confirmatory factor analysis (CFA).<em>Exploratory
Factor Analysis (EFA)</em> is used when we do not have a predefined
structure. It explores patterns and relationships. This is method is
purely descriptive. In contrast <em>Confirmatory Factor Analysis
(CFA)</em> is used when we do have a theory or structure to test. It
evaluates how well the model fits the data. This is confirmatory and
inferential, meaning we can test whether a given model fits our data, or
doesn’t. Depending on whether you seek to explore the structure behind
correlations of variables/items or test a hypothesized structure, choose
the correct approach. Importantly, you cannot do both. You cannot use
the same data to conduct an EFA, and then use this discovery in a
subsequent CFA “testing” your factor structure. This needs to be done in
an <em>independent</em> sample.</p>
<p>This is just a short introduction, details and further tutorial can
be found here: <a href="https://lavaan.ugent.be/tutorial/cfa.html" class="external-link uri">https://lavaan.ugent.be/tutorial/cfa.html</a> – CFA tutorial
lavaan <a href="https://rpubs.com/pjmurphy/758265" class="external-link uri">https://rpubs.com/pjmurphy/758265</a> – EFA tutorial
Rpubs</p>
<p>Or in textbooks: - Stemmler et al (2016), Abschn. 2.1.4 - Tabachnik,
B. G., &amp; Fidell, L. S. (2001). Using multivariate statistics. 4th
Ed. (chapter 13). Boston: Allyn and Bacon.</p>
</section><section><h2 class="section-heading" id="examples-using-dass-data">Examples using DASS data<a class="anchor" aria-label="anchor" href="#examples-using-dass-data"></a>
</h2>
<hr class="half-width">
<p>Now, lets apply this theory to some actual data. Recall the DASS data
from earlier lessons. Here, we have item-wise responses to a
questionnaire claiming to measure three constructs, <em>depression,
anxiety, and stress</em></p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/kaggle_dass/data.csv"</span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s make our lives a little bit easier by only selecting the
relevant columns for the subsequent factor analysis.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">testelapse</span> <span class="op">&lt;</span> <span class="fl">600</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span><span class="op">&amp;</span> <span class="fu">ends_with</span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">psych</span><span class="fu">::</span><span class="fu">describe</span><span class="op">(</span><span class="va">fa_data</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>     vars     n mean   sd median trimmed  mad min max range  skew kurtosis   se
Q1A     1 37242 2.62 1.03      3    2.65 1.48   1   4     3 -0.03    -1.19 0.01
Q2A     2 37242 2.17 1.11      2    2.09 1.48   1   4     3  0.46    -1.16 0.01
Q3A     3 37242 2.23 1.04      2    2.16 1.48   1   4     3  0.40    -1.02 0.01
Q4A     4 37242 1.95 1.05      2    1.82 1.48   1   4     3  0.75    -0.71 0.01
Q5A     5 37242 2.53 1.07      2    2.54 1.48   1   4     3  0.04    -1.26 0.01
Q6A     6 37242 2.55 1.05      2    2.56 1.48   1   4     3  0.04    -1.21 0.01
Q7A     7 37242 1.93 1.04      2    1.79 1.48   1   4     3  0.79    -0.62 0.01
Q8A     8 37242 2.49 1.05      2    2.48 1.48   1   4     3  0.10    -1.20 0.01
Q9A     9 37242 2.67 1.07      3    2.71 1.48   1   4     3 -0.13    -1.26 0.01
Q10A   10 37242 2.46 1.14      2    2.45 1.48   1   4     3  0.10    -1.40 0.01
Q11A   11 37242 2.81 1.05      3    2.88 1.48   1   4     3 -0.28    -1.19 0.01
Q12A   12 37242 2.43 1.07      2    2.41 1.48   1   4     3  0.13    -1.22 0.01
Q13A   13 37242 2.79 1.07      3    2.86 1.48   1   4     3 -0.26    -1.26 0.01
Q14A   14 37242 2.58 1.08      2    2.61 1.48   1   4     3 -0.01    -1.29 0.01
Q15A   15 37242 1.83 0.99      2    1.67 1.48   1   4     3  0.94    -0.28 0.01
Q16A   16 37242 2.53 1.11      2    2.53 1.48   1   4     3  0.03    -1.35 0.01
Q17A   17 37242 2.66 1.16      3    2.71 1.48   1   4     3 -0.16    -1.44 0.01
Q18A   18 37242 2.47 1.07      2    2.46 1.48   1   4     3  0.10    -1.23 0.01
Q19A   19 37242 1.95 1.07      2    1.81 1.48   1   4     3  0.78    -0.74 0.01
Q20A   20 37242 2.33 1.12      2    2.29 1.48   1   4     3  0.25    -1.30 0.01
Q21A   21 37242 2.36 1.17      2    2.32 1.48   1   4     3  0.22    -1.43 0.01
Q22A   22 37242 2.35 1.03      2    2.31 1.48   1   4     3  0.25    -1.08 0.01
Q23A   23 37242 1.57 0.87      1    1.39 0.00   1   4     3  1.47     1.24 0.00
Q24A   24 37242 2.45 1.05      2    2.43 1.48   1   4     3  0.15    -1.18 0.01
Q25A   25 37242 2.19 1.08      2    2.11 1.48   1   4     3  0.42    -1.12 0.01
Q26A   26 37242 2.66 1.07      3    2.70 1.48   1   4     3 -0.12    -1.26 0.01
Q27A   27 37242 2.61 1.05      3    2.64 1.48   1   4     3 -0.04    -1.23 0.01
Q28A   28 37242 2.22 1.08      2    2.15 1.48   1   4     3  0.39    -1.13 0.01
Q29A   29 37242 2.65 1.06      3    2.69 1.48   1   4     3 -0.10    -1.24 0.01
Q30A   30 37242 2.40 1.08      2    2.37 1.48   1   4     3  0.17    -1.24 0.01
Q31A   31 37242 2.38 1.05      2    2.35 1.48   1   4     3  0.22    -1.13 0.01
Q32A   32 37242 2.45 1.02      2    2.44 1.48   1   4     3  0.15    -1.10 0.01
Q33A   33 37242 2.42 1.05      2    2.40 1.48   1   4     3  0.15    -1.18 0.01
Q34A   34 37242 2.64 1.15      3    2.67 1.48   1   4     3 -0.12    -1.44 0.01
Q35A   35 37242 2.31 1.00      2    2.26 1.48   1   4     3  0.31    -0.96 0.01
Q36A   36 37242 2.27 1.11      2    2.21 1.48   1   4     3  0.34    -1.24 0.01
Q37A   37 37242 2.38 1.14      2    2.35 1.48   1   4     3  0.21    -1.37 0.01
Q38A   38 37242 2.40 1.19      2    2.38 1.48   1   4     3  0.16    -1.49 0.01
Q39A   39 37242 2.45 1.02      2    2.44 1.48   1   4     3  0.15    -1.10 0.01
Q40A   40 37242 2.65 1.11      3    2.69 1.48   1   4     3 -0.13    -1.34 0.01
Q41A   41 37242 1.97 1.05      2    1.84 1.48   1   4     3  0.74    -0.72 0.01
Q42A   42 37242 2.69 1.03      3    2.74 1.48   1   4     3 -0.11    -1.20 0.01</code></pre>
</div>
<div id="beware-of-reversed-items" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="beware-of-reversed-items" class="callout-inner">
<h3 class="callout-title">Beware of reversed items</h3>
<div class="callout-content">
<p>This is especially relevant for EFA, but also for cfa as this might
have some adverse impact</p>
</div>
</div>
</div>
<p>In theory, this questionnaire has a well-known proposed factor
structure. It’s in the name - three factors: depression, anxiety,
stress. Since it is also known which items are supposed to measure which
factor, this would make the DASS data ideally suited for <em>CFA</em>,
not EFA. However, for the sake of this exercise, let’s forget all of
this for a second and pretend like we have no idea how the factor
structure might look like.</p>
<p>As a first step, make sure the data is properly cleaned. After this
is done, we can start the proper factor analysis process by
investigating the correlation matrix of our data. Ideally, we will see
high correlations between some items / variables. Should we observe no,
or low correlations between all items, factor analysis will have a hard
time identifying any underlying factors, as the items do not seem to
share common influences.</p>
<p>Let’s start by computing the correlation matrix using
<code>cor()</code>.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corr_mat</span> <span class="op">&lt;-</span> <span class="fu">cor</span><span class="op">(</span><span class="va">fa_data</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># head(corr_mat)</span></span></code></pre>
</div>
<p>Now, we can visualize this using the package
<code>ggcorrplot</code>.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggcorrplot</span><span class="fu">::</span><span class="fu">ggcorrplot</span><span class="op">(</span><span class="va">corr_mat</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/factor-analysis-rendered-unnamed-chunk-4-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>In our case, we are greeted by a red square. A welcome sign for
factor analysis as it indicates high correlations between items. This is
even unusually uniform, other examples may show some variables
correlating high with each other and low with other items. This is also
perfectly normal. It’s only important that there are <em>some</em>
correlations before proceeding with factor analysis.</p>
</section><section><h2 class="section-heading" id="running-the-efa">Running the EFA<a class="anchor" aria-label="anchor" href="#running-the-efa"></a>
</h2>
<hr class="half-width">
<p>Now, we can already start running the EFA. In R, the easiest way to
do this is using <code>fa.parallel()</code> from the package
<code>psych</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">psych</span><span class="op">)</span></span>
<span></span>
<span><span class="va">efa_result</span> <span class="op">&lt;-</span> <span class="fu">fa.parallel</span><span class="op">(</span><span class="va">fa_data</span>, fa <span class="op">=</span> <span class="st">"fa"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/factor-analysis-rendered-unnamed-chunk-5-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Parallel analysis suggests that the number of factors =  9  and the number of components =  NA </code></pre>
</div>
<p>Now, this function already gives you a lot of insight. First of all,
you get two immediate results - a plot and a message informing you about
the number of factors.</p>
<p>As a general rule, I would focus mainly on the plot and discard the
message. This message is based on a resampling technique used to
simulate new data without an underlying factor structure and then
determines how many factors in the true data deviate significantly from
this random simulation. In large datasets, this may overestimate the
number of factors severly, as is the case in this example.</p>
<p>More important is the plot overall. It is called a
<em>Scree-plot</em> and shows the eigenvalues of the factor solution.
These eigenvalues indicate how much variance is explained by a factor.
The larger the eigenvalue, the more variance explained by a factor.</p>
<p>These eigenvalues are already the basis of a selection technique on
how many factors should be retained. Kaisers criterion states that all
factors with eigenvalues &gt; 1 should be extracted. In our case, these
are the eigenvalues:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">efa_result</span><span class="op">$</span><span class="va">fa.values</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> [1] 18.588506243  2.318687720  1.042780083  0.543667379  0.425206073
 [6]  0.257496536  0.145156657  0.094570513  0.041015178  0.028355531
[11]  0.001674441 -0.037595873 -0.041986500 -0.060701707 -0.065750863
[16] -0.082565635 -0.084817673 -0.095206394 -0.113248993 -0.115666333
[21] -0.129713392 -0.134490302 -0.144248475 -0.147258433 -0.150618100
[26] -0.153739659 -0.159396508 -0.166141135 -0.170279676 -0.172584141
[31] -0.175380247 -0.184334478 -0.188107697 -0.190790974 -0.194604989
[36] -0.195616247 -0.206315648 -0.243863018 -0.245374734 -0.248541704
[41] -0.280156397 -0.319514269</code></pre>
</div>
<p>In this case, 3 factors exceed eigenvalues of 1 and should thus be
extracted (which aligns with theory nicely).</p>
<p>Another way of extracting the number of factors is by investigating
the shape of the Scree plot directly. Here, we can see that the first
factor has by far the largest value and thus already explains
substantial variance. We can also see that all the other factors explain
roughly the same amount of variance, with a possible exception of number
2 and 3. But certainly after the third factor, the amount of variance is
low and decreases linearly.</p>
<p>In this method, we are looking to identify the “elbow” in the
eigenvalue progression after which there is a sudden drop off in the
variance explained. In this case, there is a strong argument that this
occurs right after the first factor. The Scree plot would thus hint at
only extracting one factor.</p>
<p>However, be cautious of relying on a single criterion to evaluate the
number of factors. Kaisers criterion may be too liberal and the Scree
plot may not be informative enough to warrant a certain guess. In the
end, you should also select the number of factors that make the most
sense psycho<em>logically</em> and allow you to interpret the findings.
You can not only rely on the eigenvalues to make this choice, but should
also investigate the factor loadings of the items for a given number of
factors.</p>
</section><section><h2 class="section-heading" id="investigating-factor-loadings">Investigating Factor Loadings<a class="anchor" aria-label="anchor" href="#investigating-factor-loadings"></a>
</h2>
<hr class="half-width">
<p>Factor loadings can be determined for any given number of factors.
They tell you how strongly the factor overall is related to a specific
item. The higher, the better. The item with the highest loading on a
factor is called the “marker item” and may inform you (in conjunction
with the other items loading highly) as to what construct this factor
actually reflects.</p>
<p>In principle, you are looking for <em>simple structure</em>. Items
should load highly on one and only one factor while showing low loadings
(&lt; 0.3) on the other factors. If this is not the case, attributing an
item to a single factor might not be warranted.</p>
<p>In order to obtain the factor loadings, we need to make two important
choices. The first concerns the number of factors we want to
investigate. For this example, let’s look at both one and three factors
and investigate their structure. The second decision concerns the
correlation between factors themselves. If you have strong reason to
believe that the factors should be uncorrelated, or want to restrict the
factors to be uncorrelated, i.e. independent of each other, you need to
apply an <em>orthoghonal</em> rotation in the factor analyis. If you
believe that the factors may themselves be related, you should apply an
<em>oblique</em> rotation, which still allows for correlations between
factors. In the case of only one extracted factor, this does not make a
difference. In our specific example with three extracted factors,
depression, anxiety, and stress may indeed be related. So we will
proceed with the oblique rotation method called <em>oblimin</em>.</p>
<p>Let’s investigate the factor loadings for a three factor oblique
solution.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fa_solution_3</span> <span class="op">&lt;-</span> <span class="fu">psych</span><span class="fu">::</span><span class="fu">fa</span><span class="op">(</span><span class="va">fa_data</span>, nfactors <span class="op">=</span> <span class="fl">3</span>, rotate <span class="op">=</span> <span class="st">"oblimin"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Loading required namespace: GPArotation</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fa_solution_3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Factor Analysis using method =  minres
Call: psych::fa(r = fa_data, nfactors = 3, rotate = "oblimin")
Standardized loadings (pattern matrix) based upon correlation matrix
       MR1   MR3   MR2   h2   u2 com
Q1A   0.08  0.73 -0.03 0.60 0.40 1.0
Q2A   0.05  0.07  0.42 0.26 0.74 1.1
Q3A   0.73  0.05  0.02 0.61 0.39 1.0
Q4A   0.03 -0.04  0.74 0.53 0.47 1.0
Q5A   0.62  0.13  0.04 0.56 0.44 1.1
Q6A  -0.05  0.71  0.05 0.51 0.49 1.0
Q7A   0.01 -0.07  0.81 0.58 0.42 1.0
Q8A   0.16  0.37  0.27 0.50 0.50 2.3
Q9A  -0.01  0.38  0.38 0.48 0.52 2.0
Q10A  0.89 -0.07 -0.02 0.69 0.31 1.0
Q11A  0.10  0.76 -0.07 0.62 0.38 1.1
Q12A -0.01  0.33  0.48 0.54 0.46 1.8
Q13A  0.65  0.19  0.02 0.66 0.34 1.2
Q14A -0.09  0.60  0.08 0.35 0.65 1.1
Q15A  0.14 -0.03  0.59 0.43 0.57 1.1
Q16A  0.77  0.03 -0.01 0.62 0.38 1.0
Q17A  0.74  0.07  0.01 0.64 0.36 1.0
Q18A  0.04  0.55  0.03 0.37 0.63 1.0
Q19A -0.01  0.03  0.58 0.35 0.65 1.0
Q20A  0.11  0.25  0.45 0.52 0.48 1.7
Q21A  0.88 -0.07  0.02 0.72 0.28 1.0
Q22A  0.17  0.41  0.20 0.49 0.51 1.8
Q23A  0.10 -0.05  0.58 0.37 0.63 1.1
Q24A  0.70  0.07  0.01 0.58 0.42 1.0
Q25A  0.00  0.02  0.66 0.46 0.54 1.0
Q26A  0.62  0.19  0.02 0.60 0.40 1.2
Q27A  0.11  0.70 -0.05 0.57 0.43 1.1
Q28A  0.00  0.24  0.58 0.58 0.42 1.3
Q29A  0.06  0.62  0.12 0.56 0.44 1.1
Q30A  0.13  0.34  0.27 0.43 0.57 2.2
Q31A  0.72  0.03  0.02 0.56 0.44 1.0
Q32A  0.04  0.60  0.06 0.45 0.55 1.0
Q33A  0.03  0.30  0.48 0.55 0.45 1.7
Q34A  0.76  0.07  0.00 0.66 0.34 1.0
Q35A  0.08  0.56  0.06 0.44 0.56 1.1
Q36A  0.18  0.24  0.40 0.53 0.47 2.1
Q37A  0.86 -0.08  0.00 0.64 0.36 1.0
Q38A  0.90 -0.09  0.01 0.70 0.30 1.0
Q39A  0.10  0.57  0.10 0.52 0.48 1.1
Q40A  0.02  0.37  0.36 0.47 0.53 2.0
Q41A  0.00 -0.07  0.77 0.53 0.47 1.0
Q42A  0.51  0.16  0.03 0.43 0.57 1.2

                       MR1  MR3  MR2
SS loadings           9.01 6.93 6.32
Proportion Var        0.21 0.17 0.15
Cumulative Var        0.21 0.38 0.53
Proportion Explained  0.40 0.31 0.28
Cumulative Proportion 0.40 0.72 1.00

 With factor correlations of
     MR1  MR3  MR2
MR1 1.00 0.70 0.59
MR3 0.70 1.00 0.69
MR2 0.59 0.69 1.00

Mean item complexity =  1.3
Test of the hypothesis that 3 factors are sufficient.

df null model =  861  with the objective function =  27.87 with Chi Square =  1037323
df of  the model are 738  and the objective function was  2.08

The root mean square of the residuals (RMSR) is  0.03
The df corrected root mean square of the residuals is  0.03

The harmonic n.obs is  37242 with the empirical chi square  41215.05  with prob &lt;  0
The total n.obs was  37242  with Likelihood Chi Square =  77517.62  with prob &lt;  0

Tucker Lewis Index of factoring reliability =  0.914
RMSEA index =  0.053  and the 90 % confidence intervals are  0.053 0.053
BIC =  69750.03
Fit based upon off diagonal values = 1
Measures of factor score adequacy
                                                   MR1  MR3  MR2
Correlation of (regression) scores with factors   0.98 0.96 0.96
Multiple R square of scores with factors          0.96 0.93 0.92
Minimum correlation of possible factor scores     0.92 0.85 0.83</code></pre>
</div>
<p>Let’s take a closer look at the factor loadings:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">print</span><span class="op">(</span><span class="va">fa_solution_3</span><span class="op">$</span><span class="va">loadings</span>, cutoff <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Loadings:
     MR1    MR3    MR2
Q1A          0.730
Q2A                 0.423
Q3A   0.729
Q4A                 0.741
Q5A   0.622
Q6A          0.714
Q7A                 0.809
Q8A          0.366
Q9A          0.380  0.379
Q10A  0.886
Q11A         0.758
Q12A         0.325  0.477
Q13A  0.652
Q14A         0.598
Q15A                0.585
Q16A  0.771
Q17A  0.745
Q18A         0.553
Q19A                0.576
Q20A                0.446
Q21A  0.884
Q22A         0.412
Q23A                0.583
Q24A  0.705
Q25A                0.663
Q26A  0.616
Q27A         0.704
Q28A                0.580
Q29A         0.615
Q30A         0.344
Q31A  0.716
Q32A         0.604
Q33A         0.301  0.483
Q34A  0.760
Q35A         0.562
Q36A                0.405
Q37A  0.857
Q38A  0.895
Q39A         0.567
Q40A         0.368  0.364
Q41A                0.774
Q42A  0.509

                 MR1   MR3   MR2
SS loadings    8.037 5.409 5.109
Proportion Var 0.191 0.129 0.122
Cumulative Var 0.191 0.320 0.442</code></pre>
</div>
<p>Here, we can see that some items load highly one one of the three
factors and do not load on any other factor (like 1-7). However, some
items load on two factors (item 9, 12 etc). Here, we may want to
investigate the items themselves to figure out which items load highly
on which factor and why some of these items cannot be attributed to a
single factor.</p>
<p>The marker items for the factors seem to be item 38 for factor 1,
item 11 for factor 2, and item 7 for factor three. In the codebook, we
can look up the item text itself.</p>
<ul>
<li>Item 38: “I felt that life was meaningless.”</li>
<li>Item 11: “I found myself getting upset rather easily.”</li>
<li>Item 7: “I had a feeling of shakiness (eg, legs going to give
way).”</li>
</ul>
<p>Now, one might see the factors Depression (meaningless life), Anxiety
(getting upset) and Stress (shakiness) in these factors.</p>
<p>We can visualize the factor structure using
<code>fa.diagram()</code>.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fa.diagram</span><span class="op">(</span><span class="va">fa_solution_3</span>, simple <span class="op">=</span> <span class="cn">TRUE</span>, cut <span class="op">=</span> <span class="fl">0.3</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/factor-analysis-rendered-unnamed-chunk-9-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Lastly, we always have to investigate the correlations between the
factors themselves. The plot already reveals substantial correlations of
the three factors between 0.6 and 0.7.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fa_solution_3</span><span class="op">$</span><span class="va">score.cor</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>          [,1]      [,2]      [,3]
[1,] 1.0000000 0.7470426 0.6650608
[2,] 0.7470426 1.0000000 0.7935208
[3,] 0.6650608 0.7935208 1.0000000</code></pre>
</div>
<p>This indicates that there might be a higher order factor influencing
all three factors. In the next episode, we can define a model testing
whether this is the case or not.</p>
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Read in data and answer the question: do we have a hypothesis as to
how the structure should be?</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Run an EFA, how many factors would you extract using the Kaiser
criterion, how many using the scree-plot</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Choose three factors and investigate the item loadings. Do we have
simple structure?</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>Choose one factor and investigate the item loadings</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Something</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-factor-analysis-02"><p>Content from <a href="factor-analysis-02.html">Factor Analysis - CFA</a></p>
<hr>
<p>Last updated on 2025-05-21 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/factor-analysis-02.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a confirmatory factor analysis?</li>
<li>How can I run CFA in R?</li>
<li>How can I specify CFA models using lavaan?</li>
<li>How can I interpret the results of a CFA and EFA in R?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the difference between exploratory and confirmatory
factor analysis</li>
<li>Learn how to conduct confirmatory factor analysis in R</li>
<li>Learn how to interpret the results of confirmatory factor analysis
in R</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="confirmatory-factor-analysis-cfa">Confirmatory Factor Analysis (CFA)<a class="anchor" aria-label="anchor" href="#confirmatory-factor-analysis-cfa"></a>
</h2>
<hr class="half-width">
<p>In the previous lesson, we approached the DASS as if we had no
knowledge about the underlying factor structure. However, this is not
really the case, since there is a specific theory proposing three
interrelated factors. We can use confirmatory factor analysis to test
whether this theory can adequately explain the item correlations found
here.</p>
<p>Importantly, we not only need a theory of the number of factors, but
also which items are supposed to load on which factor. This will be
necessary when establishing our CFA model. Furthermore, we will test
whether a one-factor model also is supported by the data and compare
these two models, evaluating which one is better.</p>
<p>The main R package we will be using is <code>lavaan</code>. This
package is widely used for Structural Equation Modeling (SEM) in R. CFA
is a specific type of model in the general SEM framework. The lavaan
homepage provides a great tutorial on CFA, as well (<a href="https://lavaan.ugent.be/tutorial/cfa.html" class="external-link uri">https://lavaan.ugent.be/tutorial/cfa.html</a>). For a more
detailed tutorial in SEM and mathematics behind CFA, please refer to the
lavaan homepage or <a href="https://stats.oarc.ucla.edu/r/seminars/rsem/" class="external-link">this
introduction</a>.</p>
<p>For now, let’s walk through the steps of a CFA in our specific case.
First of all, in order to do <em>confirmatory</em> factor analysis, we
need to have a hypothesis to confirm. How many factors, which variables
are supposed to span which factor? Secondly, we need to investigate the
correlation matrix for any issues (low correlations, correlations = 1).
Then, we need to define our model properly using lavaan syntax. And
finally, we can run our model and interpret our results.</p>
</section><section><h2 class="section-heading" id="model-specification">Model Specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h2>
<hr class="half-width">
<p>Let’s start by defining the theory and the model syntax.</p>
<p>The DASS has 42 items and measures three scales: depression, anxiety,
and stress. These scale are said to be intercorrelated, as they share
common causes (genetic, environmental etc.). Furthermore, the DASS
provides a detailed manual as to which items belong to which scales. The
sequence of items and their respective scales is:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/kaggle_dass/data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">testelapse</span> <span class="op">&lt;</span> <span class="fl">600</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span><span class="op">&amp;</span> <span class="fu">ends_with</span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">item_scales_dass</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="st">"S"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>, <span class="st">"A"</span>, </span>
<span>  <span class="st">"S"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>, <span class="st">"S"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>,</span>
<span>  <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>,</span>
<span>  <span class="st">"S"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>, <span class="st">"A"</span>, </span>
<span>  <span class="st">"S"</span>, <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>, <span class="st">"S"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>,</span>
<span>  <span class="st">"A"</span>, <span class="st">"D"</span>, <span class="st">"D"</span>, <span class="st">"S"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"D"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">item_scales_dass_data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  item_nr <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">42</span>,</span>
<span>  scale <span class="op">=</span> <span class="va">item_scales_dass</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">item_scales_dass_data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   item_nr scale
1        1     S
2        2     A
3        3     D
4        4     A
5        5     D
6        6     S
7        7     A
8        8     S
9        9     A
10      10     D
11      11     S
12      12     S
13      13     D
14      14     S
15      15     A
16      16     D
17      17     D
18      18     S
19      19     A
20      20     A
21      21     D
22      22     S
23      23     A
24      24     D
25      25     A
26      26     D
27      27     S
28      28     A
29      29     S
30      30     A
31      31     D
32      32     S
33      33     S
34      34     D
35      35     S
36      36     A
37      37     D
38      38     D
39      39     S
40      40     A
41      41     A
42      42     D</code></pre>
</div>
<div id="scales-vs.-factors" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="scales-vs.-factors" class="callout-inner">
<h3 class="callout-title">Scales vs. Factors</h3>
<div class="callout-content">
<p>There is an important difference between <em>scales</em> and
<em>factors</em>. Again, factors represent mathematical constructs
discovered or constructed during factor analysis. Scales represent a
collection of items bound together by the authors of the test and said
to measure a certain construct. These two words cannot be used
synonymously. Scales refer to item collections whereas factors refer to
solutions of factor analysis. A scale can build a factor, in fact its
items should span a common factor if the scale is constructed well. But
a scale is not the same thing as a factor.</p>
</div>
</div>
</div>
<p>Now, in order to define our model we need to keep the distinction
between manifest and latent variables in mind. Our manifest,
<em>measured</em> variables are the items. The factors are the latent
variable. We can also define which manifest variables contribute to
which latent variables. In lavaan, this can be specified in the model
code using a special syntax.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lavaan</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_cfa_3facs</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">  # Model Syntax</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # =~ is like in linear regression</span></span>
<span><span class="st">  # left hand is latent factor, right hand manifest variables contributing</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Define which items load on which factor</span></span>
<span><span class="st">  depression =~ Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  anxiety =~ Q2A + Q4A + Q7A + Q9A + Q15A + Q19A + Q20A + Q23A + Q25A + Q28A + Q30A + Q36A + Q40A + Q41A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  stress =~ Q1A + Q6A + Q8A + Q11A + Q12A + Q14A + Q18A + Q22A + Q27A + Q29A + Q32A + Q33A + Q35A + Q39A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Define correlations between factors using ~~</span></span>
<span><span class="st">  depression ~~ anxiety</span></span>
<span><span class="st">  depression ~~ stress</span></span>
<span><span class="st">  anxiety ~~ stress</span></span>
<span><span class="st">  "</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Now, we can fit this model using <code>cfa()</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cfa_3facs</span> <span class="op">&lt;-</span> <span class="fu">cfa</span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">model_cfa_3facs</span>, </span>
<span>  data <span class="op">=</span> <span class="va">fa_data</span>,</span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<p>To inspect the model results, we use <code>summary()</code>.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">fit_cfa_3facs</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>lavaan 0.6-19 ended normally after 46 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        87

  Number of observations                         37242

Model Test User Model:

  Test statistic                              107309.084
  Degrees of freedom                                 816
  P-value (Chi-square)                             0.000

Model Test Baseline Model:

  Test statistic                           1037764.006
  Degrees of freedom                               861
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.897
  Tucker-Lewis Index (TLI)                       0.892

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)           -1857160.022
  Loglikelihood unrestricted model (H1)   -1803505.480

  Akaike (AIC)                             3714494.044
  Bayesian (BIC)                           3715235.735
  Sample-size adjusted Bayesian (SABIC)    3714959.249

Root Mean Square Error of Approximation:

  RMSEA                                          0.059
  90 Percent confidence interval - lower         0.059
  90 Percent confidence interval - upper         0.059
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.042

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  depression =~
    Q3A               1.000                               0.808    0.776
    Q5A               0.983    0.006  155.298    0.000    0.794    0.742
    Q10A              1.156    0.007  175.483    0.000    0.934    0.818
    Q13A              1.077    0.006  173.188    0.000    0.870    0.810
    Q16A              1.077    0.006  165.717    0.000    0.870    0.782
    Q17A              1.158    0.007  172.607    0.000    0.936    0.807
    Q21A              1.221    0.007  182.633    0.000    0.986    0.844
    Q24A              0.987    0.006  159.408    0.000    0.797    0.758
    Q26A              1.020    0.006  162.876    0.000    0.824    0.771
    Q31A              0.966    0.006  156.243    0.000    0.780    0.746
    Q34A              1.169    0.007  175.678    0.000    0.944    0.819
    Q37A              1.118    0.007  168.220    0.000    0.903    0.791
    Q38A              1.229    0.007  180.035    0.000    0.993    0.834
    Q42A              0.826    0.006  131.716    0.000    0.668    0.646
  anxiety =~
    Q2A               1.000                               0.563    0.506
    Q4A               1.282    0.014   93.089    0.000    0.722    0.691
    Q7A               1.303    0.014   94.229    0.000    0.734    0.707
    Q9A               1.323    0.014   93.485    0.000    0.745    0.696
    Q15A              1.116    0.013   89.050    0.000    0.629    0.636
    Q19A              1.077    0.013   83.014    0.000    0.606    0.565
    Q20A              1.473    0.015   96.526    0.000    0.830    0.742
    Q23A              0.898    0.011   84.756    0.000    0.506    0.584
    Q25A              1.244    0.014   89.922    0.000    0.701    0.647
    Q28A              1.468    0.015   98.046    0.000    0.827    0.767
    Q30A              1.260    0.014   90.684    0.000    0.710    0.657
    Q36A              1.469    0.015   96.658    0.000    0.827    0.744
    Q40A              1.374    0.015   93.607    0.000    0.774    0.698
    Q41A              1.256    0.014   91.905    0.000    0.707    0.674
  stress =~
    Q1A               1.000                               0.776    0.750
    Q6A               0.943    0.007  137.700    0.000    0.732    0.695
    Q8A               0.974    0.007  142.400    0.000    0.756    0.717
    Q11A              1.030    0.007  152.388    0.000    0.799    0.761
    Q12A              0.969    0.007  139.655    0.000    0.752    0.704
    Q14A              0.797    0.007  111.328    0.000    0.619    0.572
    Q18A              0.824    0.007  116.739    0.000    0.639    0.598
    Q22A              0.947    0.007  141.490    0.000    0.735    0.713
    Q27A              0.995    0.007  146.258    0.000    0.772    0.734
    Q29A              1.020    0.007  149.022    0.000    0.791    0.746
    Q32A              0.872    0.007  130.508    0.000    0.677    0.663
    Q33A              0.970    0.007  142.051    0.000    0.753    0.715
    Q35A              0.849    0.007  129.451    0.000    0.658    0.658
    Q39A              0.956    0.007  144.729    0.000    0.742    0.727

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  depression ~~
    anxiety           0.326    0.004   73.602    0.000    0.716    0.716
    stress            0.491    0.005   93.990    0.000    0.784    0.784
  anxiety ~~
    stress            0.381    0.005   76.884    0.000    0.873    0.873

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Q3A               0.431    0.003  128.109    0.000    0.431    0.398
   .Q5A               0.515    0.004  129.707    0.000    0.515    0.450
   .Q10A              0.431    0.003  125.297    0.000    0.431    0.331
   .Q13A              0.398    0.003  125.958    0.000    0.398    0.345
   .Q16A              0.481    0.004  127.782    0.000    0.481    0.389
   .Q17A              0.467    0.004  126.117    0.000    0.467    0.348
   .Q21A              0.394    0.003  122.826    0.000    0.394    0.288
   .Q24A              0.471    0.004  129.017    0.000    0.471    0.426
   .Q26A              0.463    0.004  128.367    0.000    0.463    0.405
   .Q31A              0.486    0.004  129.556    0.000    0.486    0.444
   .Q34A              0.439    0.004  125.238    0.000    0.439    0.330
   .Q37A              0.487    0.004  127.220    0.000    0.487    0.374
   .Q38A              0.430    0.003  123.805    0.000    0.430    0.304
   .Q42A              0.622    0.005  132.512    0.000    0.622    0.583
   .Q2A               0.922    0.007  133.250    0.000    0.922    0.744
   .Q4A               0.572    0.004  127.940    0.000    0.572    0.523
   .Q7A               0.539    0.004  127.113    0.000    0.539    0.500
   .Q9A               0.590    0.005  127.667    0.000    0.590    0.515
   .Q15A              0.581    0.004  130.109    0.000    0.581    0.595
   .Q19A              0.785    0.006  132.085    0.000    0.785    0.681
   .Q20A              0.561    0.004  124.984    0.000    0.561    0.449
   .Q23A              0.493    0.004  131.617    0.000    0.493    0.658
   .Q25A              0.681    0.005  129.719    0.000    0.681    0.581
   .Q28A              0.478    0.004  123.083    0.000    0.478    0.412
   .Q30A              0.662    0.005  129.348    0.000    0.662    0.568
   .Q36A              0.551    0.004  124.837    0.000    0.551    0.446
   .Q40A              0.631    0.005  127.580    0.000    0.631    0.513
   .Q41A              0.601    0.005  128.683    0.000    0.601    0.546
   .Q1A               0.467    0.004  126.294    0.000    0.467    0.437
   .Q6A               0.571    0.004  129.082    0.000    0.571    0.516
   .Q8A               0.541    0.004  128.138    0.000    0.541    0.486
   .Q11A              0.464    0.004  125.600    0.000    0.464    0.421
   .Q12A              0.574    0.004  128.705    0.000    0.574    0.504
   .Q14A              0.785    0.006  132.627    0.000    0.785    0.672
   .Q18A              0.733    0.006  132.077    0.000    0.733    0.642
   .Q22A              0.523    0.004  128.331    0.000    0.523    0.492
   .Q27A              0.510    0.004  127.255    0.000    0.510    0.461
   .Q29A              0.498    0.004  126.551    0.000    0.498    0.443
   .Q32A              0.585    0.004  130.300    0.000    0.585    0.561
   .Q33A              0.541    0.004  128.213    0.000    0.541    0.489
   .Q35A              0.568    0.004  130.460    0.000    0.568    0.567
   .Q39A              0.491    0.004  127.618    0.000    0.491    0.471
    depression        0.653    0.007   88.452    0.000    1.000    1.000
    anxiety           0.317    0.006   50.766    0.000    1.000    1.000
    stress            0.602    0.007   83.798    0.000    1.000    1.000</code></pre>
</div>
<p>Now, this output contains several key pieces of information:</p>
<ul>
<li>fit statistics for the model</li>
<li>information on item loadings on the latent variables (factors)</li>
<li>information on the correlations between the latent variables</li>
<li>information on the variance of latent and manifest variables</li>
</ul>
<p>Let’s walk through the output one-by-one.</p>
</section><section><h2 class="section-heading" id="fit-measures">Fit measures<a class="anchor" aria-label="anchor" href="#fit-measures"></a>
</h2>
<hr class="half-width">
<p>The model fit is evaluated using three key criteria.</p>
<p>The first is the Chi^2 statistic. This evaluates whether the model
adequately reproduces the covariance matrix in the real data or whether
there is some deviation. Significant results indicate that the model
does not reproduce the covariance matrix. However, this is largely
dependent on sample size and not informative in practice. The CFA model
is always a reduction of the underlying covariance matrix. That is the
whole point of a model. Therefore, do not interpret the chi-square test
and its associated p-value. Nonetheless, it is customary to report this
information when presenting the model fit.</p>
<p>The following two fit statistics are independent of sample size and
widely accepted in practice.</p>
<p>The CFI (Comparative Fit Index) is an indicator of fit. It ranges
between 0 and 1 with 0 meaning horrible fit and 1 reflecting perfect
fit. Values above 0.8 are acceptable and CFI &gt; 0.9 is considered
good. This index is independent of sample size and robust against
violations of some assumptions CFA makes. It is however dependent on the
number of free parameters as it does not include a penalty for
additional parameters. Therefore, models with more parameter will
generally have better CFI than parsimonious models with fewer
parameters.</p>
<p>The RMSEA (Root Mean Squared Error Approximation) is an indicator of
misfit that includes a penalty for the number of parameters. The higher
the RMSEA, the worse. Generally, RMSEA &lt; 0.05 is considered good and
RMSEA &lt; 0.08 acceptable. Models with RMSEA &gt; 0.10 should not be
interpreted. This fit statistic indicates whether the model fits the
data well while controlling for the number of parameters specified.</p>
<p>It is customary to report all three of these measures when reporting
the results of a CFA. Similarly, you should also interpret both the CFI
and RMSEA, as bad fits in both statistics can indicate issues in the
model specification. The above model would be reported as follows.</p>
<p>The model with three correlated factors showed acceptable fit to the
data <span class="math inline">\(\chi^2(816) = 107309.08, p &lt; 0.001,
CFI = 0.90, RMSEA = 0.06\)</span>, 95% CI = <span class="math inline">\([0.06; 0.06]\)</span>.</p>
<p>In a future section, we will explore how you can compare models and
select models based on these fit statistics. Here, it is important to
focus on fit statistics that incorporate the number of free parameters
like the RMSEA. Otherwise, more complex models will always outperform
less complex models.</p>
<p>In addition to the statistics presented above, model comparison is
often based on information criteria, like the AIC (Akaike Information
Criterion) or the BIC (Bayesian Information Criterion). Here, lower
values indicate better models. These information criteria also penalize
complexity and are thus well suited for model comparison. More on this
in the later section.</p>
</section><section><h2 class="section-heading" id="loadings-on-latent-variables">Loadings on latent variables<a class="anchor" aria-label="anchor" href="#loadings-on-latent-variables"></a>
</h2>
<hr class="half-width">
<p>The next section in the model summary output display information on
the latent variables. Specifically how highly the manifest variables
“load” onto the latent variables they were assigned to. Here, loadings
&gt; 0.6 are considered high and at least one of the manifest variables
should load highly on the latent variables. If all loadings are low,
this might indicate that the factor you are trying to define does not
really exist, as there is little relation between the manifest variables
specified to load on this factor.</p>
<p>Importantly, the output shows two columns with loadings. The first
column “Estimate” shows unstandardized loadings (like regression weights
in a linear model). The last two columns “std.lv” and “std.all” show two
different standardization techniques of the loadings. For now, focus on
the “std.all” column. This can be interpreted in similar fashion as the
factor loadings in the EFA.</p>
<p>In our example, these loadings are looking very good, especially for
the depression scale. But for all scales, almost all items show
standardized loadings of &gt; 0.6, indicating that they reflect the
underlying factor well.</p>
<div id="key-difference-between-efa-and-cfa" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="key-difference-between-efa-and-cfa" class="callout-inner">
<h3 class="callout-title">Key Difference between EFA and CFA</h3>
<div class="callout-content">
<p>These loadings highlight a key difference between CFA and a factor
analysis with a fixed number of factors as conducted following an
EFA.</p>
<p>In the EFA case, item <em>cross-loadings</em> are allowed. An item
can load onto all factors. This is not the case in theory (unless
explicitly stated). Here, the items only load onto the factor as
specified in the model syntax. This is also why we obtain different
loadings and correlations between factors in this CFA example compared
to the three-factor FA from the previous episode.</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="correlations-between-latent-variables">Correlations between latent variables<a class="anchor" aria-label="anchor" href="#correlations-between-latent-variables"></a>
</h2>
<hr class="half-width">
<p>The next section in the output informs us about the covariances
between the latent variables. The “Estimate” column again shows the
unstandardized solution while the “std.all” column reflects the
standardized solution. The “std.all” column can be interpreted like a
correlation (only on a latent level).</p>
<p>Here, we can see high correlations &gt; 0.7 between our three
factors. Anxiety and stress even correlate to 0.87! Maybe there is one
underlying “g” factor of depression in our data after all? We will
investigate this further in the section regarding model comparison.</p>
</section><section><h2 class="section-heading" id="variances">Variances<a class="anchor" aria-label="anchor" href="#variances"></a>
</h2>
<hr class="half-width">
<p>The last section of the summary output displays the variances of the
errors of manifest variables and the variance of the latent variables.
Here, you should make sure that all values in “Estimate” are positive
and that the variance of the latent variables differs significantly from
0, the results for this test are printed in “P(&gt;|z|)”.</p>
<p>For CFA this section is not that relevant and plays a larger role in
other SEM models.</p>
</section><section><h2 class="section-heading" id="model-comparison">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<hr class="half-width">
<p>The last thing we will learn in this episode is how to leverage the
fit statistics and other model information to compare different models.
For example, remember that the EFA showed that the first factor had an
extremely large eigenvalue, indicating that one factor already explained
a substantial amount of variance.</p>
<p>A skeptic of the DASS might argue that it does not measure three
distinct scales after all, but rather one unifying “I’m doing bad”
construct. Therefore, this skeptic might generate a competing model of
the DASS, with only one factor on which all items are loading.</p>
<p>Let’s first test the fit statistics of this model and then compare
the two approaches.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_cfa_1fac</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">  # Model Syntax G Factor Model DASS</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Define only one general factor</span></span>
<span><span class="st">  g_dass =~ Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A +Q2A + Q4A + Q7A + Q9A + Q15A + Q19A + Q20A + Q23A + Q25A + Q28A + Q30A + Q36A + Q40A + Q41A + Q1A + Q6A + Q8A + Q11A + Q12A + Q14A + Q18A + Q22A + Q27A + Q29A + Q32A + Q33A + Q35A + Q39A</span></span>
<span><span class="st">  "</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_cfa_1fac</span> <span class="op">&lt;-</span> <span class="fu">cfa</span><span class="op">(</span><span class="va">model_cfa_1fac</span>, data <span class="op">=</span> <span class="va">fa_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">fit_cfa_1fac</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardize <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>lavaan 0.6-19 ended normally after 25 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        84

  Number of observations                         37242

Model Test User Model:

  Test statistic                              235304.681
  Degrees of freedom                                 819
  P-value (Chi-square)                             0.000

Model Test Baseline Model:

  Test statistic                           1037764.006
  Degrees of freedom                               861
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.774
  Tucker-Lewis Index (TLI)                       0.762

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)           -1921157.820
  Loglikelihood unrestricted model (H1)   -1803505.480

  Akaike (AIC)                             3842483.641
  Bayesian (BIC)                           3843199.757
  Sample-size adjusted Bayesian (SABIC)    3842932.805

Root Mean Square Error of Approximation:

  RMSEA                                          0.088
  90 Percent confidence interval - lower         0.087
  90 Percent confidence interval - upper         0.088
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.067

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  g_dass =~
    Q3A               1.000                               0.761    0.731
    Q5A               1.016    0.007  142.019    0.000    0.773    0.722
    Q10A              1.100    0.008  144.449    0.000    0.837    0.733
    Q13A              1.113    0.007  156.040    0.000    0.846    0.788
    Q16A              1.060    0.007  142.723    0.000    0.806    0.725
    Q17A              1.147    0.008  148.618    0.000    0.872    0.753
    Q21A              1.168    0.008  150.256    0.000    0.889    0.760
    Q24A              0.991    0.007  140.991    0.000    0.754    0.717
    Q26A              1.057    0.007  148.520    0.000    0.804    0.752
    Q31A              0.962    0.007  137.412    0.000    0.732    0.700
    Q34A              1.156    0.008  150.634    0.000    0.879    0.762
    Q37A              1.063    0.008  139.320    0.000    0.809    0.709
    Q38A              1.166    0.008  147.074    0.000    0.887    0.745
    Q42A              0.865    0.007  124.363    0.000    0.658    0.637
    Q2A               0.663    0.008   87.349    0.000    0.504    0.453
    Q4A               0.806    0.007  114.105    0.000    0.613    0.587
    Q7A               0.806    0.007  114.965    0.000    0.613    0.591
    Q9A               0.901    0.007  125.202    0.000    0.686    0.641
    Q15A              0.748    0.007  111.994    0.000    0.569    0.576
    Q19A              0.675    0.007   92.306    0.000    0.513    0.478
    Q20A              1.008    0.007  134.599    0.000    0.767    0.686
    Q23A              0.585    0.006   99.515    0.000    0.445    0.514
    Q25A              0.787    0.007  107.302    0.000    0.599    0.553
    Q28A              0.968    0.007  134.071    0.000    0.737    0.684
    Q30A              0.907    0.007  124.927    0.000    0.690    0.639
    Q36A              1.034    0.007  139.134    0.000    0.787    0.708
    Q40A              0.935    0.007  125.352    0.000    0.711    0.641
    Q41A              0.773    0.007  108.798    0.000    0.588    0.560
    Q1A               0.956    0.007  138.241    0.000    0.727    0.704
    Q6A               0.869    0.007  122.694    0.000    0.661    0.629
    Q8A               0.961    0.007  136.064    0.000    0.731    0.693
    Q11A              0.987    0.007  140.627    0.000    0.751    0.715
    Q12A              0.943    0.007  131.722    0.000    0.718    0.672
    Q14A              0.724    0.007   98.622    0.000    0.551    0.510
    Q18A              0.784    0.007  108.318    0.000    0.596    0.558
    Q22A              0.929    0.007  134.440    0.000    0.707    0.685
    Q27A              0.950    0.007  134.779    0.000    0.723    0.687
    Q29A              0.972    0.007  137.073    0.000    0.740    0.698
    Q32A              0.826    0.007  119.966    0.000    0.628    0.615
    Q33A              0.954    0.007  135.255    0.000    0.725    0.689
    Q35A              0.812    0.007  120.437    0.000    0.618    0.618
    Q39A              0.916    0.007  133.922    0.000    0.697    0.683

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Q3A               0.505    0.004  132.069    0.000    0.505    0.466
   .Q5A               0.550    0.004  132.300    0.000    0.550    0.479
   .Q10A              0.602    0.005  132.010    0.000    0.602    0.463
   .Q13A              0.439    0.003  130.205    0.000    0.439    0.380
   .Q16A              0.587    0.004  132.219    0.000    0.587    0.475
   .Q17A              0.582    0.004  131.451    0.000    0.582    0.433
   .Q21A              0.576    0.004  131.207    0.000    0.576    0.422
   .Q24A              0.539    0.004  132.416    0.000    0.539    0.486
   .Q26A              0.496    0.004  131.465    0.000    0.496    0.434
   .Q31A              0.559    0.004  132.788    0.000    0.559    0.511
   .Q34A              0.557    0.004  131.148    0.000    0.557    0.419
   .Q37A              0.648    0.005  132.595    0.000    0.648    0.498
   .Q38A              0.629    0.005  131.668    0.000    0.629    0.444
   .Q42A              0.635    0.005  133.849    0.000    0.635    0.595
   .Q2A               0.985    0.007  135.470    0.000    0.985    0.795
   .Q4A               0.717    0.005  134.451    0.000    0.717    0.656
   .Q7A               0.702    0.005  134.407    0.000    0.702    0.651
   .Q9A               0.675    0.005  133.792    0.000    0.675    0.589
   .Q15A              0.652    0.005  134.557    0.000    0.652    0.668
   .Q19A              0.889    0.007  135.325    0.000    0.889    0.771
   .Q20A              0.662    0.005  133.053    0.000    0.662    0.529
   .Q23A              0.551    0.004  135.083    0.000    0.551    0.736
   .Q25A              0.814    0.006  134.773    0.000    0.814    0.694
   .Q28A              0.619    0.005  133.100    0.000    0.619    0.533
   .Q30A              0.689    0.005  133.811    0.000    0.689    0.591
   .Q36A              0.616    0.005  132.614    0.000    0.616    0.499
   .Q40A              0.724    0.005  133.782    0.000    0.724    0.588
   .Q41A              0.755    0.006  134.707    0.000    0.755    0.686
   .Q1A               0.539    0.004  132.706    0.000    0.539    0.505
   .Q6A               0.669    0.005  133.958    0.000    0.669    0.605
   .Q8A               0.577    0.004  132.918    0.000    0.577    0.520
   .Q11A              0.539    0.004  132.455    0.000    0.539    0.489
   .Q12A              0.624    0.005  133.301    0.000    0.624    0.548
   .Q14A              0.864    0.006  135.115    0.000    0.864    0.740
   .Q18A              0.786    0.006  134.728    0.000    0.786    0.689
   .Q22A              0.564    0.004  133.067    0.000    0.564    0.530
   .Q27A              0.584    0.004  133.037    0.000    0.584    0.528
   .Q29A              0.576    0.004  132.822    0.000    0.576    0.513
   .Q32A              0.648    0.005  134.127    0.000    0.648    0.621
   .Q33A              0.581    0.004  132.993    0.000    0.581    0.525
   .Q35A              0.620    0.005  134.099    0.000    0.620    0.619
   .Q39A              0.556    0.004  133.113    0.000    0.556    0.534
    g_dass            0.579    0.007   81.612    0.000    1.000    1.000</code></pre>
</div>
<p>The one factor model showed a poor fit to the data <span class="math inline">\(\chi^2(819) = 235304.68, p &lt; 0.001, CFI = 0.77,
RMSEA = 0.09\)</span>, 95% CI = <span class="math inline">\([0.09;
0.09]\)</span>.</p>
<p>This already shows that the idea of only one unifying factor in the
DASS does not reflect the data well. We can formally test the difference
in the <span class="math inline">\(\chi^2\)</span> statistic using
<code>anova()</code>, not to be confused with the ANOVA.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">anova</span><span class="op">(</span><span class="va">fit_cfa_1fac</span>, <span class="va">fit_cfa_3facs</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Chi-Squared Difference Test

               Df     AIC     BIC  Chisq Chisq diff  RMSEA Df diff Pr(&gt;Chisq)
fit_cfa_3facs 816 3714494 3715236 107309
fit_cfa_1fac  819 3842484 3843200 235305     127996 1.0703       3  &lt; 2.2e-16

fit_cfa_3facs
fit_cfa_1fac  ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<p>This output displays that the three factor model shows better
information criteria (AIC and BIC) and that it also has lower (better)
<span class="math inline">\(\chi^2\)</span> statistics, significantly
so. Coupled with an improved RMSEA for the three factor model, this
evidence strongly suggests that the three factor model is better suited
to explain the DASS data than the one factor model.</p>
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Read in data and answer the question: do we have a hypothesis as to
how the structure should be?</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Run a CFA with three factors</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Interpret some results</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>Run a cfa with one factor, interpret some results</p>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>Compare the models from challenge 3 and challenge 4, which one fits
better?</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Something</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-factor-analysis-03"><p>Content from <a href="factor-analysis-03.html">Factor Analysis - Advanced Measurement Models</a></p>
<hr>
<p>Last updated on 2025-05-25 |

        <a href="https://github.com/SLesche/r-for-empra/edit/main/episodes/factor-analysis-03.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is a bifactor model?</li>
<li>What is a hierachical model?</li>
<li>How can I specify different types of measurement models?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the difference between hierarchical, non-hierarchical and
bifactor models</li>
<li>Learn how to specify a hierarchical model</li>
<li>Learn how to specify a bifactor model</li>
<li>Learn how to evaluate hierarchical and bifactor models</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="measurement-models">Measurement Models<a class="anchor" aria-label="anchor" href="#measurement-models"></a>
</h2>
<hr class="half-width">
<p>So far, we have looked at only 1-factor and correlated multiple
factor models in CFAs. This lesson, we will extend this approach to more
general models. For example, CFA models can not only incorporate a
number of factors correlating with each other, but also support a kind
of “second CFA” on the levels of factors. If you have multiple factors
that correlate highly with each other, they might themselves have a
higher order factor that can account for their covariation.</p>
<p>This is called a “hierarchical” model. We can simply extend our three
factor model as follows.</p>
</section><section><h2 class="section-heading" id="hierarchical-models">Hierarchical Models<a class="anchor" aria-label="anchor" href="#hierarchical-models"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lavaan</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>This is lavaan 0.6-19
lavaan is FREE software! Please report any bugs.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_cfa_hierarch</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">  # Model Syntax</span></span>
<span><span class="st">  # Define which items load on which factor</span></span>
<span><span class="st">  depression =~ Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  anxiety =~ Q2A + Q4A + Q7A + Q9A + Q15A + Q19A + Q20A + Q23A + Q25A + Q28A + Q30A + Q36A + Q40A + Q41A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  stress =~ Q1A + Q6A + Q8A + Q11A + Q12A + Q14A + Q18A + Q22A + Q27A + Q29A + Q32A + Q33A + Q35A + Q39A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Now, not correlation between factors, but hierarchy</span></span>
<span><span class="st">  high_level_fac =~ depression + anxiety + stress</span></span>
<span><span class="st">  "</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<p>Let’s load the data again and investigate this model:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dass_data</span> <span class="op">&lt;-</span> <span class="fu">read.csv</span><span class="op">(</span><span class="st">"data/kaggle_dass/data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fa_data</span> <span class="op">&lt;-</span> <span class="va">dass_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">filter</span><span class="op">(</span><span class="va">testelapse</span> <span class="op">&lt;</span> <span class="fl">600</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fu">starts_with</span><span class="op">(</span><span class="st">"Q"</span><span class="op">)</span><span class="op">&amp;</span> <span class="fu">ends_with</span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_cfa_hierarch</span> <span class="op">&lt;-</span> <span class="fu">cfa</span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">model_cfa_hierarch</span>, </span>
<span>  data <span class="op">=</span> <span class="va">fa_data</span>,</span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">fit_cfa_hierarch</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>lavaan 0.6-19 ended normally after 38 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        87

  Number of observations                         37242

Model Test User Model:

  Test statistic                              107309.084
  Degrees of freedom                                 816
  P-value (Chi-square)                             0.000

Model Test Baseline Model:

  Test statistic                           1037764.006
  Degrees of freedom                               861
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.897
  Tucker-Lewis Index (TLI)                       0.892

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)           -1857160.022
  Loglikelihood unrestricted model (H1)   -1803505.480

  Akaike (AIC)                             3714494.044
  Bayesian (BIC)                           3715235.735
  Sample-size adjusted Bayesian (SABIC)    3714959.249

Root Mean Square Error of Approximation:

  RMSEA                                          0.059
  90 Percent confidence interval - lower         0.059
  90 Percent confidence interval - upper         0.059
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.042

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  depression =~
    Q3A                1.000                               0.808    0.776
    Q5A                0.983    0.006  155.298    0.000    0.794    0.742
    Q10A               1.156    0.007  175.483    0.000    0.934    0.818
    Q13A               1.077    0.006  173.188    0.000    0.870    0.810
    Q16A               1.077    0.006  165.717    0.000    0.870    0.782
    Q17A               1.158    0.007  172.607    0.000    0.936    0.807
    Q21A               1.221    0.007  182.633    0.000    0.986    0.844
    Q24A               0.987    0.006  159.408    0.000    0.797    0.758
    Q26A               1.020    0.006  162.877    0.000    0.824    0.771
    Q31A               0.966    0.006  156.243    0.000    0.780    0.746
    Q34A               1.169    0.007  175.678    0.000    0.944    0.819
    Q37A               1.118    0.007  168.220    0.000    0.903    0.791
    Q38A               1.229    0.007  180.035    0.000    0.993    0.834
    Q42A               0.826    0.006  131.716    0.000    0.668    0.646
  anxiety =~
    Q2A                1.000                               0.563    0.506
    Q4A                1.282    0.014   93.090    0.000    0.722    0.691
    Q7A                1.303    0.014   94.229    0.000    0.734    0.707
    Q9A                1.323    0.014   93.485    0.000    0.745    0.696
    Q15A               1.116    0.013   89.051    0.000    0.629    0.636
    Q19A               1.077    0.013   83.014    0.000    0.606    0.565
    Q20A               1.473    0.015   96.526    0.000    0.830    0.742
    Q23A               0.898    0.011   84.756    0.000    0.506    0.584
    Q25A               1.244    0.014   89.922    0.000    0.701    0.647
    Q28A               1.468    0.015   98.046    0.000    0.827    0.767
    Q30A               1.260    0.014   90.684    0.000    0.710    0.657
    Q36A               1.469    0.015   96.658    0.000    0.827    0.744
    Q40A               1.374    0.015   93.607    0.000    0.774    0.698
    Q41A               1.256    0.014   91.905    0.000    0.707    0.674
  stress =~
    Q1A                1.000                               0.776    0.750
    Q6A                0.943    0.007  137.700    0.000    0.732    0.695
    Q8A                0.974    0.007  142.400    0.000    0.756    0.717
    Q11A               1.030    0.007  152.388    0.000    0.799    0.761
    Q12A               0.969    0.007  139.655    0.000    0.752    0.704
    Q14A               0.797    0.007  111.328    0.000    0.619    0.572
    Q18A               0.824    0.007  116.739    0.000    0.639    0.598
    Q22A               0.947    0.007  141.491    0.000    0.735    0.713
    Q27A               0.995    0.007  146.259    0.000    0.772    0.734
    Q29A               1.020    0.007  149.023    0.000    0.791    0.746
    Q32A               0.872    0.007  130.509    0.000    0.677    0.663
    Q33A               0.970    0.007  142.052    0.000    0.753    0.715
    Q35A               0.849    0.007  129.452    0.000    0.658    0.658
    Q39A               0.956    0.007  144.730    0.000    0.742    0.727
  high_level_fac =~
    depression         1.000                               0.802    0.802
    anxiety            0.776    0.009   88.349    0.000    0.893    0.893
    stress             1.171    0.009  124.409    0.000    0.978    0.978

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Q3A               0.431    0.003  128.109    0.000    0.431    0.398
   .Q5A               0.515    0.004  129.707    0.000    0.515    0.450
   .Q10A              0.431    0.003  125.297    0.000    0.431    0.331
   .Q13A              0.398    0.003  125.958    0.000    0.398    0.345
   .Q16A              0.481    0.004  127.782    0.000    0.481    0.389
   .Q17A              0.467    0.004  126.117    0.000    0.467    0.348
   .Q21A              0.394    0.003  122.826    0.000    0.394    0.288
   .Q24A              0.471    0.004  129.017    0.000    0.471    0.426
   .Q26A              0.463    0.004  128.367    0.000    0.463    0.405
   .Q31A              0.486    0.004  129.556    0.000    0.486    0.444
   .Q34A              0.439    0.004  125.238    0.000    0.439    0.330
   .Q37A              0.487    0.004  127.220    0.000    0.487    0.374
   .Q38A              0.430    0.003  123.805    0.000    0.430    0.304
   .Q42A              0.622    0.005  132.512    0.000    0.622    0.583
   .Q2A               0.922    0.007  133.250    0.000    0.922    0.744
   .Q4A               0.572    0.004  127.940    0.000    0.572    0.523
   .Q7A               0.539    0.004  127.113    0.000    0.539    0.500
   .Q9A               0.590    0.005  127.667    0.000    0.590    0.515
   .Q15A              0.581    0.004  130.109    0.000    0.581    0.595
   .Q19A              0.785    0.006  132.085    0.000    0.785    0.681
   .Q20A              0.561    0.004  124.984    0.000    0.561    0.449
   .Q23A              0.493    0.004  131.617    0.000    0.493    0.658
   .Q25A              0.681    0.005  129.719    0.000    0.681    0.581
   .Q28A              0.478    0.004  123.083    0.000    0.478    0.412
   .Q30A              0.662    0.005  129.348    0.000    0.662    0.568
   .Q36A              0.551    0.004  124.837    0.000    0.551    0.446
   .Q40A              0.631    0.005  127.580    0.000    0.631    0.513
   .Q41A              0.601    0.005  128.683    0.000    0.601    0.546
   .Q1A               0.467    0.004  126.294    0.000    0.467    0.437
   .Q6A               0.571    0.004  129.082    0.000    0.571    0.516
   .Q8A               0.541    0.004  128.138    0.000    0.541    0.486
   .Q11A              0.464    0.004  125.600    0.000    0.464    0.421
   .Q12A              0.574    0.004  128.705    0.000    0.574    0.504
   .Q14A              0.785    0.006  132.627    0.000    0.785    0.672
   .Q18A              0.733    0.006  132.077    0.000    0.733    0.642
   .Q22A              0.523    0.004  128.331    0.000    0.523    0.492
   .Q27A              0.510    0.004  127.255    0.000    0.510    0.461
   .Q29A              0.498    0.004  126.551    0.000    0.498    0.443
   .Q32A              0.585    0.004  130.300    0.000    0.585    0.561
   .Q33A              0.541    0.004  128.213    0.000    0.541    0.489
   .Q35A              0.568    0.004  130.460    0.000    0.568    0.567
   .Q39A              0.491    0.004  127.618    0.000    0.491    0.471
   .depression        0.233    0.003   77.473    0.000    0.357    0.357
   .anxiety           0.064    0.002   41.710    0.000    0.202    0.202
   .stress            0.027    0.002   14.464    0.000    0.044    0.044
    high_level_fac    0.420    0.006   70.881    0.000    1.000    1.000</code></pre>
</div>
<p>Again, let’s look at the fit indices first. The hierarchical model
with three factors showed acceptable fit to the data <span class="math inline">\(\chi^2(816) = 107309.08, p &lt; 0.001, CFI = 0.90,
RMSEA = 0.06\)</span>, 95% CI = <span class="math inline">\([0.06;
0.06]\)</span>. Similarly, the loadings on the first-order factors
(depression, anxiety, stress) also look good and we do not observe any
issues in the variance.</p>
<p>If you have a good memory, you might notice that the fit statistics
are identical to those in the correlated 3-factors model. This is
because the higher order factor in this case only restructures the
bivariate correlations into factor loadings. However, this is not true
for all number of factors. In models with more than 3 first-order
factors, establishing a second-order factor loading on all of them
introduces more constraints than allowing the factors to correlate
freely.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Semplot here?</span></span></code></pre>
</div>
<p>The hierarchical model allows us to investigate two very important
things. Firstly, we can investigate the presence of a higher order
factor. This is only the case if 1) the model fit is acceptable, 2) the
factor loadings on this second-order factor are high enough and 3) the
variance of the second-order factor is significantly different from 0.
In this case, all three things are true, supporting the conclusion that
a model with a higher order factor that contributes variance to all
lower factors fits the data well.</p>
<p>Secondly, they are extremely useful in Structural Equation Models
(SEM), as this higher-order factor can then itself be correlated to
other outcomes, and allows researchers to investigate how much the
general factor is associated with other items.</p>
</section><section><h2 class="section-heading" id="bi-factor-models">Bi-Factor Models<a class="anchor" aria-label="anchor" href="#bi-factor-models"></a>
</h2>
<hr class="half-width">
<p>In this hierarchical case, we assume that the higher-order factor
captures the shared variance of all first-order factors. So the
higher-order factor only contributes variance to the observed variables
<em>indirectly</em> through the first-order factors (depression
etc.).</p>
<p>Bi-factor models change this behavior significantly. They do not
impose a hierarchical structure but rather partition the variance in the
observed variables into a general factor and specific factors. In the
case of the DASS, a bifactor model would assert that each item is mostly
determined by a general “I’m doing bad factor” and depending on the item
context, depression, anxiety, or stress specifically contribute to the
response on the specific item.</p>
<p>In contrast to a hierarchical model, this g-factor is directly
influencing responses in the items and is <em>not related</em> to the
specific factors. These models are often employed when researchers have
good reason to believe that there are some specific factors unrelated to
general response, as for example when using multiple tests measuring the
same construct. One might introduce a general factor for construct and
several specific factors capturing measurement specific variance (e.g. g
factor for Openness, specific factors for self-rating
vs. other-rating).</p>
<p>The model syntax displays this direct loading and the uncorrelated
latent variables:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_cfa_bifac</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">  # Model Syntax</span></span>
<span><span class="st">  # Define which items load on which factor</span></span>
<span><span class="st">  depression =~ Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  anxiety =~ Q2A + Q4A + Q7A + Q9A + Q15A + Q19A + Q20A + Q23A + Q25A + Q28A + Q30A + Q36A + Q40A + Q41A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  stress =~ Q1A + Q6A + Q8A + Q11A + Q12A + Q14A + Q18A + Q22A + Q27A + Q29A + Q32A + Q33A + Q35A + Q39A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Direct loading of the items on the general factor</span></span>
<span><span class="st">  g_dass =~ Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A +Q2A + Q4A + Q7A + Q9A + Q15A + Q19A + Q20A + Q23A + Q25A + Q28A + Q30A + Q36A + Q40A + Q41A + Q1A + Q6A + Q8A + Q11A + Q12A + Q14A + Q18A + Q22A + Q27A + Q29A + Q32A + Q33A + Q35A + Q39A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Define correlations between factors using ~~</span></span>
<span><span class="st">  depression ~~ 0*anxiety</span></span>
<span><span class="st">  depression ~~ 0*stress</span></span>
<span><span class="st">  anxiety ~~ 0*stress</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  g_dass ~~ 0*depression</span></span>
<span><span class="st">  g_dass ~~ 0*stress</span></span>
<span><span class="st">  g_dass ~~ 0*anxiety</span></span>
<span><span class="st">  "</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cfa_bifac</span> <span class="op">&lt;-</span> <span class="fu">cfa</span><span class="op">(</span><span class="va">model_cfa_bifac</span>, data <span class="op">=</span> <span class="va">fa_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">fit_cfa_bifac</span>, fit.measures <span class="op">=</span> <span class="cn">TRUE</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>lavaan 0.6-19 ended normally after 90 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                       126

  Number of observations                         37242

Model Test User Model:

  Test statistic                              72120.789
  Degrees of freedom                                777
  P-value (Chi-square)                            0.000

Model Test Baseline Model:

  Test statistic                           1037764.006
  Degrees of freedom                               861
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.931
  Tucker-Lewis Index (TLI)                       0.924

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)           -1839565.874
  Loglikelihood unrestricted model (H1)   -1803505.480

  Akaike (AIC)                             3679383.748
  Bayesian (BIC)                           3680457.922
  Sample-size adjusted Bayesian (SABIC)    3680057.494

Root Mean Square Error of Approximation:

  RMSEA                                          0.050
  90 Percent confidence interval - lower         0.049
  90 Percent confidence interval - upper         0.050
  P-value H_0: RMSEA &lt;= 0.050                    0.968
  P-value H_0: RMSEA &gt;= 0.080                    0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.031

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  depression =~
    Q3A               1.000                               0.476    0.457
    Q5A               0.838    0.011   77.509    0.000    0.399    0.373
    Q10A              1.408    0.014  104.191    0.000    0.670    0.587
    Q13A              0.930    0.010   88.624    0.000    0.443    0.412
    Q16A              1.143    0.012   92.973    0.000    0.544    0.489
    Q17A              1.242    0.013   97.712    0.000    0.591    0.510
    Q21A              1.494    0.014  108.013    0.000    0.711    0.609
    Q24A              0.960    0.011   85.644    0.000    0.457    0.434
    Q26A              0.862    0.011   81.459    0.000    0.410    0.384
    Q31A              0.967    0.011   85.275    0.000    0.461    0.440
    Q34A              1.252    0.013   99.210    0.000    0.596    0.517
    Q37A              1.380    0.014  101.533    0.000    0.657    0.576
    Q38A              1.546    0.014  107.851    0.000    0.736    0.618
    Q42A              0.655    0.011   61.266    0.000    0.312    0.302
  anxiety =~
    Q2A               1.000                               0.288    0.258
    Q4A               1.573    0.037   42.513    0.000    0.452    0.433
    Q7A               1.940    0.044   44.187    0.000    0.558    0.538
    Q9A               0.232    0.018   12.886    0.000    0.067    0.062
    Q15A              1.207    0.030   39.724    0.000    0.347    0.351
    Q19A              1.288    0.033   38.640    0.000    0.370    0.345
    Q20A              0.442    0.020   22.556    0.000    0.127    0.114
    Q23A              1.100    0.028   39.596    0.000    0.316    0.365
    Q25A              1.342    0.034   40.033    0.000    0.386    0.357
    Q28A              0.667    0.021   31.767    0.000    0.192    0.178
    Q30A              0.170    0.019    9.086    0.000    0.049    0.045
    Q36A              0.402    0.019   21.113    0.000    0.116    0.104
    Q40A              0.292    0.019   15.254    0.000    0.084    0.076
    Q41A              1.866    0.043   43.679    0.000    0.537    0.511
  stress =~
    Q1A               1.000                               0.381    0.368
    Q6A               0.790    0.016   49.154    0.000    0.301    0.286
    Q8A              -0.056    0.014   -4.124    0.000   -0.021   -0.020
    Q11A              1.079    0.017   62.272    0.000    0.411    0.391
    Q12A             -0.463    0.015  -29.980    0.000   -0.176   -0.165
    Q14A              0.800    0.018   44.430    0.000    0.304    0.282
    Q18A              0.754    0.017   43.691    0.000    0.287    0.269
    Q22A              0.187    0.013   13.917    0.000    0.071    0.069
    Q27A              0.993    0.017   58.180    0.000    0.378    0.359
    Q29A              0.605    0.014   42.099    0.000    0.230    0.217
    Q32A              0.737    0.016   46.342    0.000    0.281    0.275
    Q33A             -0.525    0.016  -33.597    0.000   -0.200   -0.190
    Q35A              0.680    0.015   44.095    0.000    0.259    0.259
    Q39A              0.538    0.014   38.401    0.000    0.205    0.201
  g_dass =~
    Q3A               1.000                               0.647    0.621
    Q5A               1.058    0.008  127.074    0.000    0.685    0.639
    Q10A              1.034    0.008  131.792    0.000    0.669    0.586
    Q13A              1.158    0.008  140.588    0.000    0.749    0.697
    Q16A              1.036    0.008  127.946    0.000    0.670    0.603
    Q17A              1.128    0.008  135.443    0.000    0.730    0.630
    Q21A              1.100    0.008  139.112    0.000    0.711    0.609
    Q24A              0.996    0.008  126.030    0.000    0.644    0.612
    Q26A              1.103    0.008  133.013    0.000    0.713    0.668
    Q31A              0.959    0.008  122.467    0.000    0.620    0.592
    Q34A              1.138    0.008  137.814    0.000    0.736    0.638
    Q37A              0.996    0.008  125.672    0.000    0.644    0.565
    Q38A              1.086    0.008  135.445    0.000    0.703    0.590
    Q42A              0.914    0.008  110.771    0.000    0.592    0.572
    Q2A               0.764    0.010   78.619    0.000    0.494    0.444
    Q4A               0.956    0.010  100.570    0.000    0.618    0.592
    Q7A               0.947    0.009  100.271    0.000    0.613    0.590
    Q9A               1.152    0.010  114.816    0.000    0.745    0.696
    Q15A              0.856    0.009   96.201    0.000    0.554    0.560
    Q19A              0.802    0.009   84.718    0.000    0.519    0.483
    Q20A              1.245    0.011  117.876    0.000    0.805    0.720
    Q23A              0.667    0.008   86.982    0.000    0.431    0.498
    Q25A              0.953    0.010   97.541    0.000    0.617    0.570
    Q28A              1.238    0.010  120.648    0.000    0.800    0.743
    Q30A              1.095    0.010  109.651    0.000    0.709    0.656
    Q36A              1.247    0.011  118.553    0.000    0.807    0.726
    Q40A              1.173    0.010  113.292    0.000    0.759    0.684
    Q41A              0.910    0.009   96.144    0.000    0.589    0.561
    Q1A               1.111    0.010  113.901    0.000    0.719    0.695
    Q6A               1.058    0.010  108.405    0.000    0.684    0.651
    Q8A               1.187    0.010  118.873    0.000    0.768    0.729
    Q11A              1.139    0.010  114.602    0.000    0.737    0.702
    Q12A              1.260    0.010  122.913    0.000    0.815    0.764
    Q14A              0.871    0.010   90.195    0.000    0.563    0.521
    Q18A              0.916    0.010   95.101    0.000    0.593    0.555
    Q22A              1.118    0.010  115.483    0.000    0.723    0.702
    Q27A              1.091    0.010  110.804    0.000    0.706    0.671
    Q29A              1.171    0.010  116.850    0.000    0.757    0.715
    Q32A              0.968    0.009  103.368    0.000    0.626    0.613
    Q33A              1.271    0.010  124.894    0.000    0.822    0.781
    Q35A              0.945    0.009  103.042    0.000    0.611    0.611
    Q39A              1.091    0.010  113.992    0.000    0.706    0.692

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  depression ~~
    anxiety           0.000                               0.000    0.000
    stress            0.000                               0.000    0.000
  anxiety ~~
    stress            0.000                               0.000    0.000
  depression ~~
    g_dass            0.000                               0.000    0.000
  stress ~~
    g_dass            0.000                               0.000    0.000
  anxiety ~~
    g_dass            0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Q3A               0.439    0.003  129.116    0.000    0.439    0.405
   .Q5A               0.519    0.004  131.501    0.000    0.519    0.452
   .Q10A              0.406    0.003  120.568    0.000    0.406    0.312
   .Q13A              0.398    0.003  128.596    0.000    0.398    0.345
   .Q16A              0.492    0.004  128.021    0.000    0.492    0.398
   .Q17A              0.460    0.004  125.804    0.000    0.460    0.343
   .Q21A              0.354    0.003  115.937    0.000    0.354    0.259
   .Q24A              0.484    0.004  130.257    0.000    0.484    0.437
   .Q26A              0.465    0.004  130.540    0.000    0.465    0.407
   .Q31A              0.499    0.004  130.430    0.000    0.499    0.455
   .Q34A              0.433    0.003  124.935    0.000    0.433    0.325
   .Q37A              0.456    0.004  122.826    0.000    0.456    0.350
   .Q38A              0.381    0.003  115.828    0.000    0.381    0.269
   .Q42A              0.621    0.005  133.654    0.000    0.621    0.581
   .Q2A               0.912    0.007  132.163    0.000    0.912    0.736
   .Q4A               0.506    0.004  117.060    0.000    0.506    0.463
   .Q7A               0.391    0.004   96.997    0.000    0.391    0.363
   .Q9A               0.586    0.005  130.242    0.000    0.586    0.512
   .Q15A              0.549    0.004  126.066    0.000    0.549    0.563
   .Q19A              0.746    0.006  127.751    0.000    0.746    0.647
   .Q20A              0.585    0.005  129.861    0.000    0.585    0.468
   .Q23A              0.463    0.004  126.185    0.000    0.463    0.618
   .Q25A              0.642    0.005  125.465    0.000    0.642    0.548
   .Q28A              0.484    0.004  128.458    0.000    0.484    0.417
   .Q30A              0.661    0.005  131.247    0.000    0.661    0.567
   .Q36A              0.571    0.004  129.586    0.000    0.571    0.463
   .Q40A              0.647    0.005  130.851    0.000    0.647    0.526
   .Q41A              0.466    0.004  105.809    0.000    0.466    0.424
   .Q1A               0.407    0.004  113.121    0.000    0.407    0.381
   .Q6A               0.548    0.004  125.196    0.000    0.548    0.495
   .Q8A               0.521    0.004  126.156    0.000    0.521    0.469
   .Q11A              0.391    0.004  108.324    0.000    0.391    0.355
   .Q12A              0.444    0.004  109.048    0.000    0.444    0.390
   .Q14A              0.757    0.006  128.517    0.000    0.757    0.649
   .Q18A              0.708    0.005  128.759    0.000    0.708    0.620
   .Q22A              0.535    0.004  130.122    0.000    0.535    0.503
   .Q27A              0.466    0.004  116.394    0.000    0.466    0.421
   .Q29A              0.497    0.004  127.087    0.000    0.497    0.442
   .Q32A              0.572    0.004  127.129    0.000    0.572    0.548
   .Q33A              0.392    0.004  101.742    0.000    0.392    0.354
   .Q35A              0.561    0.004  128.205    0.000    0.561    0.560
   .Q39A              0.501    0.004  128.729    0.000    0.501    0.481
    depression        0.227    0.004   56.333    0.000    1.000    1.000
    anxiety           0.083    0.004   23.169    0.000    1.000    1.000
    stress            0.145    0.004   38.869    0.000    1.000    1.000
    g_dass            0.418    0.006   65.244    0.000    1.000    1.000</code></pre>
</div>
<p>This model shows good fit to the data <span class="math inline">\(\chi^2(777) = 72120.79, p &lt; 0.001, CFI = 0.93,
RMSEA = 0.05\)</span>, 95% CI = <span class="math inline">\([0.05;
0.05]\)</span>. We can additionally observe no issues in the loadings on
the general factor. For the specific factors, there are items that do
not seem to measure anything factor-specific in addition to the general
factor, as they show loadings near zero on their specific factor.</p>
<p>From this model, we seomthing general factor, specific is abit low.
But good fit</p>
<p>What might this mean for DASS - general score supported. Some
specific subtests might not measure their things but something else
entirely</p>
</section><section><h2 class="section-heading" id="model-comparison---nested-models">Model Comparison - Nested models<a class="anchor" aria-label="anchor" href="#model-comparison---nested-models"></a>
</h2>
<hr class="half-width">
<p>Nested models, and comparisons of models</p>
<p>Declaring a winner for our DASS data</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_cfa_1fac</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">  # Model Syntax G Factor Model DASS</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Define only one general factor</span></span>
<span><span class="st">  g_dass =~ Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A +Q2A + Q4A + Q7A + Q9A + Q15A + Q19A + Q20A + Q23A + Q25A + Q28A + Q30A + Q36A + Q40A + Q41A + Q1A + Q6A + Q8A + Q11A + Q12A + Q14A + Q18A + Q22A + Q27A + Q29A + Q32A + Q33A + Q35A + Q39A</span></span>
<span><span class="st">  "</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_cfa_1fac</span> <span class="op">&lt;-</span> <span class="fu">cfa</span><span class="op">(</span><span class="va">model_cfa_1fac</span>, data <span class="op">=</span> <span class="va">fa_data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_cfa_3facs</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span></span>
<span>  <span class="st">"</span></span>
<span><span class="st">  # Model Syntax</span></span>
<span><span class="st">  # Define which items load on which factor</span></span>
<span><span class="st">  depression =~ Q3A + Q5A + Q10A + Q13A + Q16A + Q17A + Q21A + Q24A + Q26A + Q31A + Q34A + Q37A + Q38A + Q42A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  anxiety =~ Q2A + Q4A + Q7A + Q9A + Q15A + Q19A + Q20A + Q23A + Q25A + Q28A + Q30A + Q36A + Q40A + Q41A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  stress =~ Q1A + Q6A + Q8A + Q11A + Q12A + Q14A + Q18A + Q22A + Q27A + Q29A + Q32A + Q33A + Q35A + Q39A</span></span>
<span><span class="st">  </span></span>
<span><span class="st">  # Define correlations between factors using ~~</span></span>
<span><span class="st">  depression ~~ anxiety</span></span>
<span><span class="st">  depression ~~ stress</span></span>
<span><span class="st">  anxiety ~~ stress</span></span>
<span><span class="st">  "</span></span>
<span><span class="op">)</span></span>
<span><span class="va">fit_cfa_3facs</span> <span class="op">&lt;-</span> <span class="fu">cfa</span><span class="op">(</span></span>
<span>  model <span class="op">=</span> <span class="va">model_cfa_3facs</span>, </span>
<span>  data <span class="op">=</span> <span class="va">fa_data</span>,</span>
<span>  <span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fitmeasures</span><span class="op">(</span><span class="va">fit_cfa_1fac</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"cfi"</span>, <span class="st">"rmsea"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        df      chisq     pvalue        cfi      rmsea
   819.000 235304.681      0.000      0.774      0.088 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fitmeasures</span><span class="op">(</span><span class="va">fit_cfa_3facs</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"cfi"</span>, <span class="st">"rmsea"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        df      chisq     pvalue        cfi      rmsea
   816.000 107309.084      0.000      0.897      0.059 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fitmeasures</span><span class="op">(</span><span class="va">fit_cfa_hierarch</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"cfi"</span>, <span class="st">"rmsea"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        df      chisq     pvalue        cfi      rmsea
   816.000 107309.084      0.000      0.897      0.059 </code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">fitmeasures</span><span class="op">(</span><span class="va">fit_cfa_bifac</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"cfi"</span>, <span class="st">"rmsea"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>       df     chisq    pvalue       cfi     rmsea
  777.000 72120.789     0.000     0.931     0.050 </code></pre>
</div>
<p>Something about the fit-stats</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">anova</span><span class="op">(</span><span class="va">fit_cfa_1fac</span>, <span class="va">fit_cfa_3facs</span>, <span class="va">fit_cfa_hierarch</span>, <span class="va">fit_cfa_bifac</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code>Warning: lavaan-&gt;lavTestLRT():
   some models have the same degrees of freedom</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Chi-Squared Difference Test

                  Df     AIC     BIC  Chisq Chisq diff   RMSEA Df diff
fit_cfa_bifac    777 3679384 3680458  72121
fit_cfa_3facs    816 3714494 3715236 107309      35188 0.15556      39
fit_cfa_hierarch 816 3714494 3715236 107309          0 0.00000       0
fit_cfa_1fac     819 3842484 3843200 235305     127996 1.07032       3
                 Pr(&gt;Chisq)
fit_cfa_bifac
fit_cfa_3facs     &lt; 2.2e-16 ***
fit_cfa_hierarch
fit_cfa_1fac      &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="important---cfa-vs.-efa" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="important---cfa-vs.-efa" class="callout-inner">
<h3 class="callout-title">Important - CFA vs. EFA</h3>
<div class="callout-content">
<p>Important note, do not confuse confirmatory with exploratory
research!</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="a-look-to-sem">A look to SEM<a class="anchor" aria-label="anchor" href="#a-look-to-sem"></a>
</h2>
<hr class="half-width">
<p>Outlook, SEM? Correlation of anxiety with big 5 estimates?</p>
<div id="challenge-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge 1</h3>
<div class="callout-content">
<p>Read in data and answer the question: do we have a hypothesis as to
how the structure should be?</p>
</div>
</div>
</div>
<div id="challenge-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge 2</h3>
<div class="callout-content">
<p>Run a CFA with three factors</p>
</div>
</div>
</div>
<div id="challenge-3" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge 3</h3>
<div class="callout-content">
<p>Interpret some results</p>
</div>
</div>
</div>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge 4</h3>
<div class="callout-content">
<p>Run a cfa with one factor, interpret some results</p>
</div>
</div>
</div>
<div id="challenge-5" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-5" class="callout-inner">
<h3 class="callout-title">Challenge 5</h3>
<div class="callout-content">
<p>Compare the models from challenge 3 and challenge 4, which one fits
better?</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul>
<li>Something</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/SLesche/r-for-empra/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/SLesche/r-for-empra/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/SLesche/r-for-empra/" class="external-link">Source</a></p>
				<p><a href="https://github.com/SLesche/r-for-empra/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:sven.lesche@psychologie.uni-heidelberg.de">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.12" class="external-link">sandpaper (0.16.12)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.9" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.6" class="external-link">varnish (1.0.6)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://SLesche.github.io/r-for-empra/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "R, beginner, tidyverse, empra, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://SLesche.github.io/r-for-empra/aio.html",
  "identifier": "https://SLesche.github.io/r-for-empra/aio.html",
  "dateCreated": "2025-05-25",
  "dateModified": "2025-05-27",
  "datePublished": "2025-05-27"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

